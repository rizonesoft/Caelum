{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://ai-email-writer/./src/services/outlook.ts","webpack://ai-email-writer/./src/styles/main.css","webpack://ai-email-writer/./src/taskpane/taskpane.css","webpack://ai-email-writer/./node_modules/css-loader/dist/runtime/api.js","webpack://ai-email-writer/./node_modules/css-loader/dist/runtime/getUrl.js","webpack://ai-email-writer/./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack://ai-email-writer/./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack://ai-email-writer/webpack/bootstrap","webpack://ai-email-writer/webpack/runtime/compat get default export","webpack://ai-email-writer/webpack/runtime/define property getters","webpack://ai-email-writer/webpack/runtime/hasOwnProperty shorthand","webpack://ai-email-writer/webpack/runtime/jsonp chunk loading","webpack://ai-email-writer/webpack/runtime/nonce","webpack://ai-email-writer/./src/styles/main.css?9d12","webpack://ai-email-writer/./node_modules/@google/generative-ai/dist/index.mjs","webpack://ai-email-writer/./src/taskpane/taskpane.css?6100","webpack://ai-email-writer/./src/features/settings.ts","webpack://ai-email-writer/./src/services/gemini.ts","webpack://ai-email-writer/./src/prompts/builder.ts","webpack://ai-email-writer/./src/features/draft-email.ts","webpack://ai-email-writer/./src/prompts/templates.ts","webpack://ai-email-writer/./src/features/draft-reply.ts","webpack://ai-email-writer/./src/features/summarize-thread.ts","webpack://ai-email-writer/./src/features/improve-writing.ts","webpack://ai-email-writer/./src/features/extract-actions.ts","webpack://ai-email-writer/./src/features/translate.ts","webpack://ai-email-writer/./src/taskpane/taskpane.ts"],"sourcesContent":["/**\n * AI Compose  Outlook Email Reader Service\n *\n * Provides a clean, typed interface to the Office.js mailbox API\n * for reading email data in both Read and Compose modes.\n *\n * Read mode:  The user is viewing a received email (MessageRead).\n * Compose mode: The user is drafting a new email or reply (MessageCompose).\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* global Office */\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\n/** Represents an email participant (sender, recipient, etc.). */\nexport interface EmailContact {\n  /** Display name, e.g. \"Alice Smith\" */\n  name: string;\n  /** Email address, e.g. \"alice@example.com\" */\n  email: string;\n}\n\n/** Represents a single message in a conversation thread. */\nexport interface EmailMessage {\n  /** The message subject */\n  subject: string;\n  /** The message body (plain text) */\n  body: string;\n  /** The sender of this message */\n  sender: EmailContact;\n  /** When the message was sent (if available) */\n  dateTime?: string;\n}\n\n/** The mode in which the add-in is operating. */\nexport type ItemMode = 'read' | 'compose' | 'unknown';\n\n// ---------------------------------------------------------------------------\n// Mode detection\n// ---------------------------------------------------------------------------\n\n/**\n * Determine whether the current mailbox item is in Read or Compose mode.\n */\nexport function getItemMode(): ItemMode {\n  const item = Office.context.mailbox.item;\n  if (!item) return 'unknown';\n\n  // In compose mode, item.itemType is still defined but\n  // subject/body are async setters rather than direct properties.\n  // The best indicator is checking for the \"getAsync\" pattern on body.\n  if (typeof (item as any).body?.getAsync === 'function') {\n    // Both modes have body.getAsync since Office 1.3,\n    // but compose mode also has body.setAsync\n    if (typeof (item as any).body?.setAsync === 'function') {\n      return 'compose';\n    }\n  }\n\n  // Also check: in read mode, subject is a direct string property.\n  // In compose mode, subject is an object with getAsync/setAsync.\n  if (typeof item.subject === 'string') {\n    return 'read';\n  }\n\n  if (typeof (item.subject as any)?.getAsync === 'function') {\n    return 'compose';\n  }\n\n  return 'unknown';\n}\n\n// ---------------------------------------------------------------------------\n// Email body\n// ---------------------------------------------------------------------------\n\n/**\n * Read the body of the currently open email as plain text.\n * Works in both Read and Compose modes.\n */\nexport function getCurrentEmailBody(): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const item = getItemOrThrow();\n\n    item.body.getAsync(\n      Office.CoercionType.Text,\n      (result: Office.AsyncResult<string>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value || '');\n        } else {\n          reject(new Error(`Failed to read email body: ${result.error?.message || 'Unknown error'}`));\n        }\n      },\n    );\n  });\n}\n\n/**\n * Read the body of the currently open email as HTML.\n * Useful when preserving formatting is important.\n */\nexport function getCurrentEmailBodyHtml(): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const item = getItemOrThrow();\n\n    item.body.getAsync(\n      Office.CoercionType.Html,\n      (result: Office.AsyncResult<string>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value || '');\n        } else {\n          reject(\n            new Error(`Failed to read email body (HTML): ${result.error?.message || 'Unknown error'}`),\n          );\n        }\n      },\n    );\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Subject\n// ---------------------------------------------------------------------------\n\n/**\n * Read the subject of the currently open email.\n * Handles both Read mode (direct property) and Compose mode (async getter).\n */\nexport function getCurrentEmailSubject(): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const item = getItemOrThrow();\n\n    // Read mode: subject is a direct string property\n    if (typeof item.subject === 'string') {\n      resolve(item.subject);\n      return;\n    }\n\n    // Compose mode: subject is an object with getAsync\n    const subjectObj = item.subject as any;\n    if (typeof subjectObj?.getAsync === 'function') {\n      subjectObj.getAsync((result: Office.AsyncResult<string>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve(result.value || '');\n        } else {\n          reject(\n            new Error(`Failed to read email subject: ${result.error?.message || 'Unknown error'}`),\n          );\n        }\n      });\n      return;\n    }\n\n    resolve('');\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Sender\n// ---------------------------------------------------------------------------\n\n/**\n * Get the sender of the currently open email.\n *\n * - Read mode:  Returns the `from` field of the received message.\n * - Compose mode: Returns the current user's account info (they are the sender).\n */\nexport function getEmailSender(): Promise<EmailContact> {\n  return new Promise((resolve, reject) => {\n    const item = getItemOrThrow();\n\n    // Read mode: item.from is a direct EmailAddressDetails object\n    if ((item as Office.MessageRead).from) {\n      const from = (item as Office.MessageRead).from;\n      resolve({\n        name: from.displayName || '',\n        email: from.emailAddress || '',\n      });\n      return;\n    }\n\n    // Compose mode: the sender is the current user\n    // Use item.from.getAsync if available (Requirement set 1.7+)\n    const fromObj = (item as any).from;\n    if (fromObj && typeof fromObj.getAsync === 'function') {\n      fromObj.getAsync((result: Office.AsyncResult<Office.EmailAddressDetails>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded && result.value) {\n          resolve({\n            name: result.value.displayName || '',\n            email: result.value.emailAddress || '',\n          });\n        } else {\n          // Fallback: use the mailbox user profile\n          resolve(getCurrentUserContact());\n        }\n      });\n      return;\n    }\n\n    // Fallback: use the mailbox user profile\n    resolve(getCurrentUserContact());\n  });\n}\n\n/**\n * Get the original sender of the email being replied to.\n *\n * - Read mode: Returns the `from` field (same as getEmailSender).\n * - Compose mode (reply): Returns the first To recipient, who is\n *   the person the user is replying to.\n * - Compose mode (new): Falls back to the current user.\n */\nexport async function getOriginalSender(): Promise<EmailContact> {\n  const mode = getItemMode();\n\n  if (mode === 'read') {\n    return getEmailSender();\n  }\n\n  // In compose mode, the first To recipient is the person being replied to\n  const item = getItemOrThrow();\n  const toRecipients = await getComposeToRecipients(item);\n\n  if (toRecipients.length > 0) {\n    return toRecipients[0];\n  }\n\n  // Fallback for new compose (no recipients yet)\n  return getEmailSender();\n}\n\n/** Get only the To recipients in compose mode. */\nfunction getComposeToRecipients(item: any): Promise<EmailContact[]> {\n  return new Promise((resolve) => {\n    const toObj = item.to;\n    if (toObj && typeof toObj.getAsync === 'function') {\n      toObj.getAsync((result: Office.AsyncResult<Office.EmailAddressDetails[]>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded && result.value) {\n          resolve(\n            result.value.map((r) => ({\n              name: r.displayName || '',\n              email: r.emailAddress || '',\n            })),\n          );\n        } else {\n          resolve([]);\n        }\n      });\n    } else {\n      resolve([]);\n    }\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Recipients\n// ---------------------------------------------------------------------------\n\n/**\n * Get all recipients (To, CC) of the currently open email.\n * Returns a flat array combining To and CC fields.\n */\nexport function getEmailRecipients(): Promise<EmailContact[]> {\n  const item = getItemOrThrow();\n  const mode = getItemMode();\n\n  if (mode === 'read') {\n    return getReadModeRecipients(item as Office.MessageRead);\n  } else {\n    return getComposeModeRecipients(item);\n  }\n}\n\n/** Read mode: To and CC are direct arrays. */\nfunction getReadModeRecipients(item: Office.MessageRead): Promise<EmailContact[]> {\n  const contacts: EmailContact[] = [];\n\n  if (item.to) {\n    for (const r of item.to) {\n      contacts.push({ name: r.displayName || '', email: r.emailAddress || '' });\n    }\n  }\n\n  if (item.cc) {\n    for (const r of item.cc) {\n      contacts.push({ name: r.displayName || '', email: r.emailAddress || '' });\n    }\n  }\n\n  return Promise.resolve(contacts);\n}\n\n/** Compose mode: To and CC require getAsync calls. */\nfunction getComposeModeRecipients(item: any): Promise<EmailContact[]> {\n  return new Promise((resolve, reject) => {\n    const contacts: EmailContact[] = [];\n    let pending = 0;\n    let hasError = false;\n\n    const tryResolve = () => {\n      if (pending === 0 && !hasError) {\n        resolve(contacts);\n      }\n    };\n\n    const processRecipientList = (recipientObj: any) => {\n      if (recipientObj && typeof recipientObj.getAsync === 'function') {\n        pending++;\n        recipientObj.getAsync((result: Office.AsyncResult<Office.EmailAddressDetails[]>) => {\n          if (result.status === Office.AsyncResultStatus.Succeeded && result.value) {\n            for (const r of result.value) {\n              contacts.push({ name: r.displayName || '', email: r.emailAddress || '' });\n            }\n          }\n          pending--;\n          tryResolve();\n        });\n      }\n    };\n\n    processRecipientList(item.to);\n    processRecipientList(item.cc);\n\n    // If neither field had getAsync, resolve immediately\n    if (pending === 0) {\n      resolve(contacts);\n    }\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Conversation / Thread\n// ---------------------------------------------------------------------------\n\n/**\n * Attempt to retrieve conversation messages for the current email thread.\n *\n * **Note:** The Office.js mailbox API does not provide direct access to\n * all messages in a conversation thread. This function returns the current\n * message's data. For full thread access, you would need the Microsoft\n * Graph API (`/me/messages?$filter=conversationId eq '...'`).\n *\n * This function returns a single-element array with the current message\n * as a starting point. The Graph-based implementation can be added in\n * Phase 5 when Microsoft Graph integration is set up.\n */\nexport async function getConversationMessages(): Promise<EmailMessage[]> {\n  const [body, subject, sender] = await Promise.all([\n    getCurrentEmailBody(),\n    getCurrentEmailSubject(),\n    getEmailSender(),\n  ]);\n\n  const item = Office.context.mailbox.item;\n  const dateTime = (item as Office.MessageRead)?.dateTimeCreated?.toISOString?.() || undefined;\n\n  return [\n    {\n      subject,\n      body,\n      sender,\n      dateTime,\n    },\n  ];\n}\n\n/**\n * Get the conversation ID for the current email.\n * This can be used later with the Microsoft Graph API to fetch\n * all messages in the same conversation thread.\n */\nexport function getConversationId(): string | undefined {\n  const item = Office.context.mailbox.item;\n  if (!item) return undefined;\n  return (item as any).conversationId || undefined;\n}\n\n// ---------------------------------------------------------------------------\n// Helpers\n// ---------------------------------------------------------------------------\n\n/**\n * Get the currently active mailbox item, or throw if none is available.\n */\nfunction getItemOrThrow(): any {\n  const item = Office.context.mailbox.item;\n  if (!item) {\n    throw new Error(\n      'No mailbox item is currently open. Make sure the add-in is activated on an email.',\n    );\n  }\n  return item as any;\n}\n\n/**\n * Get the current user's contact info from the mailbox user profile.\n * This is used as a fallback for the sender in compose mode.\n */\nfunction getCurrentUserContact(): EmailContact {\n  const profile = Office.context.mailbox.userProfile;\n  return {\n    name: profile?.displayName || '',\n    email: profile?.emailAddress || '',\n  };\n}\n\n/**\n * Strip basic HTML tags from a string to get plain text.\n * Used as a fallback when the API doesn't return plain text directly.\n */\nexport function stripHtml(html: string): string {\n  return html\n    .replace(/<style[^>]*>[\\s\\S]*?<\\/style>/gi, '')\n    .replace(/<script[^>]*>[\\s\\S]*?<\\/script>/gi, '')\n    .replace(/<[^>]+>/g, ' ')\n    .replace(/&nbsp;/g, ' ')\n    .replace(/&amp;/g, '&')\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&quot;/g, '\"')\n    .replace(/&#39;/g, \"'\")\n    .replace(/\\s+/g, ' ')\n    .trim();\n}\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/*! tailwindcss v4.1.18 | MIT License | https://tailwindcss.com */\n@layer properties;\n:root, :host {\n  --spacing: 0.25rem;\n  --text-xs: 11px;\n  --text-xs--line-height: calc(1 / 0.75);\n  --text-sm: 12px;\n  --text-sm--line-height: calc(1.25 / 0.875);\n  --text-lg: 14px;\n  --text-lg--line-height: calc(1.75 / 1.125);\n  --text-xl: 16px;\n  --text-xl--line-height: calc(1.75 / 1.25);\n  --font-weight-medium: 500;\n  --font-weight-semibold: 600;\n  --tracking-wide: 0.025em;\n  --leading-normal: 1.5;\n  --radius-xs: 4px;\n  --radius-sm: 6px;\n  --radius-md: 8px;\n  --default-transition-duration: 150ms;\n  --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  --color-glide-blue: #3b9eff;\n  --color-glide-blue-hover: #2188ed;\n  --color-glide-blue-light: #e8f3ff;\n  --color-glide-blue-glow: rgba(59, 158, 255, 0.15);\n  --color-glide-purple: #7b61db;\n  --color-glide-purple-hover: #6b51c8;\n  --color-glide-bg: #ffffff;\n  --color-glide-bg-panel: #f8f9fb;\n  --color-glide-bg-elevated: #ffffff;\n  --color-glide-border: #e2e5ea;\n  --color-glide-border-light: #eef0f3;\n  --color-glide-text: #1a1d23;\n  --color-glide-text-secondary: #5e6470;\n  --color-glide-text-tertiary: #8e95a2;\n  --color-glide-text-inverse: #ffffff;\n  --color-glide-error-bg: #fff1f0;\n  --color-glide-error-text: #d1242f;\n  --color-glide-error-border: #ffd2cf;\n  --color-glide-success: #1a7f37;\n  --spacing-xs: 4px;\n  --spacing-sm: 8px;\n  --spacing-md: 12px;\n  --spacing-lg: 16px;\n  --spacing-xl: 20px;\n  --font-glide: \"Poppins\", -apple-system, BlinkMacSystemFont, system-ui, sans-serif;\n  --text-md: 13px;\n  --ease-glide: cubic-bezier(0.25, 0.1, 0.25, 1);\n  --duration-glide: 150ms;\n  --color-dark-bg: #1e1e1e;\n  --color-dark-bg-panel: #252526;\n  --color-dark-bg-elevated: #2d2d2d;\n  --color-dark-border: #3e3e42;\n  --color-dark-border-light: #333337;\n  --color-dark-text: #e0e0e0;\n  --color-dark-text-secondary: #a0a0a0;\n  --color-dark-text-tertiary: #707070;\n  --color-dark-error-bg: #3a1a1a;\n  --color-dark-error-border: #5c2626;\n}\n.invisible {\n  visibility: hidden;\n}\n.visible {\n  visibility: visible;\n}\n.fixed {\n  position: fixed;\n}\n.relative {\n  position: relative;\n}\n.sticky {\n  position: sticky;\n}\n.top-0 {\n  top: calc(var(--spacing) * 0);\n}\n.z-10 {\n  z-index: 10;\n}\n.container {\n  width: 100%;\n  @media (width >= 40rem) {\n    max-width: 40rem;\n  }\n  @media (width >= 48rem) {\n    max-width: 48rem;\n  }\n  @media (width >= 64rem) {\n    max-width: 64rem;\n  }\n  @media (width >= 80rem) {\n    max-width: 80rem;\n  }\n  @media (width >= 96rem) {\n    max-width: 96rem;\n  }\n}\n.m-0 {\n  margin: calc(var(--spacing) * 0);\n}\n.mt-sm {\n  margin-top: var(--spacing-sm);\n}\n.mt-xs {\n  margin-top: var(--spacing-xs);\n}\n.mb-lg {\n  margin-bottom: var(--spacing-lg);\n}\n.mb-md {\n  margin-bottom: var(--spacing-md);\n}\n.mb-sm {\n  margin-bottom: var(--spacing-sm);\n}\n.mb-xs {\n  margin-bottom: var(--spacing-xs);\n}\n.block {\n  display: block;\n}\n.contents {\n  display: contents;\n}\n.flex {\n  display: flex;\n}\n.hidden {\n  display: none;\n}\n.inline {\n  display: inline;\n}\n.table {\n  display: table;\n}\n.min-h-\\\\[50vh\\\\] {\n  min-height: 50vh;\n}\n.min-h-\\\\[80px\\\\] {\n  min-height: 80px;\n}\n.min-h-\\\\[100px\\\\] {\n  min-height: 100px;\n}\n.w-full {\n  width: 100%;\n}\n.min-w-0 {\n  min-width: calc(var(--spacing) * 0);\n}\n.min-w-\\\\[55px\\\\] {\n  min-width: 55px;\n}\n.flex-1 {\n  flex: 1;\n}\n.shrink-0 {\n  flex-shrink: 0;\n}\n.transform {\n  transform: var(--tw-rotate-x,) var(--tw-rotate-y,) var(--tw-rotate-z,) var(--tw-skew-x,) var(--tw-skew-y,);\n}\n.resize-y {\n  resize: vertical;\n}\n.flex-col {\n  flex-direction: column;\n}\n.flex-wrap {\n  flex-wrap: wrap;\n}\n.items-center {\n  align-items: center;\n}\n.items-end {\n  align-items: flex-end;\n}\n.justify-center {\n  justify-content: center;\n}\n.gap-0 {\n  gap: calc(var(--spacing) * 0);\n}\n.gap-sm {\n  gap: var(--spacing-sm);\n}\n.gap-xs {\n  gap: var(--spacing-xs);\n}\n.truncate {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.overflow-x-hidden {\n  overflow-x: hidden;\n}\n.rounded-sm {\n  border-radius: var(--radius-sm);\n}\n.border {\n  border-style: var(--tw-border-style);\n  border-width: 1px;\n}\n.border-t {\n  border-top-style: var(--tw-border-style);\n  border-top-width: 1px;\n}\n.border-b {\n  border-bottom-style: var(--tw-border-style);\n  border-bottom-width: 1px;\n}\n.border-glide-border {\n  border-color: var(--color-glide-border);\n}\n.border-glide-border-light {\n  border-color: var(--color-glide-border-light);\n}\n.bg-glide-bg {\n  background-color: var(--color-glide-bg);\n}\n.p-0 {\n  padding: calc(var(--spacing) * 0);\n}\n.p-lg {\n  padding: var(--spacing-lg);\n}\n.p-sm {\n  padding: var(--spacing-sm);\n}\n.p-xl {\n  padding: var(--spacing-xl);\n}\n.pb-\\\\[7px\\\\] {\n  padding-bottom: 7px;\n}\n.text-center {\n  text-align: center;\n}\n.font-glide {\n  font-family: var(--font-glide);\n}\n.text-lg {\n  font-size: var(--text-lg);\n  line-height: var(--tw-leading, var(--text-lg--line-height));\n}\n.text-sm {\n  font-size: var(--text-sm);\n  line-height: var(--tw-leading, var(--text-sm--line-height));\n}\n.text-xl {\n  font-size: var(--text-xl);\n  line-height: var(--tw-leading, var(--text-xl--line-height));\n}\n.text-xs {\n  font-size: var(--text-xs);\n  line-height: var(--tw-leading, var(--text-xs--line-height));\n}\n.text-md {\n  font-size: var(--text-md);\n}\n.leading-normal {\n  --tw-leading: var(--leading-normal);\n  line-height: var(--leading-normal);\n}\n.font-medium {\n  --tw-font-weight: var(--font-weight-medium);\n  font-weight: var(--font-weight-medium);\n}\n.font-semibold {\n  --tw-font-weight: var(--font-weight-semibold);\n  font-weight: var(--font-weight-semibold);\n}\n.tracking-wide {\n  --tw-tracking: var(--tracking-wide);\n  letter-spacing: var(--tracking-wide);\n}\n.text-glide-blue {\n  color: var(--color-glide-blue);\n}\n.text-glide-success {\n  color: var(--color-glide-success);\n}\n.text-glide-text {\n  color: var(--color-glide-text);\n}\n.text-glide-text-secondary {\n  color: var(--color-glide-text-secondary);\n}\n.text-glide-text-tertiary {\n  color: var(--color-glide-text-tertiary);\n}\n.uppercase {\n  text-transform: uppercase;\n}\n.no-underline {\n  text-decoration-line: none;\n}\n.antialiased {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n.ring {\n  --tw-ring-shadow: var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color, currentcolor);\n  box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n}\n.filter {\n  filter: var(--tw-blur,) var(--tw-brightness,) var(--tw-contrast,) var(--tw-grayscale,) var(--tw-hue-rotate,) var(--tw-invert,) var(--tw-saturate,) var(--tw-sepia,) var(--tw-drop-shadow,);\n}\n.transition-\\\\[border-color\\\\,box-shadow\\\\] {\n  transition-property: border-color,box-shadow;\n  transition-timing-function: var(--tw-ease, var(--default-transition-timing-function));\n  transition-duration: var(--tw-duration, var(--default-transition-duration));\n}\n.duration-\\\\[var\\\\(--duration-glide\\\\)\\\\] {\n  --tw-duration: var(--duration-glide);\n  transition-duration: var(--duration-glide);\n}\n.outline-none {\n  --tw-outline-style: none;\n  outline-style: none;\n}\n.hover\\\\:underline {\n  &:hover {\n    @media (hover: hover) {\n      text-decoration-line: underline;\n    }\n  }\n}\n.focus\\\\:border-glide-blue {\n  &:focus {\n    border-color: var(--color-glide-blue);\n  }\n}\n.focus\\\\:shadow-\\\\[0_0_0_2px_var\\\\(--color-glide-blue-glow\\\\)\\\\] {\n  &:focus {\n    --tw-shadow: 0 0 0 2px var(--tw-shadow-color, var(--color-glide-blue-glow));\n    box-shadow: var(--tw-inset-shadow), var(--tw-inset-ring-shadow), var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow);\n  }\n}\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n[data-theme=\"dark\"] {\n  --color-glide-bg: var(--color-dark-bg);\n  --color-glide-bg-panel: var(--color-dark-bg-panel);\n  --color-glide-bg-elevated: var(--color-dark-bg-elevated);\n  --color-glide-border: var(--color-dark-border);\n  --color-glide-border-light: var(--color-dark-border-light);\n  --color-glide-text: var(--color-dark-text);\n  --color-glide-text-secondary: var(--color-dark-text-secondary);\n  --color-glide-text-tertiary: var(--color-dark-text-tertiary);\n  --color-glide-error-bg: var(--color-dark-error-bg);\n  --color-glide-error-border: var(--color-dark-error-border);\n}\n@property --tw-rotate-x {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-rotate-y {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-rotate-z {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-skew-x {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-skew-y {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-border-style {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: solid;\n}\n@property --tw-leading {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-font-weight {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-tracking {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-shadow {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-shadow-color {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-shadow-alpha {\n  syntax: \"<percentage>\";\n  inherits: false;\n  initial-value: 100%;\n}\n@property --tw-inset-shadow {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-inset-shadow-color {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-inset-shadow-alpha {\n  syntax: \"<percentage>\";\n  inherits: false;\n  initial-value: 100%;\n}\n@property --tw-ring-color {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-ring-shadow {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-inset-ring-color {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-inset-ring-shadow {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-ring-inset {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-ring-offset-width {\n  syntax: \"<length>\";\n  inherits: false;\n  initial-value: 0px;\n}\n@property --tw-ring-offset-color {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: #fff;\n}\n@property --tw-ring-offset-shadow {\n  syntax: \"*\";\n  inherits: false;\n  initial-value: 0 0 #0000;\n}\n@property --tw-blur {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-brightness {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-contrast {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-grayscale {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-hue-rotate {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-invert {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-opacity {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-saturate {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-sepia {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-drop-shadow {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-drop-shadow-color {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-drop-shadow-alpha {\n  syntax: \"<percentage>\";\n  inherits: false;\n  initial-value: 100%;\n}\n@property --tw-drop-shadow-size {\n  syntax: \"*\";\n  inherits: false;\n}\n@property --tw-duration {\n  syntax: \"*\";\n  inherits: false;\n}\n@layer properties {\n  @supports ((-webkit-hyphens: none) and (not (margin-trim: inline))) or ((-moz-orient: inline) and (not (color:rgb(from red r g b)))) {\n    *, ::before, ::after, ::backdrop {\n      --tw-rotate-x: initial;\n      --tw-rotate-y: initial;\n      --tw-rotate-z: initial;\n      --tw-skew-x: initial;\n      --tw-skew-y: initial;\n      --tw-border-style: solid;\n      --tw-leading: initial;\n      --tw-font-weight: initial;\n      --tw-tracking: initial;\n      --tw-shadow: 0 0 #0000;\n      --tw-shadow-color: initial;\n      --tw-shadow-alpha: 100%;\n      --tw-inset-shadow: 0 0 #0000;\n      --tw-inset-shadow-color: initial;\n      --tw-inset-shadow-alpha: 100%;\n      --tw-ring-color: initial;\n      --tw-ring-shadow: 0 0 #0000;\n      --tw-inset-ring-color: initial;\n      --tw-inset-ring-shadow: 0 0 #0000;\n      --tw-ring-inset: initial;\n      --tw-ring-offset-width: 0px;\n      --tw-ring-offset-color: #fff;\n      --tw-ring-offset-shadow: 0 0 #0000;\n      --tw-blur: initial;\n      --tw-brightness: initial;\n      --tw-contrast: initial;\n      --tw-grayscale: initial;\n      --tw-hue-rotate: initial;\n      --tw-invert: initial;\n      --tw-opacity: initial;\n      --tw-saturate: initial;\n      --tw-sepia: initial;\n      --tw-drop-shadow: initial;\n      --tw-drop-shadow-color: initial;\n      --tw-drop-shadow-alpha: 100%;\n      --tw-drop-shadow-size: initial;\n      --tw-duration: initial;\n    }\n  }\n}\n`, \"\",{\"version\":3,\"sources\":[\"<no source>\",\"webpack://./node_modules/tailwindcss/utilities.css\",\"webpack://./node_modules/tailwindcss/theme.css\",\"webpack://./src/styles/main.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[null,\"@tailwind utilities;\\n\",\"@theme default {\\n  --font-sans:\\n    ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',\\n    'Noto Color Emoji';\\n  --font-serif: ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif;\\n  --font-mono:\\n    ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New',\\n    monospace;\\n\\n  --color-red-50: oklch(97.1% 0.013 17.38);\\n  --color-red-100: oklch(93.6% 0.032 17.717);\\n  --color-red-200: oklch(88.5% 0.062 18.334);\\n  --color-red-300: oklch(80.8% 0.114 19.571);\\n  --color-red-400: oklch(70.4% 0.191 22.216);\\n  --color-red-500: oklch(63.7% 0.237 25.331);\\n  --color-red-600: oklch(57.7% 0.245 27.325);\\n  --color-red-700: oklch(50.5% 0.213 27.518);\\n  --color-red-800: oklch(44.4% 0.177 26.899);\\n  --color-red-900: oklch(39.6% 0.141 25.723);\\n  --color-red-950: oklch(25.8% 0.092 26.042);\\n\\n  --color-orange-50: oklch(98% 0.016 73.684);\\n  --color-orange-100: oklch(95.4% 0.038 75.164);\\n  --color-orange-200: oklch(90.1% 0.076 70.697);\\n  --color-orange-300: oklch(83.7% 0.128 66.29);\\n  --color-orange-400: oklch(75% 0.183 55.934);\\n  --color-orange-500: oklch(70.5% 0.213 47.604);\\n  --color-orange-600: oklch(64.6% 0.222 41.116);\\n  --color-orange-700: oklch(55.3% 0.195 38.402);\\n  --color-orange-800: oklch(47% 0.157 37.304);\\n  --color-orange-900: oklch(40.8% 0.123 38.172);\\n  --color-orange-950: oklch(26.6% 0.079 36.259);\\n\\n  --color-amber-50: oklch(98.7% 0.022 95.277);\\n  --color-amber-100: oklch(96.2% 0.059 95.617);\\n  --color-amber-200: oklch(92.4% 0.12 95.746);\\n  --color-amber-300: oklch(87.9% 0.169 91.605);\\n  --color-amber-400: oklch(82.8% 0.189 84.429);\\n  --color-amber-500: oklch(76.9% 0.188 70.08);\\n  --color-amber-600: oklch(66.6% 0.179 58.318);\\n  --color-amber-700: oklch(55.5% 0.163 48.998);\\n  --color-amber-800: oklch(47.3% 0.137 46.201);\\n  --color-amber-900: oklch(41.4% 0.112 45.904);\\n  --color-amber-950: oklch(27.9% 0.077 45.635);\\n\\n  --color-yellow-50: oklch(98.7% 0.026 102.212);\\n  --color-yellow-100: oklch(97.3% 0.071 103.193);\\n  --color-yellow-200: oklch(94.5% 0.129 101.54);\\n  --color-yellow-300: oklch(90.5% 0.182 98.111);\\n  --color-yellow-400: oklch(85.2% 0.199 91.936);\\n  --color-yellow-500: oklch(79.5% 0.184 86.047);\\n  --color-yellow-600: oklch(68.1% 0.162 75.834);\\n  --color-yellow-700: oklch(55.4% 0.135 66.442);\\n  --color-yellow-800: oklch(47.6% 0.114 61.907);\\n  --color-yellow-900: oklch(42.1% 0.095 57.708);\\n  --color-yellow-950: oklch(28.6% 0.066 53.813);\\n\\n  --color-lime-50: oklch(98.6% 0.031 120.757);\\n  --color-lime-100: oklch(96.7% 0.067 122.328);\\n  --color-lime-200: oklch(93.8% 0.127 124.321);\\n  --color-lime-300: oklch(89.7% 0.196 126.665);\\n  --color-lime-400: oklch(84.1% 0.238 128.85);\\n  --color-lime-500: oklch(76.8% 0.233 130.85);\\n  --color-lime-600: oklch(64.8% 0.2 131.684);\\n  --color-lime-700: oklch(53.2% 0.157 131.589);\\n  --color-lime-800: oklch(45.3% 0.124 130.933);\\n  --color-lime-900: oklch(40.5% 0.101 131.063);\\n  --color-lime-950: oklch(27.4% 0.072 132.109);\\n\\n  --color-green-50: oklch(98.2% 0.018 155.826);\\n  --color-green-100: oklch(96.2% 0.044 156.743);\\n  --color-green-200: oklch(92.5% 0.084 155.995);\\n  --color-green-300: oklch(87.1% 0.15 154.449);\\n  --color-green-400: oklch(79.2% 0.209 151.711);\\n  --color-green-500: oklch(72.3% 0.219 149.579);\\n  --color-green-600: oklch(62.7% 0.194 149.214);\\n  --color-green-700: oklch(52.7% 0.154 150.069);\\n  --color-green-800: oklch(44.8% 0.119 151.328);\\n  --color-green-900: oklch(39.3% 0.095 152.535);\\n  --color-green-950: oklch(26.6% 0.065 152.934);\\n\\n  --color-emerald-50: oklch(97.9% 0.021 166.113);\\n  --color-emerald-100: oklch(95% 0.052 163.051);\\n  --color-emerald-200: oklch(90.5% 0.093 164.15);\\n  --color-emerald-300: oklch(84.5% 0.143 164.978);\\n  --color-emerald-400: oklch(76.5% 0.177 163.223);\\n  --color-emerald-500: oklch(69.6% 0.17 162.48);\\n  --color-emerald-600: oklch(59.6% 0.145 163.225);\\n  --color-emerald-700: oklch(50.8% 0.118 165.612);\\n  --color-emerald-800: oklch(43.2% 0.095 166.913);\\n  --color-emerald-900: oklch(37.8% 0.077 168.94);\\n  --color-emerald-950: oklch(26.2% 0.051 172.552);\\n\\n  --color-teal-50: oklch(98.4% 0.014 180.72);\\n  --color-teal-100: oklch(95.3% 0.051 180.801);\\n  --color-teal-200: oklch(91% 0.096 180.426);\\n  --color-teal-300: oklch(85.5% 0.138 181.071);\\n  --color-teal-400: oklch(77.7% 0.152 181.912);\\n  --color-teal-500: oklch(70.4% 0.14 182.503);\\n  --color-teal-600: oklch(60% 0.118 184.704);\\n  --color-teal-700: oklch(51.1% 0.096 186.391);\\n  --color-teal-800: oklch(43.7% 0.078 188.216);\\n  --color-teal-900: oklch(38.6% 0.063 188.416);\\n  --color-teal-950: oklch(27.7% 0.046 192.524);\\n\\n  --color-cyan-50: oklch(98.4% 0.019 200.873);\\n  --color-cyan-100: oklch(95.6% 0.045 203.388);\\n  --color-cyan-200: oklch(91.7% 0.08 205.041);\\n  --color-cyan-300: oklch(86.5% 0.127 207.078);\\n  --color-cyan-400: oklch(78.9% 0.154 211.53);\\n  --color-cyan-500: oklch(71.5% 0.143 215.221);\\n  --color-cyan-600: oklch(60.9% 0.126 221.723);\\n  --color-cyan-700: oklch(52% 0.105 223.128);\\n  --color-cyan-800: oklch(45% 0.085 224.283);\\n  --color-cyan-900: oklch(39.8% 0.07 227.392);\\n  --color-cyan-950: oklch(30.2% 0.056 229.695);\\n\\n  --color-sky-50: oklch(97.7% 0.013 236.62);\\n  --color-sky-100: oklch(95.1% 0.026 236.824);\\n  --color-sky-200: oklch(90.1% 0.058 230.902);\\n  --color-sky-300: oklch(82.8% 0.111 230.318);\\n  --color-sky-400: oklch(74.6% 0.16 232.661);\\n  --color-sky-500: oklch(68.5% 0.169 237.323);\\n  --color-sky-600: oklch(58.8% 0.158 241.966);\\n  --color-sky-700: oklch(50% 0.134 242.749);\\n  --color-sky-800: oklch(44.3% 0.11 240.79);\\n  --color-sky-900: oklch(39.1% 0.09 240.876);\\n  --color-sky-950: oklch(29.3% 0.066 243.157);\\n\\n  --color-blue-50: oklch(97% 0.014 254.604);\\n  --color-blue-100: oklch(93.2% 0.032 255.585);\\n  --color-blue-200: oklch(88.2% 0.059 254.128);\\n  --color-blue-300: oklch(80.9% 0.105 251.813);\\n  --color-blue-400: oklch(70.7% 0.165 254.624);\\n  --color-blue-500: oklch(62.3% 0.214 259.815);\\n  --color-blue-600: oklch(54.6% 0.245 262.881);\\n  --color-blue-700: oklch(48.8% 0.243 264.376);\\n  --color-blue-800: oklch(42.4% 0.199 265.638);\\n  --color-blue-900: oklch(37.9% 0.146 265.522);\\n  --color-blue-950: oklch(28.2% 0.091 267.935);\\n\\n  --color-indigo-50: oklch(96.2% 0.018 272.314);\\n  --color-indigo-100: oklch(93% 0.034 272.788);\\n  --color-indigo-200: oklch(87% 0.065 274.039);\\n  --color-indigo-300: oklch(78.5% 0.115 274.713);\\n  --color-indigo-400: oklch(67.3% 0.182 276.935);\\n  --color-indigo-500: oklch(58.5% 0.233 277.117);\\n  --color-indigo-600: oklch(51.1% 0.262 276.966);\\n  --color-indigo-700: oklch(45.7% 0.24 277.023);\\n  --color-indigo-800: oklch(39.8% 0.195 277.366);\\n  --color-indigo-900: oklch(35.9% 0.144 278.697);\\n  --color-indigo-950: oklch(25.7% 0.09 281.288);\\n\\n  --color-violet-50: oklch(96.9% 0.016 293.756);\\n  --color-violet-100: oklch(94.3% 0.029 294.588);\\n  --color-violet-200: oklch(89.4% 0.057 293.283);\\n  --color-violet-300: oklch(81.1% 0.111 293.571);\\n  --color-violet-400: oklch(70.2% 0.183 293.541);\\n  --color-violet-500: oklch(60.6% 0.25 292.717);\\n  --color-violet-600: oklch(54.1% 0.281 293.009);\\n  --color-violet-700: oklch(49.1% 0.27 292.581);\\n  --color-violet-800: oklch(43.2% 0.232 292.759);\\n  --color-violet-900: oklch(38% 0.189 293.745);\\n  --color-violet-950: oklch(28.3% 0.141 291.089);\\n\\n  --color-purple-50: oklch(97.7% 0.014 308.299);\\n  --color-purple-100: oklch(94.6% 0.033 307.174);\\n  --color-purple-200: oklch(90.2% 0.063 306.703);\\n  --color-purple-300: oklch(82.7% 0.119 306.383);\\n  --color-purple-400: oklch(71.4% 0.203 305.504);\\n  --color-purple-500: oklch(62.7% 0.265 303.9);\\n  --color-purple-600: oklch(55.8% 0.288 302.321);\\n  --color-purple-700: oklch(49.6% 0.265 301.924);\\n  --color-purple-800: oklch(43.8% 0.218 303.724);\\n  --color-purple-900: oklch(38.1% 0.176 304.987);\\n  --color-purple-950: oklch(29.1% 0.149 302.717);\\n\\n  --color-fuchsia-50: oklch(97.7% 0.017 320.058);\\n  --color-fuchsia-100: oklch(95.2% 0.037 318.852);\\n  --color-fuchsia-200: oklch(90.3% 0.076 319.62);\\n  --color-fuchsia-300: oklch(83.3% 0.145 321.434);\\n  --color-fuchsia-400: oklch(74% 0.238 322.16);\\n  --color-fuchsia-500: oklch(66.7% 0.295 322.15);\\n  --color-fuchsia-600: oklch(59.1% 0.293 322.896);\\n  --color-fuchsia-700: oklch(51.8% 0.253 323.949);\\n  --color-fuchsia-800: oklch(45.2% 0.211 324.591);\\n  --color-fuchsia-900: oklch(40.1% 0.17 325.612);\\n  --color-fuchsia-950: oklch(29.3% 0.136 325.661);\\n\\n  --color-pink-50: oklch(97.1% 0.014 343.198);\\n  --color-pink-100: oklch(94.8% 0.028 342.258);\\n  --color-pink-200: oklch(89.9% 0.061 343.231);\\n  --color-pink-300: oklch(82.3% 0.12 346.018);\\n  --color-pink-400: oklch(71.8% 0.202 349.761);\\n  --color-pink-500: oklch(65.6% 0.241 354.308);\\n  --color-pink-600: oklch(59.2% 0.249 0.584);\\n  --color-pink-700: oklch(52.5% 0.223 3.958);\\n  --color-pink-800: oklch(45.9% 0.187 3.815);\\n  --color-pink-900: oklch(40.8% 0.153 2.432);\\n  --color-pink-950: oklch(28.4% 0.109 3.907);\\n\\n  --color-rose-50: oklch(96.9% 0.015 12.422);\\n  --color-rose-100: oklch(94.1% 0.03 12.58);\\n  --color-rose-200: oklch(89.2% 0.058 10.001);\\n  --color-rose-300: oklch(81% 0.117 11.638);\\n  --color-rose-400: oklch(71.2% 0.194 13.428);\\n  --color-rose-500: oklch(64.5% 0.246 16.439);\\n  --color-rose-600: oklch(58.6% 0.253 17.585);\\n  --color-rose-700: oklch(51.4% 0.222 16.935);\\n  --color-rose-800: oklch(45.5% 0.188 13.697);\\n  --color-rose-900: oklch(41% 0.159 10.272);\\n  --color-rose-950: oklch(27.1% 0.105 12.094);\\n\\n  --color-slate-50: oklch(98.4% 0.003 247.858);\\n  --color-slate-100: oklch(96.8% 0.007 247.896);\\n  --color-slate-200: oklch(92.9% 0.013 255.508);\\n  --color-slate-300: oklch(86.9% 0.022 252.894);\\n  --color-slate-400: oklch(70.4% 0.04 256.788);\\n  --color-slate-500: oklch(55.4% 0.046 257.417);\\n  --color-slate-600: oklch(44.6% 0.043 257.281);\\n  --color-slate-700: oklch(37.2% 0.044 257.287);\\n  --color-slate-800: oklch(27.9% 0.041 260.031);\\n  --color-slate-900: oklch(20.8% 0.042 265.755);\\n  --color-slate-950: oklch(12.9% 0.042 264.695);\\n\\n  --color-gray-50: oklch(98.5% 0.002 247.839);\\n  --color-gray-100: oklch(96.7% 0.003 264.542);\\n  --color-gray-200: oklch(92.8% 0.006 264.531);\\n  --color-gray-300: oklch(87.2% 0.01 258.338);\\n  --color-gray-400: oklch(70.7% 0.022 261.325);\\n  --color-gray-500: oklch(55.1% 0.027 264.364);\\n  --color-gray-600: oklch(44.6% 0.03 256.802);\\n  --color-gray-700: oklch(37.3% 0.034 259.733);\\n  --color-gray-800: oklch(27.8% 0.033 256.848);\\n  --color-gray-900: oklch(21% 0.034 264.665);\\n  --color-gray-950: oklch(13% 0.028 261.692);\\n\\n  --color-zinc-50: oklch(98.5% 0 0);\\n  --color-zinc-100: oklch(96.7% 0.001 286.375);\\n  --color-zinc-200: oklch(92% 0.004 286.32);\\n  --color-zinc-300: oklch(87.1% 0.006 286.286);\\n  --color-zinc-400: oklch(70.5% 0.015 286.067);\\n  --color-zinc-500: oklch(55.2% 0.016 285.938);\\n  --color-zinc-600: oklch(44.2% 0.017 285.786);\\n  --color-zinc-700: oklch(37% 0.013 285.805);\\n  --color-zinc-800: oklch(27.4% 0.006 286.033);\\n  --color-zinc-900: oklch(21% 0.006 285.885);\\n  --color-zinc-950: oklch(14.1% 0.005 285.823);\\n\\n  --color-neutral-50: oklch(98.5% 0 0);\\n  --color-neutral-100: oklch(97% 0 0);\\n  --color-neutral-200: oklch(92.2% 0 0);\\n  --color-neutral-300: oklch(87% 0 0);\\n  --color-neutral-400: oklch(70.8% 0 0);\\n  --color-neutral-500: oklch(55.6% 0 0);\\n  --color-neutral-600: oklch(43.9% 0 0);\\n  --color-neutral-700: oklch(37.1% 0 0);\\n  --color-neutral-800: oklch(26.9% 0 0);\\n  --color-neutral-900: oklch(20.5% 0 0);\\n  --color-neutral-950: oklch(14.5% 0 0);\\n\\n  --color-stone-50: oklch(98.5% 0.001 106.423);\\n  --color-stone-100: oklch(97% 0.001 106.424);\\n  --color-stone-200: oklch(92.3% 0.003 48.717);\\n  --color-stone-300: oklch(86.9% 0.005 56.366);\\n  --color-stone-400: oklch(70.9% 0.01 56.259);\\n  --color-stone-500: oklch(55.3% 0.013 58.071);\\n  --color-stone-600: oklch(44.4% 0.011 73.639);\\n  --color-stone-700: oklch(37.4% 0.01 67.558);\\n  --color-stone-800: oklch(26.8% 0.007 34.298);\\n  --color-stone-900: oklch(21.6% 0.006 56.043);\\n  --color-stone-950: oklch(14.7% 0.004 49.25);\\n\\n  --color-black: #000;\\n  --color-white: #fff;\\n\\n  --spacing: 0.25rem;\\n\\n  --breakpoint-sm: 40rem;\\n  --breakpoint-md: 48rem;\\n  --breakpoint-lg: 64rem;\\n  --breakpoint-xl: 80rem;\\n  --breakpoint-2xl: 96rem;\\n\\n  --container-3xs: 16rem;\\n  --container-2xs: 18rem;\\n  --container-xs: 20rem;\\n  --container-sm: 24rem;\\n  --container-md: 28rem;\\n  --container-lg: 32rem;\\n  --container-xl: 36rem;\\n  --container-2xl: 42rem;\\n  --container-3xl: 48rem;\\n  --container-4xl: 56rem;\\n  --container-5xl: 64rem;\\n  --container-6xl: 72rem;\\n  --container-7xl: 80rem;\\n\\n  --text-xs: 0.75rem;\\n  --text-xs--line-height: calc(1 / 0.75);\\n  --text-sm: 0.875rem;\\n  --text-sm--line-height: calc(1.25 / 0.875);\\n  --text-base: 1rem;\\n  --text-base--line-height: calc(1.5 / 1);\\n  --text-lg: 1.125rem;\\n  --text-lg--line-height: calc(1.75 / 1.125);\\n  --text-xl: 1.25rem;\\n  --text-xl--line-height: calc(1.75 / 1.25);\\n  --text-2xl: 1.5rem;\\n  --text-2xl--line-height: calc(2 / 1.5);\\n  --text-3xl: 1.875rem;\\n  --text-3xl--line-height: calc(2.25 / 1.875);\\n  --text-4xl: 2.25rem;\\n  --text-4xl--line-height: calc(2.5 / 2.25);\\n  --text-5xl: 3rem;\\n  --text-5xl--line-height: 1;\\n  --text-6xl: 3.75rem;\\n  --text-6xl--line-height: 1;\\n  --text-7xl: 4.5rem;\\n  --text-7xl--line-height: 1;\\n  --text-8xl: 6rem;\\n  --text-8xl--line-height: 1;\\n  --text-9xl: 8rem;\\n  --text-9xl--line-height: 1;\\n\\n  --font-weight-thin: 100;\\n  --font-weight-extralight: 200;\\n  --font-weight-light: 300;\\n  --font-weight-normal: 400;\\n  --font-weight-medium: 500;\\n  --font-weight-semibold: 600;\\n  --font-weight-bold: 700;\\n  --font-weight-extrabold: 800;\\n  --font-weight-black: 900;\\n\\n  --tracking-tighter: -0.05em;\\n  --tracking-tight: -0.025em;\\n  --tracking-normal: 0em;\\n  --tracking-wide: 0.025em;\\n  --tracking-wider: 0.05em;\\n  --tracking-widest: 0.1em;\\n\\n  --leading-tight: 1.25;\\n  --leading-snug: 1.375;\\n  --leading-normal: 1.5;\\n  --leading-relaxed: 1.625;\\n  --leading-loose: 2;\\n\\n  --radius-xs: 0.125rem;\\n  --radius-sm: 0.25rem;\\n  --radius-md: 0.375rem;\\n  --radius-lg: 0.5rem;\\n  --radius-xl: 0.75rem;\\n  --radius-2xl: 1rem;\\n  --radius-3xl: 1.5rem;\\n  --radius-4xl: 2rem;\\n\\n  --shadow-2xs: 0 1px rgb(0 0 0 / 0.05);\\n  --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);\\n  --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\\n  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);\\n  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);\\n  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);\\n  --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);\\n\\n  --inset-shadow-2xs: inset 0 1px rgb(0 0 0 / 0.05);\\n  --inset-shadow-xs: inset 0 1px 1px rgb(0 0 0 / 0.05);\\n  --inset-shadow-sm: inset 0 2px 4px rgb(0 0 0 / 0.05);\\n\\n  --drop-shadow-xs: 0 1px 1px rgb(0 0 0 / 0.05);\\n  --drop-shadow-sm: 0 1px 2px rgb(0 0 0 / 0.15);\\n  --drop-shadow-md: 0 3px 3px rgb(0 0 0 / 0.12);\\n  --drop-shadow-lg: 0 4px 4px rgb(0 0 0 / 0.15);\\n  --drop-shadow-xl: 0 9px 7px rgb(0 0 0 / 0.1);\\n  --drop-shadow-2xl: 0 25px 25px rgb(0 0 0 / 0.15);\\n\\n  --text-shadow-2xs: 0px 1px 0px rgb(0 0 0 / 0.15);\\n  --text-shadow-xs: 0px 1px 1px rgb(0 0 0 / 0.2);\\n  --text-shadow-sm:\\n    0px 1px 0px rgb(0 0 0 / 0.075), 0px 1px 1px rgb(0 0 0 / 0.075), 0px 2px 2px rgb(0 0 0 / 0.075);\\n  --text-shadow-md:\\n    0px 1px 1px rgb(0 0 0 / 0.1), 0px 1px 2px rgb(0 0 0 / 0.1), 0px 2px 4px rgb(0 0 0 / 0.1);\\n  --text-shadow-lg:\\n    0px 1px 2px rgb(0 0 0 / 0.1), 0px 3px 2px rgb(0 0 0 / 0.1), 0px 4px 8px rgb(0 0 0 / 0.1);\\n\\n  --ease-in: cubic-bezier(0.4, 0, 1, 1);\\n  --ease-out: cubic-bezier(0, 0, 0.2, 1);\\n  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);\\n\\n  --animate-spin: spin 1s linear infinite;\\n  --animate-ping: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;\\n  --animate-pulse: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\\n  --animate-bounce: bounce 1s infinite;\\n\\n  @keyframes spin {\\n    to {\\n      transform: rotate(360deg);\\n    }\\n  }\\n\\n  @keyframes ping {\\n    75%,\\n    100% {\\n      transform: scale(2);\\n      opacity: 0;\\n    }\\n  }\\n\\n  @keyframes pulse {\\n    50% {\\n      opacity: 0.5;\\n    }\\n  }\\n\\n  @keyframes bounce {\\n    0%,\\n    100% {\\n      transform: translateY(-25%);\\n      animation-timing-function: cubic-bezier(0.8, 0, 1, 1);\\n    }\\n\\n    50% {\\n      transform: none;\\n      animation-timing-function: cubic-bezier(0, 0, 0.2, 1);\\n    }\\n  }\\n\\n  --blur-xs: 4px;\\n  --blur-sm: 8px;\\n  --blur-md: 12px;\\n  --blur-lg: 16px;\\n  --blur-xl: 24px;\\n  --blur-2xl: 40px;\\n  --blur-3xl: 64px;\\n\\n  --perspective-dramatic: 100px;\\n  --perspective-near: 300px;\\n  --perspective-normal: 500px;\\n  --perspective-midrange: 800px;\\n  --perspective-distant: 1200px;\\n\\n  --aspect-video: 16 / 9;\\n\\n  --default-transition-duration: 150ms;\\n  --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\\n  --default-font-family: --theme(--font-sans, initial);\\n  --default-font-feature-settings: --theme(--font-sans--font-feature-settings, initial);\\n  --default-font-variation-settings: --theme(--font-sans--font-variation-settings, initial);\\n  --default-mono-font-family: --theme(--font-mono, initial);\\n  --default-mono-font-feature-settings: --theme(--font-mono--font-feature-settings, initial);\\n  --default-mono-font-variation-settings: --theme(--font-mono--font-variation-settings, initial);\\n}\\n\\n/* Deprecated */\\n@theme default inline reference {\\n  --blur: 8px;\\n  --shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);\\n  --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);\\n  --drop-shadow: 0 1px 2px rgb(0 0 0 / 0.1), 0 1px 1px rgb(0 0 0 / 0.06);\\n  --radius: 0.25rem;\\n  --max-width-prose: 65ch;\\n}\\n\",\"/* ================================================================\\n   AI Compose  Main Stylesheet (Tailwind CSS v4)\\n\\n   This file bootstraps Tailwind CSS and defines custom design tokens\\n   through the CSS-first @theme directive. All values align with the\\n   existing AI Compose design system (--glide-* custom properties).\\n\\n    Rizonetech (Pty) Ltd.  https://rizonesoft.com\\n   ================================================================ */\\n\\n@import \\\"tailwindcss/theme\\\";\\n@import \\\"tailwindcss/utilities\\\";\\n\\n/* Box-sizing reset (preflight is skipped to preserve existing styles) */\\n*,\\n*::before,\\n*::after {\\n  box-sizing: border-box;\\n}\\n\\n/* ================================================================\\n   Custom Design Tokens\\n   ================================================================ */\\n\\n@theme {\\n  /* Brand  AI Compose sparkle icon palette */\\n  --color-glide-blue: #3b9eff;\\n  --color-glide-blue-hover: #2188ed;\\n  --color-glide-blue-light: #e8f3ff;\\n  --color-glide-blue-glow: rgba(59, 158, 255, 0.15);\\n  --color-glide-purple: #7b61db;\\n  --color-glide-purple-hover: #6b51c8;\\n\\n  /* Surfaces */\\n  --color-glide-bg: #ffffff;\\n  --color-glide-bg-panel: #f8f9fb;\\n  --color-glide-bg-elevated: #ffffff;\\n\\n  /* Borders */\\n  --color-glide-border: #e2e5ea;\\n  --color-glide-border-light: #eef0f3;\\n  --color-glide-border-focus: #3b9eff;\\n\\n  /* Text */\\n  --color-glide-text: #1a1d23;\\n  --color-glide-text-secondary: #5e6470;\\n  --color-glide-text-tertiary: #8e95a2;\\n  --color-glide-text-inverse: #ffffff;\\n\\n  /* Status */\\n  --color-glide-error-bg: #fff1f0;\\n  --color-glide-error-text: #d1242f;\\n  --color-glide-error-border: #ffd2cf;\\n  --color-glide-success: #1a7f37;\\n\\n  /* Spacing (4px grid) */\\n  --spacing-xs: 4px;\\n  --spacing-sm: 8px;\\n  --spacing-md: 12px;\\n  --spacing-lg: 16px;\\n  --spacing-xl: 20px;\\n\\n  /* Border radius */\\n  --radius-xs: 4px;\\n  --radius-sm: 6px;\\n  --radius-md: 8px;\\n\\n  /* Typography */\\n  --font-glide: \\\"Poppins\\\", -apple-system, BlinkMacSystemFont, system-ui, sans-serif;\\n  --text-xs: 11px;\\n  --text-sm: 12px;\\n  --text-md: 13px;\\n  --text-lg: 14px;\\n  --text-xl: 16px;\\n\\n  /* Motion */\\n  --ease-glide: cubic-bezier(0.25, 0.1, 0.25, 1);\\n  --duration-glide: 150ms;\\n\\n  /* Dark theme surfaces (used via .dark variant) */\\n  --color-dark-bg: #1e1e1e;\\n  --color-dark-bg-panel: #252526;\\n  --color-dark-bg-elevated: #2d2d2d;\\n  --color-dark-border: #3e3e42;\\n  --color-dark-border-light: #333337;\\n  --color-dark-text: #e0e0e0;\\n  --color-dark-text-secondary: #a0a0a0;\\n  --color-dark-text-tertiary: #707070;\\n  --color-dark-error-bg: #3a1a1a;\\n  --color-dark-error-border: #5c2626;\\n}\\n\\n/* ================================================================\\n   Dark theme  activated by adding `data-theme=\\\"dark\\\"` to <html>\\n   or via Outlook's theme detection in taskpane.ts\\n   ================================================================ */\\n\\n[data-theme=\\\"dark\\\"] {\\n  --color-glide-bg: var(--color-dark-bg);\\n  --color-glide-bg-panel: var(--color-dark-bg-panel);\\n  --color-glide-bg-elevated: var(--color-dark-bg-elevated);\\n  --color-glide-border: var(--color-dark-border);\\n  --color-glide-border-light: var(--color-dark-border-light);\\n  --color-glide-text: var(--color-dark-text);\\n  --color-glide-text-secondary: var(--color-dark-text-secondary);\\n  --color-glide-text-tertiary: var(--color-dark-text-tertiary);\\n  --color-glide-error-bg: var(--color-dark-error-bg);\\n  --color-glide-error-border: var(--color-dark-error-border);\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nimport ___CSS_LOADER_GET_URL_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/getUrl.js\";\nvar ___CSS_LOADER_URL_IMPORT_0___ = new URL(\"data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%2712%27 height=%2712%27 viewBox=%270 0 24 24%27 fill=%27none%27 stroke=%27%235E6470%27 stroke-width=%272.5%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27%3E%3Cpath d=%27m6 9 6 6 6-6%27/%3E%3C/svg%3E\", import.meta.url);\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\nvar ___CSS_LOADER_URL_REPLACEMENT_0___ = ___CSS_LOADER_GET_URL_IMPORT___(___CSS_LOADER_URL_IMPORT_0___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `/**\n * AI Compose  Component Styles\n *\n * Component-level CSS for interactive states, dynamic content,\n * and polished UI elements that benefit from semantic class names.\n * Design tokens come from \\`src/styles/main.css\\` via Tailwind @theme.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* ================================================================\n   Utility  hidden (Tailwind v4 may not scan .ts files for this)\n   ================================================================ */\n\n.hidden {\n  display: none !important;\n}\n\n/* ================================================================\n   Scrollbar  slim, theme-aware\n   ================================================================ */\n\n::-webkit-scrollbar {\n  width: 6px;\n}\n\n::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n::-webkit-scrollbar-thumb {\n  background: var(--color-glide-border);\n  border-radius: 3px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: var(--color-glide-text-tertiary);\n}\n\n/* ================================================================\n   Tab bar\n   ================================================================ */\n\n.glide-tab {\n  display: inline-flex;\n  align-items: center;\n  gap: var(--spacing-xs);\n  padding: var(--spacing-sm) var(--spacing-md);\n  font-family: var(--font-glide);\n  font-size: var(--text-sm);\n  font-weight: 500;\n  color: var(--color-glide-text-secondary);\n  background: transparent;\n  border: none;\n  border-bottom: 2px solid transparent;\n  cursor: pointer;\n  transition: color var(--duration-glide) var(--ease-glide),\n              border-color var(--duration-glide) var(--ease-glide);\n  white-space: nowrap;\n}\n\n.glide-tab:hover {\n  color: var(--color-glide-text);\n}\n\n.glide-tab--active {\n  color: var(--color-glide-blue);\n  border-bottom-color: var(--color-glide-blue);\n}\n\n.glide-tab--icon {\n  padding: var(--spacing-sm);\n  margin-left: auto;\n}\n\n.glide-tab--icon:first-of-type {\n  margin-left: auto;\n}\n\n/* ================================================================\n   Dropdown menu  proper menu component\n   ================================================================ */\n\n.glide-dropdown {\n  position: absolute;\n  right: 0;\n  top: calc(100% + 4px);\n  min-width: 200px;\n  background: var(--color-glide-bg-elevated);\n  border: 1px solid var(--color-glide-border);\n  border-radius: var(--radius-md);\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.10),\n              0 1px 4px rgba(0, 0, 0, 0.06);\n  padding: var(--spacing-xs) 0;\n  z-index: 20;\n  overflow: hidden;\n}\n\n.glide-dropdown__item {\n  display: flex;\n  align-items: center;\n  gap: var(--spacing-sm);\n  width: 100%;\n  padding: var(--spacing-sm) var(--spacing-md);\n  font-family: var(--font-glide);\n  font-size: var(--text-sm);\n  color: var(--color-glide-text);\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  transition: background var(--duration-glide) var(--ease-glide);\n  text-align: left;\n}\n\n.glide-dropdown__item:hover {\n  background: var(--color-glide-bg-panel);\n}\n\n.glide-dropdown__item:active {\n  background: var(--color-glide-blue-light);\n}\n\n.glide-dropdown__item svg {\n  color: var(--color-glide-text-tertiary);\n  flex-shrink: 0;\n}\n\n.glide-dropdown__item:hover svg {\n  color: var(--color-glide-blue);\n}\n\n.glide-dropdown__item--active {\n  background: var(--color-glide-blue-light);\n  color: var(--color-glide-blue);\n  font-weight: 500;\n}\n\n.glide-dropdown__item--active svg {\n  color: var(--color-glide-blue);\n}\n\n.glide-split--open .glide-tab--icon {\n  color: var(--color-glide-blue);\n  background: var(--color-glide-blue-light);\n  border-radius: var(--radius-xs);\n}\n\n/* ================================================================\n   Buttons\n   ================================================================ */\n\n.glide-btn {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  gap: var(--spacing-xs);\n  padding: 9px var(--spacing-lg);\n  border-radius: var(--radius-xs);\n  font-family: var(--font-glide);\n  font-size: var(--text-sm);\n  font-weight: 500;\n  cursor: pointer;\n  transition: all var(--duration-glide) var(--ease-glide);\n  white-space: nowrap;\n  border: 1px solid transparent;\n  line-height: 1;\n}\n\n.glide-btn:active {\n  transform: scale(0.97);\n}\n\n/* Primary  blue filled */\n.glide-btn--primary {\n  background: var(--color-glide-blue);\n  color: var(--color-glide-text-inverse);\n  border-color: var(--color-glide-blue);\n}\n\n.glide-btn--primary:hover {\n  background: var(--color-glide-blue-hover);\n  border-color: var(--color-glide-blue-hover);\n  box-shadow: 0 2px 8px rgba(59, 158, 255, 0.25);\n}\n\n/* Secondary  outlined */\n.glide-btn--secondary {\n  background: var(--color-glide-bg);\n  color: var(--color-glide-text-secondary);\n  border-color: var(--color-glide-border);\n}\n\n.glide-btn--secondary:hover {\n  border-color: var(--color-glide-text-secondary);\n  color: var(--color-glide-text);\n  background: var(--color-glide-bg-panel);\n}\n\n/* Accent  purple filled */\n.glide-btn--accent {\n  background: var(--color-glide-purple);\n  color: var(--color-glide-text-inverse);\n  border-color: var(--color-glide-purple);\n  padding: 9px var(--spacing-sm);\n}\n\n.glide-btn--accent:hover {\n  background: var(--color-glide-purple-hover);\n  border-color: var(--color-glide-purple-hover);\n}\n\n/* Success state (JS-toggled after copy actions) */\n.glide-btn--success {\n  background: var(--color-glide-success) !important;\n  border-color: var(--color-glide-success) !important;\n  color: var(--color-glide-text-inverse) !important;\n}\n\n/* Icon-only toggle (e.g. API key show/hide) */\n.glide-btn--icon-toggle {\n  padding: 8px 10px;\n}\n\n/* ================================================================\n   Form controls  shared styles for select, input, textarea\n   ================================================================ */\n\n.glide-select {\n  display: block;\n  width: 100%;\n  padding: var(--spacing-sm);\n  font-family: var(--font-glide);\n  font-size: var(--text-md);\n  color: var(--color-glide-text);\n  background: var(--color-glide-bg);\n  border: 1px solid var(--color-glide-border);\n  border-radius: var(--radius-sm);\n  outline: none;\n  cursor: pointer;\n  appearance: none;\n  background-image: url(${___CSS_LOADER_URL_REPLACEMENT_0___});\n  background-repeat: no-repeat;\n  background-position: right 8px center;\n  padding-right: 28px;\n  transition: border-color var(--duration-glide) var(--ease-glide),\n              box-shadow var(--duration-glide) var(--ease-glide);\n}\n\n.glide-select:hover {\n  border-color: var(--color-glide-text-secondary);\n}\n\n.glide-select:focus {\n  border-color: var(--color-glide-blue);\n  box-shadow: 0 0 0 2px var(--color-glide-blue-glow);\n}\n\n.glide-input {\n  flex: 1;\n  padding: var(--spacing-sm);\n  font-family: var(--font-glide);\n  font-size: var(--text-md);\n  color: var(--color-glide-text);\n  background: var(--color-glide-bg);\n  border: 1px solid var(--color-glide-border);\n  border-radius: var(--radius-sm);\n  outline: none;\n  transition: border-color var(--duration-glide) var(--ease-glide),\n              box-shadow var(--duration-glide) var(--ease-glide);\n}\n\n.glide-input::placeholder {\n  color: var(--color-glide-text-tertiary);\n}\n\n.glide-input:focus {\n  border-color: var(--color-glide-blue);\n  box-shadow: 0 0 0 2px var(--color-glide-blue-glow);\n}\n\n/* ================================================================\n   Radio group\n   ================================================================ */\n\n.glide-radio-group {\n  display: flex;\n  flex-wrap: wrap;\n  gap: var(--spacing-md);\n}\n\n.glide-radio-group--vertical {\n  flex-direction: column;\n  gap: var(--spacing-sm);\n}\n\n.glide-radio {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  font-size: var(--text-sm);\n  color: var(--color-glide-text);\n}\n\n.glide-radio input[type=\"radio\"] {\n  appearance: none;\n  -webkit-appearance: none;\n  width: 14px;\n  height: 14px;\n  border: 1.5px solid var(--color-glide-border);\n  border-radius: 50%;\n  margin: 0;\n  cursor: pointer;\n  position: relative;\n  flex-shrink: 0;\n  transition: border-color var(--duration-glide) var(--ease-glide);\n}\n\n.glide-radio input[type=\"radio\"]:hover {\n  border-color: var(--color-glide-blue);\n}\n\n.glide-radio input[type=\"radio\"]:checked {\n  border-color: var(--color-glide-blue);\n}\n\n.glide-radio input[type=\"radio\"]:checked::after {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  background: var(--color-glide-blue);\n}\n\n/* ================================================================\n   Checkbox\n   ================================================================ */\n\n.glide-checkbox {\n  display: inline-flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  font-size: var(--text-sm);\n  color: var(--color-glide-text);\n}\n\n.glide-checkbox input[type=\"checkbox\"] {\n  appearance: none;\n  -webkit-appearance: none;\n  width: 14px;\n  height: 14px;\n  border: 1.5px solid var(--color-glide-border);\n  border-radius: 3px;\n  margin: 0;\n  cursor: pointer;\n  position: relative;\n  flex-shrink: 0;\n  transition: all var(--duration-glide) var(--ease-glide);\n}\n\n.glide-checkbox input[type=\"checkbox\"]:hover {\n  border-color: var(--color-glide-blue);\n}\n\n.glide-checkbox input[type=\"checkbox\"]:checked {\n  background: var(--color-glide-blue);\n  border-color: var(--color-glide-blue);\n}\n\n.glide-checkbox input[type=\"checkbox\"]:checked::after {\n  content: '';\n  position: absolute;\n  top: 1px;\n  left: 4px;\n  width: 4px;\n  height: 8px;\n  border: solid white;\n  border-width: 0 2px 2px 0;\n  transform: rotate(45deg);\n}\n\n/* ================================================================\n   Context banner (reply-context)\n   ================================================================ */\n\n.glide-context-banner {\n  background: var(--color-glide-bg-panel);\n  border: 1px solid var(--color-glide-border-light);\n  border-radius: var(--radius-sm);\n  padding: var(--spacing-sm) var(--spacing-md);\n  margin-bottom: var(--spacing-lg);\n}\n\n/* ================================================================\n   Hint text\n   ================================================================ */\n\n.glide-hint {\n  font-size: var(--text-sm);\n  color: var(--color-glide-text-tertiary);\n  margin-bottom: var(--spacing-lg);\n  font-style: italic;\n}\n\n/* ================================================================\n   Preview  rendered HTML content area\n   ================================================================ */\n\n.glide-preview {\n  background: var(--color-glide-bg-panel);\n  border: 1px solid var(--color-glide-border-light);\n  border-radius: var(--radius-sm);\n  padding: var(--spacing-md);\n  font-size: var(--text-md);\n  line-height: 1.65;\n  margin-bottom: var(--spacing-lg);\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.glide-preview p {\n  margin-bottom: var(--spacing-sm);\n}\n\n.glide-preview p:last-child {\n  margin-bottom: 0;\n}\n\n.glide-preview ul,\n.glide-preview ol {\n  padding-left: 1.5em;\n  margin-bottom: var(--spacing-sm);\n}\n\n.glide-preview li {\n  margin-bottom: var(--spacing-xs);\n}\n\n/* ================================================================\n   Loading overlay\n   ================================================================ */\n\n.glide-loading {\n  position: fixed;\n  inset: 0;\n  display: none;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  background: rgba(255, 255, 255, 0.85);\n  z-index: 50;\n  backdrop-filter: blur(4px);\n}\n\n.glide-loading:not(.hidden) {\n  display: flex;\n}\n\n.glide-loading__spinner {\n  width: 32px;\n  height: 32px;\n  border: 3px solid var(--color-glide-border-light);\n  border-top-color: var(--color-glide-blue);\n  border-radius: 50%;\n  animation: spin 0.7s linear infinite;\n  margin-bottom: var(--spacing-md);\n}\n\n/* ================================================================\n   Error banner\n   ================================================================ */\n\n.glide-error {\n  position: fixed;\n  bottom: var(--spacing-md);\n  left: var(--spacing-md);\n  right: var(--spacing-md);\n  display: none;\n  align-items: center;\n  gap: var(--spacing-sm);\n  padding: var(--spacing-sm) var(--spacing-md);\n  background: var(--color-glide-error-bg);\n  border: 1px solid var(--color-glide-error-border);\n  border-radius: var(--radius-sm);\n  color: var(--color-glide-error-text);\n  font-size: var(--text-sm);\n  z-index: 50;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.glide-error:not(.hidden) {\n  display: flex;\n}\n\n.glide-error__dismiss {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  border-radius: var(--radius-xs);\n  background: transparent;\n  border: none;\n  color: var(--color-glide-error-text);\n  cursor: pointer;\n  opacity: 0.5;\n  transition: opacity var(--duration-glide) var(--ease-glide);\n}\n\n.glide-error__dismiss:hover {\n  opacity: 1;\n}\n\n/* ================================================================\n   Diff view  dynamically injected by JS\n   ================================================================ */\n\n.glide-diff {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-sm);\n}\n\n.glide-diff__panel {\n  border: 1px solid var(--color-glide-border-light);\n  border-radius: var(--radius-sm);\n  overflow: hidden;\n}\n\n.glide-diff__panel--improved {\n  border-color: rgba(26, 127, 55, 0.2);\n}\n\n.glide-diff__label {\n  font-size: var(--text-xs);\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.04em;\n  padding: 5px 10px;\n  background: var(--color-glide-bg-panel);\n  color: var(--color-glide-text-tertiary);\n  border-bottom: 1px solid var(--color-glide-border-light);\n}\n\n.glide-diff__panel--improved .glide-diff__label {\n  background: rgba(26, 127, 55, 0.05);\n  color: var(--color-glide-success);\n}\n\n.glide-diff__content {\n  padding: 10px 12px;\n  font-size: var(--text-sm);\n  line-height: 1.7;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.glide-diff__del {\n  background: #FFEEF0;\n  color: #B31D28;\n  text-decoration: line-through;\n  text-decoration-color: rgba(179, 29, 40, 0.4);\n  border-radius: 2px;\n  padding: 0 1px;\n}\n\n.glide-diff__ins {\n  background: #E6FFEC;\n  color: #22863A;\n  border-radius: 2px;\n  padding: 0 1px;\n}\n\n/* ================================================================\n   Checklist  dynamically injected action items\n   ================================================================ */\n\n.glide-task-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.glide-task-item {\n  display: flex;\n  gap: var(--spacing-sm);\n  padding: var(--spacing-sm) 10px;\n  background: var(--color-glide-bg-panel);\n  border: 1px solid var(--color-glide-border-light);\n  border-radius: var(--radius-sm);\n  transition: border-color var(--duration-glide) var(--ease-glide);\n}\n\n.glide-task-item:hover {\n  border-color: var(--color-glide-border);\n}\n\n.glide-task-item__check {\n  flex-shrink: 0;\n  display: flex;\n  align-items: flex-start;\n  padding-top: 1px;\n  cursor: pointer;\n}\n\n.glide-task-item__check input[type=\"checkbox\"] {\n  width: 16px;\n  height: 16px;\n  accent-color: var(--color-glide-blue);\n  cursor: pointer;\n}\n\n.glide-task-item__body {\n  flex: 1;\n  min-width: 0;\n}\n\n.glide-task-item__text {\n  font-size: var(--text-md);\n  line-height: 1.5;\n  color: var(--color-glide-text);\n}\n\n.glide-task-item__meta {\n  display: flex;\n  gap: var(--spacing-md);\n  flex-wrap: wrap;\n  margin-top: 2px;\n  font-size: var(--text-xs);\n  color: var(--color-glide-text-tertiary);\n}\n\n.glide-task-item__owner strong,\n.glide-task-item__deadline strong {\n  font-weight: 600;\n  color: var(--color-glide-text-secondary);\n}\n\n.glide-task-item:has(input[type=\"checkbox\"]:checked) .glide-task-item__text {\n  text-decoration: line-through;\n  color: var(--color-glide-text-tertiary);\n}\n\n/* ================================================================\n   Translation  dynamically injected side-by-side panels\n   ================================================================ */\n\n.glide-translate-view {\n  display: flex;\n  flex-direction: column;\n  gap: var(--spacing-sm);\n}\n\n.glide-translate-panel {\n  background: var(--color-glide-bg-panel);\n  border: 1px solid var(--color-glide-border-light);\n  border-radius: var(--radius-sm);\n  overflow: hidden;\n}\n\n.glide-translate-panel__label {\n  padding: 6px 10px;\n  font-size: var(--text-xs);\n  font-weight: 600;\n  color: var(--color-glide-text-secondary);\n  background: var(--color-glide-bg);\n  border-bottom: 1px solid var(--color-glide-border-light);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.glide-translate-panel__text {\n  padding: 10px;\n  font-size: var(--text-md);\n  line-height: 1.6;\n  color: var(--color-glide-text);\n  max-height: 240px;\n  overflow-y: auto;\n}\n\n.glide-translate-panel--target {\n  border-color: rgba(59, 158, 255, 0.2);\n}\n\n.glide-translate-panel--target .glide-translate-panel__label {\n  color: var(--color-glide-blue);\n  background: var(--color-glide-blue-light);\n}\n\n/* ================================================================\n   Spinner keyframes\n   ================================================================ */\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./src/taskpane/taskpane.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\"/**\\n * AI Compose  Component Styles\\n *\\n * Component-level CSS for interactive states, dynamic content,\\n * and polished UI elements that benefit from semantic class names.\\n * Design tokens come from `src/styles/main.css` via Tailwind @theme.\\n *\\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\\n */\\n\\n/* ================================================================\\n   Utility  hidden (Tailwind v4 may not scan .ts files for this)\\n   ================================================================ */\\n\\n.hidden {\\n  display: none !important;\\n}\\n\\n/* ================================================================\\n   Scrollbar  slim, theme-aware\\n   ================================================================ */\\n\\n::-webkit-scrollbar {\\n  width: 6px;\\n}\\n\\n::-webkit-scrollbar-track {\\n  background: transparent;\\n}\\n\\n::-webkit-scrollbar-thumb {\\n  background: var(--color-glide-border);\\n  border-radius: 3px;\\n}\\n\\n::-webkit-scrollbar-thumb:hover {\\n  background: var(--color-glide-text-tertiary);\\n}\\n\\n/* ================================================================\\n   Tab bar\\n   ================================================================ */\\n\\n.glide-tab {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: var(--spacing-xs);\\n  padding: var(--spacing-sm) var(--spacing-md);\\n  font-family: var(--font-glide);\\n  font-size: var(--text-sm);\\n  font-weight: 500;\\n  color: var(--color-glide-text-secondary);\\n  background: transparent;\\n  border: none;\\n  border-bottom: 2px solid transparent;\\n  cursor: pointer;\\n  transition: color var(--duration-glide) var(--ease-glide),\\n              border-color var(--duration-glide) var(--ease-glide);\\n  white-space: nowrap;\\n}\\n\\n.glide-tab:hover {\\n  color: var(--color-glide-text);\\n}\\n\\n.glide-tab--active {\\n  color: var(--color-glide-blue);\\n  border-bottom-color: var(--color-glide-blue);\\n}\\n\\n.glide-tab--icon {\\n  padding: var(--spacing-sm);\\n  margin-left: auto;\\n}\\n\\n.glide-tab--icon:first-of-type {\\n  margin-left: auto;\\n}\\n\\n/* ================================================================\\n   Dropdown menu  proper menu component\\n   ================================================================ */\\n\\n.glide-dropdown {\\n  position: absolute;\\n  right: 0;\\n  top: calc(100% + 4px);\\n  min-width: 200px;\\n  background: var(--color-glide-bg-elevated);\\n  border: 1px solid var(--color-glide-border);\\n  border-radius: var(--radius-md);\\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.10),\\n              0 1px 4px rgba(0, 0, 0, 0.06);\\n  padding: var(--spacing-xs) 0;\\n  z-index: 20;\\n  overflow: hidden;\\n}\\n\\n.glide-dropdown__item {\\n  display: flex;\\n  align-items: center;\\n  gap: var(--spacing-sm);\\n  width: 100%;\\n  padding: var(--spacing-sm) var(--spacing-md);\\n  font-family: var(--font-glide);\\n  font-size: var(--text-sm);\\n  color: var(--color-glide-text);\\n  background: transparent;\\n  border: none;\\n  cursor: pointer;\\n  transition: background var(--duration-glide) var(--ease-glide);\\n  text-align: left;\\n}\\n\\n.glide-dropdown__item:hover {\\n  background: var(--color-glide-bg-panel);\\n}\\n\\n.glide-dropdown__item:active {\\n  background: var(--color-glide-blue-light);\\n}\\n\\n.glide-dropdown__item svg {\\n  color: var(--color-glide-text-tertiary);\\n  flex-shrink: 0;\\n}\\n\\n.glide-dropdown__item:hover svg {\\n  color: var(--color-glide-blue);\\n}\\n\\n.glide-dropdown__item--active {\\n  background: var(--color-glide-blue-light);\\n  color: var(--color-glide-blue);\\n  font-weight: 500;\\n}\\n\\n.glide-dropdown__item--active svg {\\n  color: var(--color-glide-blue);\\n}\\n\\n.glide-split--open .glide-tab--icon {\\n  color: var(--color-glide-blue);\\n  background: var(--color-glide-blue-light);\\n  border-radius: var(--radius-xs);\\n}\\n\\n/* ================================================================\\n   Buttons\\n   ================================================================ */\\n\\n.glide-btn {\\n  display: inline-flex;\\n  align-items: center;\\n  justify-content: center;\\n  gap: var(--spacing-xs);\\n  padding: 9px var(--spacing-lg);\\n  border-radius: var(--radius-xs);\\n  font-family: var(--font-glide);\\n  font-size: var(--text-sm);\\n  font-weight: 500;\\n  cursor: pointer;\\n  transition: all var(--duration-glide) var(--ease-glide);\\n  white-space: nowrap;\\n  border: 1px solid transparent;\\n  line-height: 1;\\n}\\n\\n.glide-btn:active {\\n  transform: scale(0.97);\\n}\\n\\n/* Primary  blue filled */\\n.glide-btn--primary {\\n  background: var(--color-glide-blue);\\n  color: var(--color-glide-text-inverse);\\n  border-color: var(--color-glide-blue);\\n}\\n\\n.glide-btn--primary:hover {\\n  background: var(--color-glide-blue-hover);\\n  border-color: var(--color-glide-blue-hover);\\n  box-shadow: 0 2px 8px rgba(59, 158, 255, 0.25);\\n}\\n\\n/* Secondary  outlined */\\n.glide-btn--secondary {\\n  background: var(--color-glide-bg);\\n  color: var(--color-glide-text-secondary);\\n  border-color: var(--color-glide-border);\\n}\\n\\n.glide-btn--secondary:hover {\\n  border-color: var(--color-glide-text-secondary);\\n  color: var(--color-glide-text);\\n  background: var(--color-glide-bg-panel);\\n}\\n\\n/* Accent  purple filled */\\n.glide-btn--accent {\\n  background: var(--color-glide-purple);\\n  color: var(--color-glide-text-inverse);\\n  border-color: var(--color-glide-purple);\\n  padding: 9px var(--spacing-sm);\\n}\\n\\n.glide-btn--accent:hover {\\n  background: var(--color-glide-purple-hover);\\n  border-color: var(--color-glide-purple-hover);\\n}\\n\\n/* Success state (JS-toggled after copy actions) */\\n.glide-btn--success {\\n  background: var(--color-glide-success) !important;\\n  border-color: var(--color-glide-success) !important;\\n  color: var(--color-glide-text-inverse) !important;\\n}\\n\\n/* Icon-only toggle (e.g. API key show/hide) */\\n.glide-btn--icon-toggle {\\n  padding: 8px 10px;\\n}\\n\\n/* ================================================================\\n   Form controls  shared styles for select, input, textarea\\n   ================================================================ */\\n\\n.glide-select {\\n  display: block;\\n  width: 100%;\\n  padding: var(--spacing-sm);\\n  font-family: var(--font-glide);\\n  font-size: var(--text-md);\\n  color: var(--color-glide-text);\\n  background: var(--color-glide-bg);\\n  border: 1px solid var(--color-glide-border);\\n  border-radius: var(--radius-sm);\\n  outline: none;\\n  cursor: pointer;\\n  appearance: none;\\n  background-image: url(\\\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%235E6470' stroke-width='2.5' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E\\\");\\n  background-repeat: no-repeat;\\n  background-position: right 8px center;\\n  padding-right: 28px;\\n  transition: border-color var(--duration-glide) var(--ease-glide),\\n              box-shadow var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-select:hover {\\n  border-color: var(--color-glide-text-secondary);\\n}\\n\\n.glide-select:focus {\\n  border-color: var(--color-glide-blue);\\n  box-shadow: 0 0 0 2px var(--color-glide-blue-glow);\\n}\\n\\n.glide-input {\\n  flex: 1;\\n  padding: var(--spacing-sm);\\n  font-family: var(--font-glide);\\n  font-size: var(--text-md);\\n  color: var(--color-glide-text);\\n  background: var(--color-glide-bg);\\n  border: 1px solid var(--color-glide-border);\\n  border-radius: var(--radius-sm);\\n  outline: none;\\n  transition: border-color var(--duration-glide) var(--ease-glide),\\n              box-shadow var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-input::placeholder {\\n  color: var(--color-glide-text-tertiary);\\n}\\n\\n.glide-input:focus {\\n  border-color: var(--color-glide-blue);\\n  box-shadow: 0 0 0 2px var(--color-glide-blue-glow);\\n}\\n\\n/* ================================================================\\n   Radio group\\n   ================================================================ */\\n\\n.glide-radio-group {\\n  display: flex;\\n  flex-wrap: wrap;\\n  gap: var(--spacing-md);\\n}\\n\\n.glide-radio-group--vertical {\\n  flex-direction: column;\\n  gap: var(--spacing-sm);\\n}\\n\\n.glide-radio {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: 6px;\\n  cursor: pointer;\\n  font-size: var(--text-sm);\\n  color: var(--color-glide-text);\\n}\\n\\n.glide-radio input[type=\\\"radio\\\"] {\\n  appearance: none;\\n  -webkit-appearance: none;\\n  width: 14px;\\n  height: 14px;\\n  border: 1.5px solid var(--color-glide-border);\\n  border-radius: 50%;\\n  margin: 0;\\n  cursor: pointer;\\n  position: relative;\\n  flex-shrink: 0;\\n  transition: border-color var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-radio input[type=\\\"radio\\\"]:hover {\\n  border-color: var(--color-glide-blue);\\n}\\n\\n.glide-radio input[type=\\\"radio\\\"]:checked {\\n  border-color: var(--color-glide-blue);\\n}\\n\\n.glide-radio input[type=\\\"radio\\\"]:checked::after {\\n  content: '';\\n  position: absolute;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  width: 6px;\\n  height: 6px;\\n  border-radius: 50%;\\n  background: var(--color-glide-blue);\\n}\\n\\n/* ================================================================\\n   Checkbox\\n   ================================================================ */\\n\\n.glide-checkbox {\\n  display: inline-flex;\\n  align-items: center;\\n  gap: 6px;\\n  cursor: pointer;\\n  font-size: var(--text-sm);\\n  color: var(--color-glide-text);\\n}\\n\\n.glide-checkbox input[type=\\\"checkbox\\\"] {\\n  appearance: none;\\n  -webkit-appearance: none;\\n  width: 14px;\\n  height: 14px;\\n  border: 1.5px solid var(--color-glide-border);\\n  border-radius: 3px;\\n  margin: 0;\\n  cursor: pointer;\\n  position: relative;\\n  flex-shrink: 0;\\n  transition: all var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-checkbox input[type=\\\"checkbox\\\"]:hover {\\n  border-color: var(--color-glide-blue);\\n}\\n\\n.glide-checkbox input[type=\\\"checkbox\\\"]:checked {\\n  background: var(--color-glide-blue);\\n  border-color: var(--color-glide-blue);\\n}\\n\\n.glide-checkbox input[type=\\\"checkbox\\\"]:checked::after {\\n  content: '';\\n  position: absolute;\\n  top: 1px;\\n  left: 4px;\\n  width: 4px;\\n  height: 8px;\\n  border: solid white;\\n  border-width: 0 2px 2px 0;\\n  transform: rotate(45deg);\\n}\\n\\n/* ================================================================\\n   Context banner (reply-context)\\n   ================================================================ */\\n\\n.glide-context-banner {\\n  background: var(--color-glide-bg-panel);\\n  border: 1px solid var(--color-glide-border-light);\\n  border-radius: var(--radius-sm);\\n  padding: var(--spacing-sm) var(--spacing-md);\\n  margin-bottom: var(--spacing-lg);\\n}\\n\\n/* ================================================================\\n   Hint text\\n   ================================================================ */\\n\\n.glide-hint {\\n  font-size: var(--text-sm);\\n  color: var(--color-glide-text-tertiary);\\n  margin-bottom: var(--spacing-lg);\\n  font-style: italic;\\n}\\n\\n/* ================================================================\\n   Preview  rendered HTML content area\\n   ================================================================ */\\n\\n.glide-preview {\\n  background: var(--color-glide-bg-panel);\\n  border: 1px solid var(--color-glide-border-light);\\n  border-radius: var(--radius-sm);\\n  padding: var(--spacing-md);\\n  font-size: var(--text-md);\\n  line-height: 1.65;\\n  margin-bottom: var(--spacing-lg);\\n  max-height: 300px;\\n  overflow-y: auto;\\n}\\n\\n.glide-preview p {\\n  margin-bottom: var(--spacing-sm);\\n}\\n\\n.glide-preview p:last-child {\\n  margin-bottom: 0;\\n}\\n\\n.glide-preview ul,\\n.glide-preview ol {\\n  padding-left: 1.5em;\\n  margin-bottom: var(--spacing-sm);\\n}\\n\\n.glide-preview li {\\n  margin-bottom: var(--spacing-xs);\\n}\\n\\n/* ================================================================\\n   Loading overlay\\n   ================================================================ */\\n\\n.glide-loading {\\n  position: fixed;\\n  inset: 0;\\n  display: none;\\n  flex-direction: column;\\n  align-items: center;\\n  justify-content: center;\\n  background: rgba(255, 255, 255, 0.85);\\n  z-index: 50;\\n  backdrop-filter: blur(4px);\\n}\\n\\n.glide-loading:not(.hidden) {\\n  display: flex;\\n}\\n\\n.glide-loading__spinner {\\n  width: 32px;\\n  height: 32px;\\n  border: 3px solid var(--color-glide-border-light);\\n  border-top-color: var(--color-glide-blue);\\n  border-radius: 50%;\\n  animation: spin 0.7s linear infinite;\\n  margin-bottom: var(--spacing-md);\\n}\\n\\n/* ================================================================\\n   Error banner\\n   ================================================================ */\\n\\n.glide-error {\\n  position: fixed;\\n  bottom: var(--spacing-md);\\n  left: var(--spacing-md);\\n  right: var(--spacing-md);\\n  display: none;\\n  align-items: center;\\n  gap: var(--spacing-sm);\\n  padding: var(--spacing-sm) var(--spacing-md);\\n  background: var(--color-glide-error-bg);\\n  border: 1px solid var(--color-glide-error-border);\\n  border-radius: var(--radius-sm);\\n  color: var(--color-glide-error-text);\\n  font-size: var(--text-sm);\\n  z-index: 50;\\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\\n}\\n\\n.glide-error:not(.hidden) {\\n  display: flex;\\n}\\n\\n.glide-error__dismiss {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  width: 24px;\\n  height: 24px;\\n  border-radius: var(--radius-xs);\\n  background: transparent;\\n  border: none;\\n  color: var(--color-glide-error-text);\\n  cursor: pointer;\\n  opacity: 0.5;\\n  transition: opacity var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-error__dismiss:hover {\\n  opacity: 1;\\n}\\n\\n/* ================================================================\\n   Diff view  dynamically injected by JS\\n   ================================================================ */\\n\\n.glide-diff {\\n  display: flex;\\n  flex-direction: column;\\n  gap: var(--spacing-sm);\\n}\\n\\n.glide-diff__panel {\\n  border: 1px solid var(--color-glide-border-light);\\n  border-radius: var(--radius-sm);\\n  overflow: hidden;\\n}\\n\\n.glide-diff__panel--improved {\\n  border-color: rgba(26, 127, 55, 0.2);\\n}\\n\\n.glide-diff__label {\\n  font-size: var(--text-xs);\\n  font-weight: 600;\\n  text-transform: uppercase;\\n  letter-spacing: 0.04em;\\n  padding: 5px 10px;\\n  background: var(--color-glide-bg-panel);\\n  color: var(--color-glide-text-tertiary);\\n  border-bottom: 1px solid var(--color-glide-border-light);\\n}\\n\\n.glide-diff__panel--improved .glide-diff__label {\\n  background: rgba(26, 127, 55, 0.05);\\n  color: var(--color-glide-success);\\n}\\n\\n.glide-diff__content {\\n  padding: 10px 12px;\\n  font-size: var(--text-sm);\\n  line-height: 1.7;\\n  white-space: pre-wrap;\\n  word-wrap: break-word;\\n  max-height: 200px;\\n  overflow-y: auto;\\n}\\n\\n.glide-diff__del {\\n  background: #FFEEF0;\\n  color: #B31D28;\\n  text-decoration: line-through;\\n  text-decoration-color: rgba(179, 29, 40, 0.4);\\n  border-radius: 2px;\\n  padding: 0 1px;\\n}\\n\\n.glide-diff__ins {\\n  background: #E6FFEC;\\n  color: #22863A;\\n  border-radius: 2px;\\n  padding: 0 1px;\\n}\\n\\n/* ================================================================\\n   Checklist  dynamically injected action items\\n   ================================================================ */\\n\\n.glide-task-list {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 6px;\\n}\\n\\n.glide-task-item {\\n  display: flex;\\n  gap: var(--spacing-sm);\\n  padding: var(--spacing-sm) 10px;\\n  background: var(--color-glide-bg-panel);\\n  border: 1px solid var(--color-glide-border-light);\\n  border-radius: var(--radius-sm);\\n  transition: border-color var(--duration-glide) var(--ease-glide);\\n}\\n\\n.glide-task-item:hover {\\n  border-color: var(--color-glide-border);\\n}\\n\\n.glide-task-item__check {\\n  flex-shrink: 0;\\n  display: flex;\\n  align-items: flex-start;\\n  padding-top: 1px;\\n  cursor: pointer;\\n}\\n\\n.glide-task-item__check input[type=\\\"checkbox\\\"] {\\n  width: 16px;\\n  height: 16px;\\n  accent-color: var(--color-glide-blue);\\n  cursor: pointer;\\n}\\n\\n.glide-task-item__body {\\n  flex: 1;\\n  min-width: 0;\\n}\\n\\n.glide-task-item__text {\\n  font-size: var(--text-md);\\n  line-height: 1.5;\\n  color: var(--color-glide-text);\\n}\\n\\n.glide-task-item__meta {\\n  display: flex;\\n  gap: var(--spacing-md);\\n  flex-wrap: wrap;\\n  margin-top: 2px;\\n  font-size: var(--text-xs);\\n  color: var(--color-glide-text-tertiary);\\n}\\n\\n.glide-task-item__owner strong,\\n.glide-task-item__deadline strong {\\n  font-weight: 600;\\n  color: var(--color-glide-text-secondary);\\n}\\n\\n.glide-task-item:has(input[type=\\\"checkbox\\\"]:checked) .glide-task-item__text {\\n  text-decoration: line-through;\\n  color: var(--color-glide-text-tertiary);\\n}\\n\\n/* ================================================================\\n   Translation  dynamically injected side-by-side panels\\n   ================================================================ */\\n\\n.glide-translate-view {\\n  display: flex;\\n  flex-direction: column;\\n  gap: var(--spacing-sm);\\n}\\n\\n.glide-translate-panel {\\n  background: var(--color-glide-bg-panel);\\n  border: 1px solid var(--color-glide-border-light);\\n  border-radius: var(--radius-sm);\\n  overflow: hidden;\\n}\\n\\n.glide-translate-panel__label {\\n  padding: 6px 10px;\\n  font-size: var(--text-xs);\\n  font-weight: 600;\\n  color: var(--color-glide-text-secondary);\\n  background: var(--color-glide-bg);\\n  border-bottom: 1px solid var(--color-glide-border-light);\\n  text-transform: uppercase;\\n  letter-spacing: 0.5px;\\n}\\n\\n.glide-translate-panel__text {\\n  padding: 10px;\\n  font-size: var(--text-md);\\n  line-height: 1.6;\\n  color: var(--color-glide-text);\\n  max-height: 240px;\\n  overflow-y: auto;\\n}\\n\\n.glide-translate-panel--target {\\n  border-color: rgba(59, 158, 255, 0.2);\\n}\\n\\n.glide-translate-panel--target .glide-translate-panel__label {\\n  color: var(--color-glide-blue);\\n  background: var(--color-glide-blue-light);\\n}\\n\\n/* ================================================================\\n   Spinner keyframes\\n   ================================================================ */\\n\\n@keyframes spin {\\n  to {\\n    transform: rotate(360deg);\\n  }\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = [];\n\n  // return the list of modules as css string\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n      content += cssWithMappingToString(item);\n      if (needLayer) {\n        content += \"}\";\n      }\n      if (item[2]) {\n        content += \"}\";\n      }\n      if (item[4]) {\n        content += \"}\";\n      }\n      return content;\n    }).join(\"\");\n  };\n\n  // import a list of modules into the list\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n    var alreadyImportedModules = {};\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n      list.push(item);\n    }\n  };\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (url, options) {\n  if (!options) {\n    options = {};\n  }\n  if (!url) {\n    return url;\n  }\n  url = String(url.__esModule ? url.default : url);\n\n  // If url is already wrapped in quotes, remove them\n  if (/^['\"].*['\"]$/.test(url)) {\n    url = url.slice(1, -1);\n  }\n  if (options.hash) {\n    url += options.hash;\n  }\n\n  // Should url be wrapped?\n  // See https://drafts.csswg.org/css-values-3/#urls\n  if (/[\"'() \\t\\n]|(%20)/.test(url) || options.needQuotes) {\n    return \"\\\"\".concat(url.replace(/\"/g, '\\\\\"').replace(/\\n/g, \"\\\\n\"), \"\\\"\");\n  }\n  return url;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n  if (!cssMapping) {\n    return content;\n  }\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    return [content].concat([sourceMapping]).join(\"\\n\");\n  }\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDOM = [];\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n  return result;\n}\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n    identifiers.push(identifier);\n  }\n  return identifiers;\n}\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n  return updater;\n}\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n    var newLastIdentifiers = modulesToDom(newList, options);\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n      var _index = getIndexByIdentifier(_identifier);\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n\n/* istanbul ignore next  */\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target);\n\n    // Special case to return head of iframe instead of iframe itself\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n    memo[target] = styleTarget;\n  }\n  return memo[target];\n}\n\n/* istanbul ignore next  */\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n  target.appendChild(style);\n}\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n  var needLayer = typeof obj.layer !== \"undefined\";\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n  css += obj.css;\n  if (needLayer) {\n    css += \"}\";\n  }\n  if (obj.media) {\n    css += \"}\";\n  }\n  if (obj.supports) {\n    css += \"}\";\n  }\n  var sourceMap = obj.sourceMap;\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  }\n\n  // For old IE\n  /* istanbul ignore if  */\n  options.styleTagTransform(css, styleElement, options.options);\n}\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n  styleElement.parentNode.removeChild(styleElement);\n}\n\n/* istanbul ignore next  */\nfunction domAPI(options) {\n  if (typeof document === \"undefined\") {\n    return {\n      update: function update() {},\n      remove: function remove() {}\n    };\n  }\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","__webpack_require__.nc = undefined;","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./main.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./main.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\n * Contains the list of OpenAPI data types\n * as defined by https://swagger.io/docs/specification/data-models/data-types/\n * @public\n */\nvar SchemaType;\n(function (SchemaType) {\n    /** String type. */\n    SchemaType[\"STRING\"] = \"string\";\n    /** Number type. */\n    SchemaType[\"NUMBER\"] = \"number\";\n    /** Integer type. */\n    SchemaType[\"INTEGER\"] = \"integer\";\n    /** Boolean type. */\n    SchemaType[\"BOOLEAN\"] = \"boolean\";\n    /** Array type. */\n    SchemaType[\"ARRAY\"] = \"array\";\n    /** Object type. */\n    SchemaType[\"OBJECT\"] = \"object\";\n})(SchemaType || (SchemaType = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * @public\n */\nvar ExecutableCodeLanguage;\n(function (ExecutableCodeLanguage) {\n    ExecutableCodeLanguage[\"LANGUAGE_UNSPECIFIED\"] = \"language_unspecified\";\n    ExecutableCodeLanguage[\"PYTHON\"] = \"python\";\n})(ExecutableCodeLanguage || (ExecutableCodeLanguage = {}));\n/**\n * Possible outcomes of code execution.\n * @public\n */\nvar Outcome;\n(function (Outcome) {\n    /**\n     * Unspecified status. This value should not be used.\n     */\n    Outcome[\"OUTCOME_UNSPECIFIED\"] = \"outcome_unspecified\";\n    /**\n     * Code execution completed successfully.\n     */\n    Outcome[\"OUTCOME_OK\"] = \"outcome_ok\";\n    /**\n     * Code execution finished but with a failure. `stderr` should contain the\n     * reason.\n     */\n    Outcome[\"OUTCOME_FAILED\"] = \"outcome_failed\";\n    /**\n     * Code execution ran for too long, and was cancelled. There may or may not\n     * be a partial output present.\n     */\n    Outcome[\"OUTCOME_DEADLINE_EXCEEDED\"] = \"outcome_deadline_exceeded\";\n})(Outcome || (Outcome = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Possible roles.\n * @public\n */\nconst POSSIBLE_ROLES = [\"user\", \"model\", \"function\", \"system\"];\n/**\n * Harm categories that would cause prompts or candidates to be blocked.\n * @public\n */\nvar HarmCategory;\n(function (HarmCategory) {\n    HarmCategory[\"HARM_CATEGORY_UNSPECIFIED\"] = \"HARM_CATEGORY_UNSPECIFIED\";\n    HarmCategory[\"HARM_CATEGORY_HATE_SPEECH\"] = \"HARM_CATEGORY_HATE_SPEECH\";\n    HarmCategory[\"HARM_CATEGORY_SEXUALLY_EXPLICIT\"] = \"HARM_CATEGORY_SEXUALLY_EXPLICIT\";\n    HarmCategory[\"HARM_CATEGORY_HARASSMENT\"] = \"HARM_CATEGORY_HARASSMENT\";\n    HarmCategory[\"HARM_CATEGORY_DANGEROUS_CONTENT\"] = \"HARM_CATEGORY_DANGEROUS_CONTENT\";\n    HarmCategory[\"HARM_CATEGORY_CIVIC_INTEGRITY\"] = \"HARM_CATEGORY_CIVIC_INTEGRITY\";\n})(HarmCategory || (HarmCategory = {}));\n/**\n * Threshold above which a prompt or candidate will be blocked.\n * @public\n */\nvar HarmBlockThreshold;\n(function (HarmBlockThreshold) {\n    /** Threshold is unspecified. */\n    HarmBlockThreshold[\"HARM_BLOCK_THRESHOLD_UNSPECIFIED\"] = \"HARM_BLOCK_THRESHOLD_UNSPECIFIED\";\n    /** Content with NEGLIGIBLE will be allowed. */\n    HarmBlockThreshold[\"BLOCK_LOW_AND_ABOVE\"] = \"BLOCK_LOW_AND_ABOVE\";\n    /** Content with NEGLIGIBLE and LOW will be allowed. */\n    HarmBlockThreshold[\"BLOCK_MEDIUM_AND_ABOVE\"] = \"BLOCK_MEDIUM_AND_ABOVE\";\n    /** Content with NEGLIGIBLE, LOW, and MEDIUM will be allowed. */\n    HarmBlockThreshold[\"BLOCK_ONLY_HIGH\"] = \"BLOCK_ONLY_HIGH\";\n    /** All content will be allowed. */\n    HarmBlockThreshold[\"BLOCK_NONE\"] = \"BLOCK_NONE\";\n})(HarmBlockThreshold || (HarmBlockThreshold = {}));\n/**\n * Probability that a prompt or candidate matches a harm category.\n * @public\n */\nvar HarmProbability;\n(function (HarmProbability) {\n    /** Probability is unspecified. */\n    HarmProbability[\"HARM_PROBABILITY_UNSPECIFIED\"] = \"HARM_PROBABILITY_UNSPECIFIED\";\n    /** Content has a negligible chance of being unsafe. */\n    HarmProbability[\"NEGLIGIBLE\"] = \"NEGLIGIBLE\";\n    /** Content has a low chance of being unsafe. */\n    HarmProbability[\"LOW\"] = \"LOW\";\n    /** Content has a medium chance of being unsafe. */\n    HarmProbability[\"MEDIUM\"] = \"MEDIUM\";\n    /** Content has a high chance of being unsafe. */\n    HarmProbability[\"HIGH\"] = \"HIGH\";\n})(HarmProbability || (HarmProbability = {}));\n/**\n * Reason that a prompt was blocked.\n * @public\n */\nvar BlockReason;\n(function (BlockReason) {\n    // A blocked reason was not specified.\n    BlockReason[\"BLOCKED_REASON_UNSPECIFIED\"] = \"BLOCKED_REASON_UNSPECIFIED\";\n    // Content was blocked by safety settings.\n    BlockReason[\"SAFETY\"] = \"SAFETY\";\n    // Content was blocked, but the reason is uncategorized.\n    BlockReason[\"OTHER\"] = \"OTHER\";\n})(BlockReason || (BlockReason = {}));\n/**\n * Reason that a candidate finished.\n * @public\n */\nvar FinishReason;\n(function (FinishReason) {\n    // Default value. This value is unused.\n    FinishReason[\"FINISH_REASON_UNSPECIFIED\"] = \"FINISH_REASON_UNSPECIFIED\";\n    // Natural stop point of the model or provided stop sequence.\n    FinishReason[\"STOP\"] = \"STOP\";\n    // The maximum number of tokens as specified in the request was reached.\n    FinishReason[\"MAX_TOKENS\"] = \"MAX_TOKENS\";\n    // The candidate content was flagged for safety reasons.\n    FinishReason[\"SAFETY\"] = \"SAFETY\";\n    // The candidate content was flagged for recitation reasons.\n    FinishReason[\"RECITATION\"] = \"RECITATION\";\n    // The candidate content was flagged for using an unsupported language.\n    FinishReason[\"LANGUAGE\"] = \"LANGUAGE\";\n    // Token generation stopped because the content contains forbidden terms.\n    FinishReason[\"BLOCKLIST\"] = \"BLOCKLIST\";\n    // Token generation stopped for potentially containing prohibited content.\n    FinishReason[\"PROHIBITED_CONTENT\"] = \"PROHIBITED_CONTENT\";\n    // Token generation stopped because the content potentially contains Sensitive Personally Identifiable Information (SPII).\n    FinishReason[\"SPII\"] = \"SPII\";\n    // The function call generated by the model is invalid.\n    FinishReason[\"MALFORMED_FUNCTION_CALL\"] = \"MALFORMED_FUNCTION_CALL\";\n    // Unknown reason.\n    FinishReason[\"OTHER\"] = \"OTHER\";\n})(FinishReason || (FinishReason = {}));\n/**\n * Task type for embedding content.\n * @public\n */\nvar TaskType;\n(function (TaskType) {\n    TaskType[\"TASK_TYPE_UNSPECIFIED\"] = \"TASK_TYPE_UNSPECIFIED\";\n    TaskType[\"RETRIEVAL_QUERY\"] = \"RETRIEVAL_QUERY\";\n    TaskType[\"RETRIEVAL_DOCUMENT\"] = \"RETRIEVAL_DOCUMENT\";\n    TaskType[\"SEMANTIC_SIMILARITY\"] = \"SEMANTIC_SIMILARITY\";\n    TaskType[\"CLASSIFICATION\"] = \"CLASSIFICATION\";\n    TaskType[\"CLUSTERING\"] = \"CLUSTERING\";\n})(TaskType || (TaskType = {}));\n/**\n * @public\n */\nvar FunctionCallingMode;\n(function (FunctionCallingMode) {\n    // Unspecified function calling mode. This value should not be used.\n    FunctionCallingMode[\"MODE_UNSPECIFIED\"] = \"MODE_UNSPECIFIED\";\n    // Default model behavior, model decides to predict either a function call\n    // or a natural language repspose.\n    FunctionCallingMode[\"AUTO\"] = \"AUTO\";\n    // Model is constrained to always predicting a function call only.\n    // If \"allowed_function_names\" are set, the predicted function call will be\n    // limited to any one of \"allowed_function_names\", else the predicted\n    // function call will be any one of the provided \"function_declarations\".\n    FunctionCallingMode[\"ANY\"] = \"ANY\";\n    // Model will not predict any function call. Model behavior is same as when\n    // not passing any function declarations.\n    FunctionCallingMode[\"NONE\"] = \"NONE\";\n})(FunctionCallingMode || (FunctionCallingMode = {}));\n/**\n * The mode of the predictor to be used in dynamic retrieval.\n * @public\n */\nvar DynamicRetrievalMode;\n(function (DynamicRetrievalMode) {\n    // Unspecified function calling mode. This value should not be used.\n    DynamicRetrievalMode[\"MODE_UNSPECIFIED\"] = \"MODE_UNSPECIFIED\";\n    // Run retrieval only when system decides it is necessary.\n    DynamicRetrievalMode[\"MODE_DYNAMIC\"] = \"MODE_DYNAMIC\";\n})(DynamicRetrievalMode || (DynamicRetrievalMode = {}));\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Basic error type for this SDK.\n * @public\n */\nclass GoogleGenerativeAIError extends Error {\n    constructor(message) {\n        super(`[GoogleGenerativeAI Error]: ${message}`);\n    }\n}\n/**\n * Errors in the contents of a response from the model. This includes parsing\n * errors, or responses including a safety block reason.\n * @public\n */\nclass GoogleGenerativeAIResponseError extends GoogleGenerativeAIError {\n    constructor(message, response) {\n        super(message);\n        this.response = response;\n    }\n}\n/**\n * Error class covering HTTP errors when calling the server. Includes HTTP\n * status, statusText, and optional details, if provided in the server response.\n * @public\n */\nclass GoogleGenerativeAIFetchError extends GoogleGenerativeAIError {\n    constructor(message, status, statusText, errorDetails) {\n        super(message);\n        this.status = status;\n        this.statusText = statusText;\n        this.errorDetails = errorDetails;\n    }\n}\n/**\n * Errors in the contents of a request originating from user input.\n * @public\n */\nclass GoogleGenerativeAIRequestInputError extends GoogleGenerativeAIError {\n}\n/**\n * Error thrown when a request is aborted, either due to a timeout or\n * intentional cancellation by the user.\n * @public\n */\nclass GoogleGenerativeAIAbortError extends GoogleGenerativeAIError {\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst DEFAULT_BASE_URL = \"https://generativelanguage.googleapis.com\";\nconst DEFAULT_API_VERSION = \"v1beta\";\n/**\n * We can't `require` package.json if this runs on web. We will use rollup to\n * swap in the version number here at build time.\n */\nconst PACKAGE_VERSION = \"0.24.1\";\nconst PACKAGE_LOG_HEADER = \"genai-js\";\nvar Task;\n(function (Task) {\n    Task[\"GENERATE_CONTENT\"] = \"generateContent\";\n    Task[\"STREAM_GENERATE_CONTENT\"] = \"streamGenerateContent\";\n    Task[\"COUNT_TOKENS\"] = \"countTokens\";\n    Task[\"EMBED_CONTENT\"] = \"embedContent\";\n    Task[\"BATCH_EMBED_CONTENTS\"] = \"batchEmbedContents\";\n})(Task || (Task = {}));\nclass RequestUrl {\n    constructor(model, task, apiKey, stream, requestOptions) {\n        this.model = model;\n        this.task = task;\n        this.apiKey = apiKey;\n        this.stream = stream;\n        this.requestOptions = requestOptions;\n    }\n    toString() {\n        var _a, _b;\n        const apiVersion = ((_a = this.requestOptions) === null || _a === void 0 ? void 0 : _a.apiVersion) || DEFAULT_API_VERSION;\n        const baseUrl = ((_b = this.requestOptions) === null || _b === void 0 ? void 0 : _b.baseUrl) || DEFAULT_BASE_URL;\n        let url = `${baseUrl}/${apiVersion}/${this.model}:${this.task}`;\n        if (this.stream) {\n            url += \"?alt=sse\";\n        }\n        return url;\n    }\n}\n/**\n * Simple, but may become more complex if we add more versions to log.\n */\nfunction getClientHeaders(requestOptions) {\n    const clientHeaders = [];\n    if (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.apiClient) {\n        clientHeaders.push(requestOptions.apiClient);\n    }\n    clientHeaders.push(`${PACKAGE_LOG_HEADER}/${PACKAGE_VERSION}`);\n    return clientHeaders.join(\" \");\n}\nasync function getHeaders(url) {\n    var _a;\n    const headers = new Headers();\n    headers.append(\"Content-Type\", \"application/json\");\n    headers.append(\"x-goog-api-client\", getClientHeaders(url.requestOptions));\n    headers.append(\"x-goog-api-key\", url.apiKey);\n    let customHeaders = (_a = url.requestOptions) === null || _a === void 0 ? void 0 : _a.customHeaders;\n    if (customHeaders) {\n        if (!(customHeaders instanceof Headers)) {\n            try {\n                customHeaders = new Headers(customHeaders);\n            }\n            catch (e) {\n                throw new GoogleGenerativeAIRequestInputError(`unable to convert customHeaders value ${JSON.stringify(customHeaders)} to Headers: ${e.message}`);\n            }\n        }\n        for (const [headerName, headerValue] of customHeaders.entries()) {\n            if (headerName === \"x-goog-api-key\") {\n                throw new GoogleGenerativeAIRequestInputError(`Cannot set reserved header name ${headerName}`);\n            }\n            else if (headerName === \"x-goog-api-client\") {\n                throw new GoogleGenerativeAIRequestInputError(`Header name ${headerName} can only be set using the apiClient field`);\n            }\n            headers.append(headerName, headerValue);\n        }\n    }\n    return headers;\n}\nasync function constructModelRequest(model, task, apiKey, stream, body, requestOptions) {\n    const url = new RequestUrl(model, task, apiKey, stream, requestOptions);\n    return {\n        url: url.toString(),\n        fetchOptions: Object.assign(Object.assign({}, buildFetchOptions(requestOptions)), { method: \"POST\", headers: await getHeaders(url), body }),\n    };\n}\nasync function makeModelRequest(model, task, apiKey, stream, body, requestOptions = {}, \n// Allows this to be stubbed for tests\nfetchFn = fetch) {\n    const { url, fetchOptions } = await constructModelRequest(model, task, apiKey, stream, body, requestOptions);\n    return makeRequest(url, fetchOptions, fetchFn);\n}\nasync function makeRequest(url, fetchOptions, fetchFn = fetch) {\n    let response;\n    try {\n        response = await fetchFn(url, fetchOptions);\n    }\n    catch (e) {\n        handleResponseError(e, url);\n    }\n    if (!response.ok) {\n        await handleResponseNotOk(response, url);\n    }\n    return response;\n}\nfunction handleResponseError(e, url) {\n    let err = e;\n    if (err.name === \"AbortError\") {\n        err = new GoogleGenerativeAIAbortError(`Request aborted when fetching ${url.toString()}: ${e.message}`);\n        err.stack = e.stack;\n    }\n    else if (!(e instanceof GoogleGenerativeAIFetchError ||\n        e instanceof GoogleGenerativeAIRequestInputError)) {\n        err = new GoogleGenerativeAIError(`Error fetching from ${url.toString()}: ${e.message}`);\n        err.stack = e.stack;\n    }\n    throw err;\n}\nasync function handleResponseNotOk(response, url) {\n    let message = \"\";\n    let errorDetails;\n    try {\n        const json = await response.json();\n        message = json.error.message;\n        if (json.error.details) {\n            message += ` ${JSON.stringify(json.error.details)}`;\n            errorDetails = json.error.details;\n        }\n    }\n    catch (e) {\n        // ignored\n    }\n    throw new GoogleGenerativeAIFetchError(`Error fetching from ${url.toString()}: [${response.status} ${response.statusText}] ${message}`, response.status, response.statusText, errorDetails);\n}\n/**\n * Generates the request options to be passed to the fetch API.\n * @param requestOptions - The user-defined request options.\n * @returns The generated request options.\n */\nfunction buildFetchOptions(requestOptions) {\n    const fetchOptions = {};\n    if ((requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.signal) !== undefined || (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.timeout) >= 0) {\n        const controller = new AbortController();\n        if ((requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.timeout) >= 0) {\n            setTimeout(() => controller.abort(), requestOptions.timeout);\n        }\n        if (requestOptions === null || requestOptions === void 0 ? void 0 : requestOptions.signal) {\n            requestOptions.signal.addEventListener(\"abort\", () => {\n                controller.abort();\n            });\n        }\n        fetchOptions.signal = controller.signal;\n    }\n    return fetchOptions;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Adds convenience helper methods to a response object, including stream\n * chunks (as long as each chunk is a complete GenerateContentResponse JSON).\n */\nfunction addHelpers(response) {\n    response.text = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning text from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            return getText(response);\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return \"\";\n    };\n    /**\n     * TODO: remove at next major version\n     */\n    response.functionCall = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning function calls from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            console.warn(`response.functionCall() is deprecated. ` +\n                `Use response.functionCalls() instead.`);\n            return getFunctionCalls(response)[0];\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return undefined;\n    };\n    response.functionCalls = () => {\n        if (response.candidates && response.candidates.length > 0) {\n            if (response.candidates.length > 1) {\n                console.warn(`This response had ${response.candidates.length} ` +\n                    `candidates. Returning function calls from the first candidate only. ` +\n                    `Access response.candidates directly to use the other candidates.`);\n            }\n            if (hadBadFinishReason(response.candidates[0])) {\n                throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(response)}`, response);\n            }\n            return getFunctionCalls(response);\n        }\n        else if (response.promptFeedback) {\n            throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(response)}`, response);\n        }\n        return undefined;\n    };\n    return response;\n}\n/**\n * Returns all text found in all parts of first candidate.\n */\nfunction getText(response) {\n    var _a, _b, _c, _d;\n    const textStrings = [];\n    if ((_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) {\n        for (const part of (_d = (_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0].content) === null || _d === void 0 ? void 0 : _d.parts) {\n            if (part.text) {\n                textStrings.push(part.text);\n            }\n            if (part.executableCode) {\n                textStrings.push(\"\\n```\" +\n                    part.executableCode.language +\n                    \"\\n\" +\n                    part.executableCode.code +\n                    \"\\n```\\n\");\n            }\n            if (part.codeExecutionResult) {\n                textStrings.push(\"\\n```\\n\" + part.codeExecutionResult.output + \"\\n```\\n\");\n            }\n        }\n    }\n    if (textStrings.length > 0) {\n        return textStrings.join(\"\");\n    }\n    else {\n        return \"\";\n    }\n}\n/**\n * Returns functionCall of first candidate.\n */\nfunction getFunctionCalls(response) {\n    var _a, _b, _c, _d;\n    const functionCalls = [];\n    if ((_b = (_a = response.candidates) === null || _a === void 0 ? void 0 : _a[0].content) === null || _b === void 0 ? void 0 : _b.parts) {\n        for (const part of (_d = (_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0].content) === null || _d === void 0 ? void 0 : _d.parts) {\n            if (part.functionCall) {\n                functionCalls.push(part.functionCall);\n            }\n        }\n    }\n    if (functionCalls.length > 0) {\n        return functionCalls;\n    }\n    else {\n        return undefined;\n    }\n}\nconst badFinishReasons = [\n    FinishReason.RECITATION,\n    FinishReason.SAFETY,\n    FinishReason.LANGUAGE,\n];\nfunction hadBadFinishReason(candidate) {\n    return (!!candidate.finishReason &&\n        badFinishReasons.includes(candidate.finishReason));\n}\nfunction formatBlockErrorMessage(response) {\n    var _a, _b, _c;\n    let message = \"\";\n    if ((!response.candidates || response.candidates.length === 0) &&\n        response.promptFeedback) {\n        message += \"Response was blocked\";\n        if ((_a = response.promptFeedback) === null || _a === void 0 ? void 0 : _a.blockReason) {\n            message += ` due to ${response.promptFeedback.blockReason}`;\n        }\n        if ((_b = response.promptFeedback) === null || _b === void 0 ? void 0 : _b.blockReasonMessage) {\n            message += `: ${response.promptFeedback.blockReasonMessage}`;\n        }\n    }\n    else if ((_c = response.candidates) === null || _c === void 0 ? void 0 : _c[0]) {\n        const firstCandidate = response.candidates[0];\n        if (hadBadFinishReason(firstCandidate)) {\n            message += `Candidate was blocked due to ${firstCandidate.finishReason}`;\n            if (firstCandidate.finishMessage) {\n                message += `: ${firstCandidate.finishMessage}`;\n            }\n        }\n    }\n    return message;\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol */\r\n\r\n\r\nfunction __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nfunction __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nconst responseLineRE = /^data\\: (.*)(?:\\n\\n|\\r\\r|\\r\\n\\r\\n)/;\n/**\n * Process a response.body stream from the backend and return an\n * iterator that provides one complete GenerateContentResponse at a time\n * and a promise that resolves with a single aggregated\n * GenerateContentResponse.\n *\n * @param response - Response from a fetch call\n */\nfunction processStream(response) {\n    const inputStream = response.body.pipeThrough(new TextDecoderStream(\"utf8\", { fatal: true }));\n    const responseStream = getResponseStream(inputStream);\n    const [stream1, stream2] = responseStream.tee();\n    return {\n        stream: generateResponseSequence(stream1),\n        response: getResponsePromise(stream2),\n    };\n}\nasync function getResponsePromise(stream) {\n    const allResponses = [];\n    const reader = stream.getReader();\n    while (true) {\n        const { done, value } = await reader.read();\n        if (done) {\n            return addHelpers(aggregateResponses(allResponses));\n        }\n        allResponses.push(value);\n    }\n}\nfunction generateResponseSequence(stream) {\n    return __asyncGenerator(this, arguments, function* generateResponseSequence_1() {\n        const reader = stream.getReader();\n        while (true) {\n            const { value, done } = yield __await(reader.read());\n            if (done) {\n                break;\n            }\n            yield yield __await(addHelpers(value));\n        }\n    });\n}\n/**\n * Reads a raw stream from the fetch response and join incomplete\n * chunks, returning a new stream that provides a single complete\n * GenerateContentResponse in each iteration.\n */\nfunction getResponseStream(inputStream) {\n    const reader = inputStream.getReader();\n    const stream = new ReadableStream({\n        start(controller) {\n            let currentText = \"\";\n            return pump();\n            function pump() {\n                return reader\n                    .read()\n                    .then(({ value, done }) => {\n                    if (done) {\n                        if (currentText.trim()) {\n                            controller.error(new GoogleGenerativeAIError(\"Failed to parse stream\"));\n                            return;\n                        }\n                        controller.close();\n                        return;\n                    }\n                    currentText += value;\n                    let match = currentText.match(responseLineRE);\n                    let parsedResponse;\n                    while (match) {\n                        try {\n                            parsedResponse = JSON.parse(match[1]);\n                        }\n                        catch (e) {\n                            controller.error(new GoogleGenerativeAIError(`Error parsing JSON response: \"${match[1]}\"`));\n                            return;\n                        }\n                        controller.enqueue(parsedResponse);\n                        currentText = currentText.substring(match[0].length);\n                        match = currentText.match(responseLineRE);\n                    }\n                    return pump();\n                })\n                    .catch((e) => {\n                    let err = e;\n                    err.stack = e.stack;\n                    if (err.name === \"AbortError\") {\n                        err = new GoogleGenerativeAIAbortError(\"Request aborted when reading from the stream\");\n                    }\n                    else {\n                        err = new GoogleGenerativeAIError(\"Error reading from the stream\");\n                    }\n                    throw err;\n                });\n            }\n        },\n    });\n    return stream;\n}\n/**\n * Aggregates an array of `GenerateContentResponse`s into a single\n * GenerateContentResponse.\n */\nfunction aggregateResponses(responses) {\n    const lastResponse = responses[responses.length - 1];\n    const aggregatedResponse = {\n        promptFeedback: lastResponse === null || lastResponse === void 0 ? void 0 : lastResponse.promptFeedback,\n    };\n    for (const response of responses) {\n        if (response.candidates) {\n            let candidateIndex = 0;\n            for (const candidate of response.candidates) {\n                if (!aggregatedResponse.candidates) {\n                    aggregatedResponse.candidates = [];\n                }\n                if (!aggregatedResponse.candidates[candidateIndex]) {\n                    aggregatedResponse.candidates[candidateIndex] = {\n                        index: candidateIndex,\n                    };\n                }\n                // Keep overwriting, the last one will be final\n                aggregatedResponse.candidates[candidateIndex].citationMetadata =\n                    candidate.citationMetadata;\n                aggregatedResponse.candidates[candidateIndex].groundingMetadata =\n                    candidate.groundingMetadata;\n                aggregatedResponse.candidates[candidateIndex].finishReason =\n                    candidate.finishReason;\n                aggregatedResponse.candidates[candidateIndex].finishMessage =\n                    candidate.finishMessage;\n                aggregatedResponse.candidates[candidateIndex].safetyRatings =\n                    candidate.safetyRatings;\n                /**\n                 * Candidates should always have content and parts, but this handles\n                 * possible malformed responses.\n                 */\n                if (candidate.content && candidate.content.parts) {\n                    if (!aggregatedResponse.candidates[candidateIndex].content) {\n                        aggregatedResponse.candidates[candidateIndex].content = {\n                            role: candidate.content.role || \"user\",\n                            parts: [],\n                        };\n                    }\n                    const newPart = {};\n                    for (const part of candidate.content.parts) {\n                        if (part.text) {\n                            newPart.text = part.text;\n                        }\n                        if (part.functionCall) {\n                            newPart.functionCall = part.functionCall;\n                        }\n                        if (part.executableCode) {\n                            newPart.executableCode = part.executableCode;\n                        }\n                        if (part.codeExecutionResult) {\n                            newPart.codeExecutionResult = part.codeExecutionResult;\n                        }\n                        if (Object.keys(newPart).length === 0) {\n                            newPart.text = \"\";\n                        }\n                        aggregatedResponse.candidates[candidateIndex].content.parts.push(newPart);\n                    }\n                }\n            }\n            candidateIndex++;\n        }\n        if (response.usageMetadata) {\n            aggregatedResponse.usageMetadata = response.usageMetadata;\n        }\n    }\n    return aggregatedResponse;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function generateContentStream(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.STREAM_GENERATE_CONTENT, apiKey, \n    /* stream */ true, JSON.stringify(params), requestOptions);\n    return processStream(response);\n}\nasync function generateContent(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.GENERATE_CONTENT, apiKey, \n    /* stream */ false, JSON.stringify(params), requestOptions);\n    const responseJson = await response.json();\n    const enhancedResponse = addHelpers(responseJson);\n    return {\n        response: enhancedResponse,\n    };\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nfunction formatSystemInstruction(input) {\n    // null or undefined\n    if (input == null) {\n        return undefined;\n    }\n    else if (typeof input === \"string\") {\n        return { role: \"system\", parts: [{ text: input }] };\n    }\n    else if (input.text) {\n        return { role: \"system\", parts: [input] };\n    }\n    else if (input.parts) {\n        if (!input.role) {\n            return { role: \"system\", parts: input.parts };\n        }\n        else {\n            return input;\n        }\n    }\n}\nfunction formatNewContent(request) {\n    let newParts = [];\n    if (typeof request === \"string\") {\n        newParts = [{ text: request }];\n    }\n    else {\n        for (const partOrString of request) {\n            if (typeof partOrString === \"string\") {\n                newParts.push({ text: partOrString });\n            }\n            else {\n                newParts.push(partOrString);\n            }\n        }\n    }\n    return assignRoleToPartsAndValidateSendMessageRequest(newParts);\n}\n/**\n * When multiple Part types (i.e. FunctionResponsePart and TextPart) are\n * passed in a single Part array, we may need to assign different roles to each\n * part. Currently only FunctionResponsePart requires a role other than 'user'.\n * @private\n * @param parts Array of parts to pass to the model\n * @returns Array of content items\n */\nfunction assignRoleToPartsAndValidateSendMessageRequest(parts) {\n    const userContent = { role: \"user\", parts: [] };\n    const functionContent = { role: \"function\", parts: [] };\n    let hasUserContent = false;\n    let hasFunctionContent = false;\n    for (const part of parts) {\n        if (\"functionResponse\" in part) {\n            functionContent.parts.push(part);\n            hasFunctionContent = true;\n        }\n        else {\n            userContent.parts.push(part);\n            hasUserContent = true;\n        }\n    }\n    if (hasUserContent && hasFunctionContent) {\n        throw new GoogleGenerativeAIError(\"Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.\");\n    }\n    if (!hasUserContent && !hasFunctionContent) {\n        throw new GoogleGenerativeAIError(\"No content is provided for sending chat message.\");\n    }\n    if (hasUserContent) {\n        return userContent;\n    }\n    return functionContent;\n}\nfunction formatCountTokensInput(params, modelParams) {\n    var _a;\n    let formattedGenerateContentRequest = {\n        model: modelParams === null || modelParams === void 0 ? void 0 : modelParams.model,\n        generationConfig: modelParams === null || modelParams === void 0 ? void 0 : modelParams.generationConfig,\n        safetySettings: modelParams === null || modelParams === void 0 ? void 0 : modelParams.safetySettings,\n        tools: modelParams === null || modelParams === void 0 ? void 0 : modelParams.tools,\n        toolConfig: modelParams === null || modelParams === void 0 ? void 0 : modelParams.toolConfig,\n        systemInstruction: modelParams === null || modelParams === void 0 ? void 0 : modelParams.systemInstruction,\n        cachedContent: (_a = modelParams === null || modelParams === void 0 ? void 0 : modelParams.cachedContent) === null || _a === void 0 ? void 0 : _a.name,\n        contents: [],\n    };\n    const containsGenerateContentRequest = params.generateContentRequest != null;\n    if (params.contents) {\n        if (containsGenerateContentRequest) {\n            throw new GoogleGenerativeAIRequestInputError(\"CountTokensRequest must have one of contents or generateContentRequest, not both.\");\n        }\n        formattedGenerateContentRequest.contents = params.contents;\n    }\n    else if (containsGenerateContentRequest) {\n        formattedGenerateContentRequest = Object.assign(Object.assign({}, formattedGenerateContentRequest), params.generateContentRequest);\n    }\n    else {\n        // Array or string\n        const content = formatNewContent(params);\n        formattedGenerateContentRequest.contents = [content];\n    }\n    return { generateContentRequest: formattedGenerateContentRequest };\n}\nfunction formatGenerateContentInput(params) {\n    let formattedRequest;\n    if (params.contents) {\n        formattedRequest = params;\n    }\n    else {\n        // Array or string\n        const content = formatNewContent(params);\n        formattedRequest = { contents: [content] };\n    }\n    if (params.systemInstruction) {\n        formattedRequest.systemInstruction = formatSystemInstruction(params.systemInstruction);\n    }\n    return formattedRequest;\n}\nfunction formatEmbedContentInput(params) {\n    if (typeof params === \"string\" || Array.isArray(params)) {\n        const content = formatNewContent(params);\n        return { content };\n    }\n    return params;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n// https://ai.google.dev/api/rest/v1beta/Content#part\nconst VALID_PART_FIELDS = [\n    \"text\",\n    \"inlineData\",\n    \"functionCall\",\n    \"functionResponse\",\n    \"executableCode\",\n    \"codeExecutionResult\",\n];\nconst VALID_PARTS_PER_ROLE = {\n    user: [\"text\", \"inlineData\"],\n    function: [\"functionResponse\"],\n    model: [\"text\", \"functionCall\", \"executableCode\", \"codeExecutionResult\"],\n    // System instructions shouldn't be in history anyway.\n    system: [\"text\"],\n};\nfunction validateChatHistory(history) {\n    let prevContent = false;\n    for (const currContent of history) {\n        const { role, parts } = currContent;\n        if (!prevContent && role !== \"user\") {\n            throw new GoogleGenerativeAIError(`First content should be with role 'user', got ${role}`);\n        }\n        if (!POSSIBLE_ROLES.includes(role)) {\n            throw new GoogleGenerativeAIError(`Each item should include role field. Got ${role} but valid roles are: ${JSON.stringify(POSSIBLE_ROLES)}`);\n        }\n        if (!Array.isArray(parts)) {\n            throw new GoogleGenerativeAIError(\"Content should have 'parts' property with an array of Parts\");\n        }\n        if (parts.length === 0) {\n            throw new GoogleGenerativeAIError(\"Each Content should have at least one part\");\n        }\n        const countFields = {\n            text: 0,\n            inlineData: 0,\n            functionCall: 0,\n            functionResponse: 0,\n            fileData: 0,\n            executableCode: 0,\n            codeExecutionResult: 0,\n        };\n        for (const part of parts) {\n            for (const key of VALID_PART_FIELDS) {\n                if (key in part) {\n                    countFields[key] += 1;\n                }\n            }\n        }\n        const validParts = VALID_PARTS_PER_ROLE[role];\n        for (const key of VALID_PART_FIELDS) {\n            if (!validParts.includes(key) && countFields[key] > 0) {\n                throw new GoogleGenerativeAIError(`Content with role '${role}' can't contain '${key}' part`);\n            }\n        }\n        prevContent = true;\n    }\n}\n/**\n * Returns true if the response is valid (could be appended to the history), flase otherwise.\n */\nfunction isValidResponse(response) {\n    var _a;\n    if (response.candidates === undefined || response.candidates.length === 0) {\n        return false;\n    }\n    const content = (_a = response.candidates[0]) === null || _a === void 0 ? void 0 : _a.content;\n    if (content === undefined) {\n        return false;\n    }\n    if (content.parts === undefined || content.parts.length === 0) {\n        return false;\n    }\n    for (const part of content.parts) {\n        if (part === undefined || Object.keys(part).length === 0) {\n            return false;\n        }\n        if (part.text !== undefined && part.text === \"\") {\n            return false;\n        }\n    }\n    return true;\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Do not log a message for this error.\n */\nconst SILENT_ERROR = \"SILENT_ERROR\";\n/**\n * ChatSession class that enables sending chat messages and stores\n * history of sent and received messages so far.\n *\n * @public\n */\nclass ChatSession {\n    constructor(apiKey, model, params, _requestOptions = {}) {\n        this.model = model;\n        this.params = params;\n        this._requestOptions = _requestOptions;\n        this._history = [];\n        this._sendPromise = Promise.resolve();\n        this._apiKey = apiKey;\n        if (params === null || params === void 0 ? void 0 : params.history) {\n            validateChatHistory(params.history);\n            this._history = params.history;\n        }\n    }\n    /**\n     * Gets the chat history so far. Blocked prompts are not added to history.\n     * Blocked candidates are not added to history, nor are the prompts that\n     * generated them.\n     */\n    async getHistory() {\n        await this._sendPromise;\n        return this._history;\n    }\n    /**\n     * Sends a chat message and receives a non-streaming\n     * {@link GenerateContentResult}.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async sendMessage(request, requestOptions = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        await this._sendPromise;\n        const newContent = formatNewContent(request);\n        const generateContentRequest = {\n            safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,\n            generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,\n            tools: (_c = this.params) === null || _c === void 0 ? void 0 : _c.tools,\n            toolConfig: (_d = this.params) === null || _d === void 0 ? void 0 : _d.toolConfig,\n            systemInstruction: (_e = this.params) === null || _e === void 0 ? void 0 : _e.systemInstruction,\n            cachedContent: (_f = this.params) === null || _f === void 0 ? void 0 : _f.cachedContent,\n            contents: [...this._history, newContent],\n        };\n        const chatSessionRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        let finalResult;\n        // Add onto the chain.\n        this._sendPromise = this._sendPromise\n            .then(() => generateContent(this._apiKey, this.model, generateContentRequest, chatSessionRequestOptions))\n            .then((result) => {\n            var _a;\n            if (isValidResponse(result.response)) {\n                this._history.push(newContent);\n                const responseContent = Object.assign({ parts: [], \n                    // Response seems to come back without a role set.\n                    role: \"model\" }, (_a = result.response.candidates) === null || _a === void 0 ? void 0 : _a[0].content);\n                this._history.push(responseContent);\n            }\n            else {\n                const blockErrorMessage = formatBlockErrorMessage(result.response);\n                if (blockErrorMessage) {\n                    console.warn(`sendMessage() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);\n                }\n            }\n            finalResult = result;\n        })\n            .catch((e) => {\n            // Resets _sendPromise to avoid subsequent calls failing and throw error.\n            this._sendPromise = Promise.resolve();\n            throw e;\n        });\n        await this._sendPromise;\n        return finalResult;\n    }\n    /**\n     * Sends a chat message and receives the response as a\n     * {@link GenerateContentStreamResult} containing an iterable stream\n     * and a response promise.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async sendMessageStream(request, requestOptions = {}) {\n        var _a, _b, _c, _d, _e, _f;\n        await this._sendPromise;\n        const newContent = formatNewContent(request);\n        const generateContentRequest = {\n            safetySettings: (_a = this.params) === null || _a === void 0 ? void 0 : _a.safetySettings,\n            generationConfig: (_b = this.params) === null || _b === void 0 ? void 0 : _b.generationConfig,\n            tools: (_c = this.params) === null || _c === void 0 ? void 0 : _c.tools,\n            toolConfig: (_d = this.params) === null || _d === void 0 ? void 0 : _d.toolConfig,\n            systemInstruction: (_e = this.params) === null || _e === void 0 ? void 0 : _e.systemInstruction,\n            cachedContent: (_f = this.params) === null || _f === void 0 ? void 0 : _f.cachedContent,\n            contents: [...this._history, newContent],\n        };\n        const chatSessionRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        const streamPromise = generateContentStream(this._apiKey, this.model, generateContentRequest, chatSessionRequestOptions);\n        // Add onto the chain.\n        this._sendPromise = this._sendPromise\n            .then(() => streamPromise)\n            // This must be handled to avoid unhandled rejection, but jump\n            // to the final catch block with a label to not log this error.\n            .catch((_ignored) => {\n            throw new Error(SILENT_ERROR);\n        })\n            .then((streamResult) => streamResult.response)\n            .then((response) => {\n            if (isValidResponse(response)) {\n                this._history.push(newContent);\n                const responseContent = Object.assign({}, response.candidates[0].content);\n                // Response seems to come back without a role set.\n                if (!responseContent.role) {\n                    responseContent.role = \"model\";\n                }\n                this._history.push(responseContent);\n            }\n            else {\n                const blockErrorMessage = formatBlockErrorMessage(response);\n                if (blockErrorMessage) {\n                    console.warn(`sendMessageStream() was unsuccessful. ${blockErrorMessage}. Inspect response object for details.`);\n                }\n            }\n        })\n            .catch((e) => {\n            // Errors in streamPromise are already catchable by the user as\n            // streamPromise is returned.\n            // Avoid duplicating the error message in logs.\n            if (e.message !== SILENT_ERROR) {\n                // Users do not have access to _sendPromise to catch errors\n                // downstream from streamPromise, so they should not throw.\n                console.error(e);\n            }\n        });\n        return streamPromise;\n    }\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function countTokens(apiKey, model, params, singleRequestOptions) {\n    const response = await makeModelRequest(model, Task.COUNT_TOKENS, apiKey, false, JSON.stringify(params), singleRequestOptions);\n    return response.json();\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nasync function embedContent(apiKey, model, params, requestOptions) {\n    const response = await makeModelRequest(model, Task.EMBED_CONTENT, apiKey, false, JSON.stringify(params), requestOptions);\n    return response.json();\n}\nasync function batchEmbedContents(apiKey, model, params, requestOptions) {\n    const requestsWithModel = params.requests.map((request) => {\n        return Object.assign(Object.assign({}, request), { model });\n    });\n    const response = await makeModelRequest(model, Task.BATCH_EMBED_CONTENTS, apiKey, false, JSON.stringify({ requests: requestsWithModel }), requestOptions);\n    return response.json();\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Class for generative model APIs.\n * @public\n */\nclass GenerativeModel {\n    constructor(apiKey, modelParams, _requestOptions = {}) {\n        this.apiKey = apiKey;\n        this._requestOptions = _requestOptions;\n        if (modelParams.model.includes(\"/\")) {\n            // Models may be named \"models/model-name\" or \"tunedModels/model-name\"\n            this.model = modelParams.model;\n        }\n        else {\n            // If path is not included, assume it's a non-tuned model.\n            this.model = `models/${modelParams.model}`;\n        }\n        this.generationConfig = modelParams.generationConfig || {};\n        this.safetySettings = modelParams.safetySettings || [];\n        this.tools = modelParams.tools;\n        this.toolConfig = modelParams.toolConfig;\n        this.systemInstruction = formatSystemInstruction(modelParams.systemInstruction);\n        this.cachedContent = modelParams.cachedContent;\n    }\n    /**\n     * Makes a single non-streaming call to the model\n     * and returns an object containing a single {@link GenerateContentResponse}.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async generateContent(request, requestOptions = {}) {\n        var _a;\n        const formattedParams = formatGenerateContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return generateContent(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, formattedParams), generativeModelRequestOptions);\n    }\n    /**\n     * Makes a single streaming call to the model and returns an object\n     * containing an iterable stream that iterates over all chunks in the\n     * streaming response as well as a promise that returns the final\n     * aggregated response.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async generateContentStream(request, requestOptions = {}) {\n        var _a;\n        const formattedParams = formatGenerateContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return generateContentStream(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, formattedParams), generativeModelRequestOptions);\n    }\n    /**\n     * Gets a new {@link ChatSession} instance which can be used for\n     * multi-turn chats.\n     */\n    startChat(startChatParams) {\n        var _a;\n        return new ChatSession(this.apiKey, this.model, Object.assign({ generationConfig: this.generationConfig, safetySettings: this.safetySettings, tools: this.tools, toolConfig: this.toolConfig, systemInstruction: this.systemInstruction, cachedContent: (_a = this.cachedContent) === null || _a === void 0 ? void 0 : _a.name }, startChatParams), this._requestOptions);\n    }\n    /**\n     * Counts the tokens in the provided request.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async countTokens(request, requestOptions = {}) {\n        const formattedParams = formatCountTokensInput(request, {\n            model: this.model,\n            generationConfig: this.generationConfig,\n            safetySettings: this.safetySettings,\n            tools: this.tools,\n            toolConfig: this.toolConfig,\n            systemInstruction: this.systemInstruction,\n            cachedContent: this.cachedContent,\n        });\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return countTokens(this.apiKey, this.model, formattedParams, generativeModelRequestOptions);\n    }\n    /**\n     * Embeds the provided content.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async embedContent(request, requestOptions = {}) {\n        const formattedParams = formatEmbedContentInput(request);\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return embedContent(this.apiKey, this.model, formattedParams, generativeModelRequestOptions);\n    }\n    /**\n     * Embeds an array of {@link EmbedContentRequest}s.\n     *\n     * Fields set in the optional {@link SingleRequestOptions} parameter will\n     * take precedence over the {@link RequestOptions} values provided to\n     * {@link GoogleGenerativeAI.getGenerativeModel }.\n     */\n    async batchEmbedContents(batchEmbedContentRequest, requestOptions = {}) {\n        const generativeModelRequestOptions = Object.assign(Object.assign({}, this._requestOptions), requestOptions);\n        return batchEmbedContents(this.apiKey, this.model, batchEmbedContentRequest, generativeModelRequestOptions);\n    }\n}\n\n/**\n * @license\n * Copyright 2024 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Top-level class for this SDK\n * @public\n */\nclass GoogleGenerativeAI {\n    constructor(apiKey) {\n        this.apiKey = apiKey;\n    }\n    /**\n     * Gets a {@link GenerativeModel} instance for the provided model name.\n     */\n    getGenerativeModel(modelParams, requestOptions) {\n        if (!modelParams.model) {\n            throw new GoogleGenerativeAIError(`Must provide a model name. ` +\n                `Example: genai.getGenerativeModel({ model: 'my-model-name' })`);\n        }\n        return new GenerativeModel(this.apiKey, modelParams, requestOptions);\n    }\n    /**\n     * Creates a {@link GenerativeModel} instance from provided content cache.\n     */\n    getGenerativeModelFromCachedContent(cachedContent, modelParams, requestOptions) {\n        if (!cachedContent.name) {\n            throw new GoogleGenerativeAIRequestInputError(\"Cached content must contain a `name` field.\");\n        }\n        if (!cachedContent.model) {\n            throw new GoogleGenerativeAIRequestInputError(\"Cached content must contain a `model` field.\");\n        }\n        /**\n         * Not checking tools and toolConfig for now as it would require a deep\n         * equality comparison and isn't likely to be a common case.\n         */\n        const disallowedDuplicates = [\"model\", \"systemInstruction\"];\n        for (const key of disallowedDuplicates) {\n            if ((modelParams === null || modelParams === void 0 ? void 0 : modelParams[key]) &&\n                cachedContent[key] &&\n                (modelParams === null || modelParams === void 0 ? void 0 : modelParams[key]) !== cachedContent[key]) {\n                if (key === \"model\") {\n                    const modelParamsComp = modelParams.model.startsWith(\"models/\")\n                        ? modelParams.model.replace(\"models/\", \"\")\n                        : modelParams.model;\n                    const cachedContentComp = cachedContent.model.startsWith(\"models/\")\n                        ? cachedContent.model.replace(\"models/\", \"\")\n                        : cachedContent.model;\n                    if (modelParamsComp === cachedContentComp) {\n                        continue;\n                    }\n                }\n                throw new GoogleGenerativeAIRequestInputError(`Different value for \"${key}\" specified in modelParams` +\n                    ` (${modelParams[key]}) and cachedContent (${cachedContent[key]})`);\n            }\n        }\n        const modelParamsFromCache = Object.assign(Object.assign({}, modelParams), { model: cachedContent.model, tools: cachedContent.tools, toolConfig: cachedContent.toolConfig, systemInstruction: cachedContent.systemInstruction, cachedContent });\n        return new GenerativeModel(this.apiKey, modelParamsFromCache, requestOptions);\n    }\n}\n\nexport { BlockReason, ChatSession, DynamicRetrievalMode, ExecutableCodeLanguage, FinishReason, FunctionCallingMode, GenerativeModel, GoogleGenerativeAI, GoogleGenerativeAIAbortError, GoogleGenerativeAIError, GoogleGenerativeAIFetchError, GoogleGenerativeAIRequestInputError, GoogleGenerativeAIResponseError, HarmBlockThreshold, HarmCategory, HarmProbability, Outcome, POSSIBLE_ROLES, SchemaType, TaskType };\n//# sourceMappingURL=index.mjs.map\n","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./taskpane.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!./taskpane.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\n * AI Compose  Settings Service\n *\n * Manages user preferences and API configuration.\n * Persists settings to localStorage (syncs automatically across sessions).\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\nimport { initGeminiClient } from '../services/gemini';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\n/** Tone options available across Draft and Reply features. */\nexport type Tone = 'professional' | 'formal' | 'friendly' | 'casual';\n\n/** Summary style options for the Summarize feature. */\nexport type SummaryStyle = 'bullets' | 'paragraph' | 'tldr';\n\n/** All persisted user preferences. */\nexport interface AIComposeSettings {\n  /** Google Gemini API key (stored in plain text in localStorage). */\n  apiKey: string;\n  /** Gemini model to use for all features. */\n  defaultModel: string;\n  /** Default tone for Draft Email and Reply. */\n  defaultTone: Tone;\n  /** Default summary style for Summarize. */\n  defaultSummaryStyle: SummaryStyle;\n  /** Default target language for Translate. */\n  defaultLanguage: string;\n}\n\n/** @deprecated Use AIComposeSettings instead. */\nexport type GlideSettings = AIComposeSettings;\n\n// ---------------------------------------------------------------------------\n// Defaults\n// ---------------------------------------------------------------------------\n\nconst STORAGE_KEY = 'ai_compose_settings';\nconst LEGACY_STORAGE_KEY = 'glide_settings';\n\nconst DEFAULT_SETTINGS: AIComposeSettings = {\n  apiKey: '',\n  defaultModel: 'gemini-3-flash-preview',\n  defaultTone: 'professional',\n  defaultSummaryStyle: 'bullets',\n  defaultLanguage: 'English',\n};\n\n// ---------------------------------------------------------------------------\n// In-memory cache\n// ---------------------------------------------------------------------------\n\nlet cached: AIComposeSettings | null = null;\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Load settings from localStorage (or return defaults).\n */\nexport function loadSettings(): AIComposeSettings {\n  if (cached) return { ...cached };\n\n  try {\n    let raw = localStorage.getItem(STORAGE_KEY);\n\n    // One-time migration from legacy \"glide_settings\" key\n    if (!raw) {\n      const legacy = localStorage.getItem(LEGACY_STORAGE_KEY);\n      if (legacy) {\n        raw = legacy;\n        localStorage.setItem(STORAGE_KEY, legacy);\n        localStorage.removeItem(LEGACY_STORAGE_KEY);\n      }\n    }\n\n    if (raw) {\n      const parsed = JSON.parse(raw) as Partial<AIComposeSettings>;\n      cached = { ...DEFAULT_SETTINGS, ...parsed };\n    } else {\n      cached = { ...DEFAULT_SETTINGS };\n    }\n  } catch {\n    cached = { ...DEFAULT_SETTINGS };\n  }\n\n  return { ...cached };\n}\n\n/**\n * Save settings to localStorage and update the in-memory cache.\n * If the API key changed, automatically re-initializes the Gemini client.\n */\nexport function saveSettings(settings: AIComposeSettings): void {\n  const previousKey = cached?.apiKey || '';\n\n  cached = { ...settings };\n\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(cached));\n  } catch {\n    // localStorage might be unavailable in some sandboxed environments\n  }\n\n  // Re-initialize Gemini client if the API key changed\n  if (settings.apiKey && settings.apiKey !== previousKey) {\n    try {\n      initGeminiClient(settings.apiKey);\n    } catch {\n      // Will be retried on next action\n    }\n  }\n}\n\n/**\n * Get the current API key (loads settings if not cached).\n */\nexport function getApiKey(): string {\n  return loadSettings().apiKey;\n}\n\n/**\n * Update just the API key (convenience method).\n */\nexport function setApiKey(key: string): void {\n  const settings = loadSettings();\n  settings.apiKey = key;\n  saveSettings(settings);\n}\n\n/**\n * Get a single setting value.\n */\nexport function getSetting<K extends keyof AIComposeSettings>(key: K): AIComposeSettings[K] {\n  return loadSettings()[key];\n}\n\n/**\n * Reset all settings to defaults and clear localStorage.\n */\nexport function resetSettings(): void {\n  cached = { ...DEFAULT_SETTINGS };\n  try {\n    localStorage.removeItem(STORAGE_KEY);\n  } catch {\n    // Ignore\n  }\n}\n","/**\n * AI Compose  Gemini Client Service\n *\n * Provides a typed interface to the Google Generative AI (Gemini) API\n * with configurable parameters, rate-limiting with exponential backoff,\n * and granular error handling.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\nimport { GoogleGenerativeAI, GenerativeModel, GenerationConfig } from '@google/generative-ai';\nimport { getSetting } from '../features/settings';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\n/** Configurable generation options passed to `generateText`. */\nexport interface GenerateOptions {\n  /** Controls randomness. Lower = more deterministic. Range: 0.02.0. Default: 1.0 */\n  temperature?: number;\n  /** Maximum number of tokens in the response. Default: 2048 */\n  maxOutputTokens?: number;\n  /** Nucleus sampling. Range: 0.01.0. Default: 0.95 */\n  topP?: number;\n  /** Top-K sampling. Default: 40 */\n  topK?: number;\n  /** Which Gemini model to use. Default: user's saved setting or 'gemini-2.5-flash' */\n  model?: string;\n}\n\n/** Error codes surfaced by the Gemini service. */\nexport enum GeminiErrorCode {\n  INVALID_API_KEY = 'INVALID_API_KEY',\n  QUOTA_EXCEEDED = 'QUOTA_EXCEEDED',\n  RATE_LIMITED = 'RATE_LIMITED',\n  NETWORK_ERROR = 'NETWORK_ERROR',\n  TIMEOUT = 'TIMEOUT',\n  CONTENT_FILTERED = 'CONTENT_FILTERED',\n  UNKNOWN = 'UNKNOWN',\n}\n\n/** Typed error thrown by the Gemini service. */\nexport class GeminiError extends Error {\n  code: GeminiErrorCode;\n  retryable: boolean;\n  statusCode?: number;\n\n  constructor(message: string, code: GeminiErrorCode, retryable = false, statusCode?: number) {\n    super(message);\n    this.name = 'GeminiError';\n    this.code = code;\n    this.retryable = retryable;\n    this.statusCode = statusCode;\n    // Fix prototype chain for ES5 targets (TypeScript class extending Error)\n    Object.setPrototypeOf(this, GeminiError.prototype);\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Constants\n// ---------------------------------------------------------------------------\n\nconst FALLBACK_MODEL = 'gemini-3-flash-preview';\nconst DEFAULT_TEMPERATURE = 1.0;\nconst DEFAULT_MAX_OUTPUT_TOKENS = 2048;\nconst DEFAULT_TOP_P = 0.95;\nconst DEFAULT_TOP_K = 40;\n\nconst MAX_RETRIES = 3;\nconst INITIAL_RETRY_DELAY_MS = 1000;\nconst RETRY_BACKOFF_FACTOR = 2;\nconst REQUEST_TIMEOUT_MS = 30_000;\n\n// ---------------------------------------------------------------------------\n// Client singleton\n// ---------------------------------------------------------------------------\n\nlet clientInstance: GoogleGenerativeAI | null = null;\n\n/**\n * Initialise (or reinitialise) the Gemini client with the given API key.\n * Returns the `GoogleGenerativeAI` instance for direct access if needed.\n */\nexport function initGeminiClient(apiKey: string): GoogleGenerativeAI {\n  if (!apiKey || apiKey.trim().length === 0) {\n    throw new GeminiError(\n      'API key is required. Please set GEMINI_API_KEY in your .env file.',\n      GeminiErrorCode.INVALID_API_KEY,\n    );\n  }\n  clientInstance = new GoogleGenerativeAI(apiKey);\n  return clientInstance;\n}\n\n/**\n * Returns the current client instance, or throws if `initGeminiClient`\n * has not been called yet.\n */\nfunction getClient(): GoogleGenerativeAI {\n  if (!clientInstance) {\n    throw new GeminiError(\n      'Gemini client not initialised. Call initGeminiClient(apiKey) first.',\n      GeminiErrorCode.INVALID_API_KEY,\n    );\n  }\n  return clientInstance;\n}\n\n// ---------------------------------------------------------------------------\n// Core generation function\n// ---------------------------------------------------------------------------\n\n/**\n * Send a prompt to Gemini and return the generated text.\n *\n * @param prompt  - The user prompt string.\n * @param options - Optional generation parameters.\n * @returns The model's text response.\n *\n * @throws {GeminiError} with a typed `code` for every failure scenario.\n */\nexport async function generateText(\n  prompt: string,\n  options: GenerateOptions = {},\n): Promise<string> {\n  const client = getClient();\n  const modelName = options.model ?? getSetting('defaultModel') ?? FALLBACK_MODEL;\n\n  const generationConfig: GenerationConfig = {\n    temperature: options.temperature ?? DEFAULT_TEMPERATURE,\n    maxOutputTokens: options.maxOutputTokens ?? DEFAULT_MAX_OUTPUT_TOKENS,\n    topP: options.topP ?? DEFAULT_TOP_P,\n    topK: options.topK ?? DEFAULT_TOP_K,\n  };\n\n  const model: GenerativeModel = client.getGenerativeModel({\n    model: modelName,\n    generationConfig,\n  });\n\n  return retryWithBackoff(() => callModel(model, prompt));\n}\n\n// ---------------------------------------------------------------------------\n// Internal helpers\n// ---------------------------------------------------------------------------\n\n/** Make a single API call with a timeout wrapper. */\nasync function callModel(model: GenerativeModel, prompt: string): Promise<string> {\n  try {\n    const result = await withTimeout(model.generateContent(prompt), REQUEST_TIMEOUT_MS);\n\n    const response = result.response;\n    const text = response.text();\n\n    if (!text || text.trim().length === 0) {\n      throw new GeminiError(\n        'The model returned an empty response. The content may have been filtered.',\n        GeminiErrorCode.CONTENT_FILTERED,\n      );\n    }\n\n    return text;\n  } catch (error) {\n    throw classifyError(error);\n  }\n}\n\n/** Wrap a promise with a timeout. */\nfunction withTimeout<T>(promise: Promise<T>, ms: number): Promise<T> {\n  return new Promise<T>((resolve, reject) => {\n    const timer = setTimeout(() => {\n      reject(\n        new GeminiError(\n          `Request timed out after ${ms / 1000}s. Check your network connection.`,\n          GeminiErrorCode.TIMEOUT,\n          true,\n        ),\n      );\n    }, ms);\n\n    promise\n      .then((value) => {\n        clearTimeout(timer);\n        resolve(value);\n      })\n      .catch((err) => {\n        clearTimeout(timer);\n        reject(err);\n      });\n  });\n}\n\n/**\n * Retry a function with exponential backoff.\n * Only retries errors marked as `retryable`.\n */\nasync function retryWithBackoff(fn: () => Promise<string>): Promise<string> {\n  let lastError: GeminiError | undefined;\n  let delay = INITIAL_RETRY_DELAY_MS;\n\n  for (let attempt = 0; attempt <= MAX_RETRIES; attempt++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error instanceof GeminiError ? error : classifyError(error);\n\n      if (!lastError.retryable || attempt === MAX_RETRIES) {\n        throw lastError;\n      }\n\n      // Wait with jitter before retrying\n      const jitter = Math.random() * 0.3 * delay;\n      await sleep(delay + jitter);\n      delay *= RETRY_BACKOFF_FACTOR;\n    }\n  }\n\n  // Should never reach here, but TypeScript needs it\n  throw lastError!;\n}\n\n/** Classify raw errors into typed GeminiError instances. */\nfunction classifyError(error: unknown): GeminiError {\n  // Already classified\n  if (error instanceof GeminiError) {\n    return error;\n  }\n\n  const message = error instanceof Error ? error.message : String(error);\n  const statusCode = extractStatusCode(error);\n\n  // Invalid / expired API key\n  if (statusCode === 401 || statusCode === 403 || /api.?key/i.test(message)) {\n    return new GeminiError(\n      'Invalid or expired API key. Please check your GEMINI_API_KEY.',\n      GeminiErrorCode.INVALID_API_KEY,\n      false,\n      statusCode,\n    );\n  }\n\n  // Rate limited\n  if (statusCode === 429 || /rate.?limit/i.test(message) || /too many requests/i.test(message)) {\n    return new GeminiError(\n      'Rate limited by the Gemini API. Retrying with backoff',\n      GeminiErrorCode.RATE_LIMITED,\n      true,\n      429,\n    );\n  }\n\n  // Quota exceeded\n  if (statusCode === 429 && /quota/i.test(message)) {\n    return new GeminiError(\n      'API quota exceeded. Check your billing and quota settings in the Google Cloud Console.',\n      GeminiErrorCode.QUOTA_EXCEEDED,\n      false,\n      429,\n    );\n  }\n\n  // Network errors\n  if (\n    /network/i.test(message) ||\n    /fetch failed/i.test(message) ||\n    /ECONNREFUSED/i.test(message) ||\n    /ENOTFOUND/i.test(message) ||\n    /offline/i.test(message)\n  ) {\n    return new GeminiError(\n      'Network error  please check your internet connection.',\n      GeminiErrorCode.NETWORK_ERROR,\n      true,\n    );\n  }\n\n  // Content safety filter\n  if (/safety/i.test(message) || /blocked/i.test(message) || /filter/i.test(message)) {\n    return new GeminiError(\n      'The response was blocked by content safety filters.',\n      GeminiErrorCode.CONTENT_FILTERED,\n      false,\n    );\n  }\n\n  // Server errors (5xx) are retryable\n  if (statusCode && statusCode >= 500) {\n    return new GeminiError(\n      `Server error (${statusCode}). Retrying`,\n      GeminiErrorCode.UNKNOWN,\n      true,\n      statusCode,\n    );\n  }\n\n  // Unknown\n  return new GeminiError(\n    `Unexpected error: ${message}`,\n    GeminiErrorCode.UNKNOWN,\n    false,\n    statusCode,\n  );\n}\n\n/** Try to extract an HTTP status code from an error object. */\nfunction extractStatusCode(error: unknown): number | undefined {\n  if (error && typeof error === 'object') {\n    const obj = error as Record<string, unknown>;\n    if (typeof obj.status === 'number') return obj.status;\n    if (typeof obj.statusCode === 'number') return obj.statusCode;\n    if (typeof obj.code === 'number') return obj.code;\n    // Google AI SDK sometimes nests it\n    if (obj.response && typeof obj.response === 'object') {\n      const resp = obj.response as Record<string, unknown>;\n      if (typeof resp.status === 'number') return resp.status;\n    }\n  }\n  return undefined;\n}\n\n/** Promise-based sleep. */\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n","/**\n * AI Compose  Prompt Builder\n *\n * Utilities for constructing prompts from templates with variable\n * substitution and safe context truncation.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\n/** A record of placeholder names (without braces) to their values. */\nexport type PromptVariables = Record<string, string>;\n\n// ---------------------------------------------------------------------------\n// Constants\n// ---------------------------------------------------------------------------\n\n/**\n * Rough estimate: 1 token  4 characters for English text.\n * This is a conservative approximation used for truncation.\n */\nconst CHARS_PER_TOKEN = 4;\n\n/** Suffix appended when text is truncated. */\nconst TRUNCATION_SUFFIX = '\\n\\n[Content truncated due to length]';\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Replace `{{PLACEHOLDER}}` markers in a template with the provided values.\n *\n * - Placeholders are case-sensitive and matched exactly.\n * - Missing variables are left as-is (e.g. `{{UNKNOWN}}` stays in the output).\n * - Extra variables not present in the template are silently ignored.\n *\n * @param template  - The prompt template string with `{{VAR}}` placeholders.\n * @param variables - A key-value map of placeholder names to replacement values.\n * @returns The fully interpolated prompt string.\n *\n * @example\n * ```ts\n * buildPrompt('Hello {{NAME}}, your order {{ID}} is ready.', {\n *   NAME: 'Alice',\n *   ID: '12345',\n * });\n * //  'Hello Alice, your order 12345 is ready.'\n * ```\n */\nexport function buildPrompt(template: string, variables: PromptVariables): string {\n  if (!template) {\n    throw new Error('Prompt template cannot be empty.');\n  }\n\n  let result = template;\n\n  for (const [key, value] of Object.entries(variables)) {\n    // Replace all occurrences of {{KEY}} with the provided value\n    const placeholder = `{{${key}}}`;\n    result = result.split(placeholder).join(value);\n  }\n\n  return result;\n}\n\n/**\n * Safely truncate text to fit within an approximate token budget.\n *\n * Truncation is performed at sentence boundaries when possible to avoid\n * cutting mid-sentence. A suffix is appended to indicate that content\n * was removed.\n *\n * @param text      - The text to truncate.\n * @param maxTokens - The maximum number of tokens allowed.\n * @returns The (possibly truncated) text.\n *\n * @example\n * ```ts\n * truncateContext('A very long email body...', 500);\n * //  First ~2000 chars, ending at a sentence boundary + truncation notice\n * ```\n */\nexport function truncateContext(text: string, maxTokens: number): string {\n  if (!text) return text;\n  if (maxTokens <= 0) {\n    throw new Error('maxTokens must be a positive number.');\n  }\n\n  const maxChars = maxTokens * CHARS_PER_TOKEN;\n\n  // No truncation needed\n  if (text.length <= maxChars) {\n    return text;\n  }\n\n  // Reserve space for the truncation suffix\n  const availableChars = maxChars - TRUNCATION_SUFFIX.length;\n\n  if (availableChars <= 0) {\n    return TRUNCATION_SUFFIX.trim();\n  }\n\n  // Try to truncate at a sentence boundary\n  const slice = text.slice(0, availableChars);\n  const lastSentenceEnd = findLastSentenceBoundary(slice);\n\n  const truncated = lastSentenceEnd > 0 ? slice.slice(0, lastSentenceEnd) : slice;\n\n  return truncated.trimEnd() + TRUNCATION_SUFFIX;\n}\n\n/**\n * List all placeholder names found in a template.\n *\n * @param template - The prompt template string.\n * @returns An array of unique placeholder names (without braces).\n *\n * @example\n * ```ts\n * listPlaceholders('Hello {{NAME}}, your {{ITEM}} is {{STATUS}}.');\n * //  ['NAME', 'ITEM', 'STATUS']\n * ```\n */\nexport function listPlaceholders(template: string): string[] {\n  const matches = template.match(/\\{\\{([A-Z_][A-Z0-9_]*)\\}\\}/g);\n  if (!matches) return [];\n\n  const names = matches.map((m) => m.slice(2, -2));\n  return Array.from(new Set(names));\n}\n\n// ---------------------------------------------------------------------------\n// Internal helpers\n// ---------------------------------------------------------------------------\n\n/**\n * Find the index just after the last sentence-ending punctuation\n * (., !, or ?) in the given text.\n * Returns -1 if no sentence boundary is found.\n */\nfunction findLastSentenceBoundary(text: string): number {\n  // Match period, exclamation, or question mark followed by space or end-of-string\n  for (let i = text.length - 1; i >= 0; i--) {\n    const char = text[i];\n    if (char === '.' || char === '!' || char === '?') {\n      return i + 1;\n    }\n  }\n  return -1;\n}\n","/**\n * AI Compose  Draft Email Feature\n *\n * Orchestrates the \"Draft a New Email\" workflow:\n *   1. Collect user instructions, tone, and length preferences.\n *   2. Build a prompt from the DRAFT_EMAIL_PROMPT template.\n *   3. Send to Gemini via generateText().\n *   4. Display the result and allow regenerate / refine / copy-to-compose.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* global Office */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { DRAFT_EMAIL_PROMPT } from '../prompts/templates';\nimport { getItemMode } from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport interface DraftEmailOptions {\n  instructions: string;\n  tone: string;\n  length: string;\n  language?: string;\n}\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet lastOptions: DraftEmailOptions | null = null;\nlet lastDraft: string = '';\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Generate an email draft from user instructions.\n * Returns the generated draft text (including \"Subject: ...\" on the first line).\n */\nexport async function generateDraft(options: DraftEmailOptions): Promise<string> {\n  if (!options.instructions || !options.instructions.trim()) {\n    throw new Error('Please enter your instructions or bullet points.');\n  }\n\n  // Map length preference to a prompt hint\n  const lengthHint = getLengthHint(options.length);\n\n  // Build the prompt from the template\n  const prompt = buildPrompt(DRAFT_EMAIL_PROMPT, {\n    INSTRUCTIONS: `${options.instructions}\\n\\nDesired length: ${lengthHint}`,\n    TONE: options.tone || 'professional',\n    LANGUAGE: options.language || 'English',\n  });\n\n  // Call Gemini\n  const draft = await generateText(prompt, {\n    temperature: 0.7,\n    maxOutputTokens: getMaxTokensForLength(options.length),\n  });\n\n  // Store for regenerate/refine\n  lastOptions = { ...options };\n  lastDraft = draft;\n\n  return draft;\n}\n\n/**\n * Regenerate the last draft with the same inputs.\n */\nexport async function regenerateDraft(): Promise<string> {\n  if (!lastOptions) {\n    throw new Error('No previous draft to regenerate. Please generate a draft first.');\n  }\n  return generateDraft(lastOptions);\n}\n\n/**\n * Refine the last generated draft with follow-up instructions.\n */\nexport async function refineDraft(refinement: string): Promise<string> {\n  if (!lastDraft) {\n    throw new Error('No draft to refine. Please generate a draft first.');\n  }\n\n  if (!refinement || !refinement.trim()) {\n    throw new Error('Please enter your refinement instructions.');\n  }\n\n  const prompt = `You are a professional email assistant.\n\nHere is the current draft email:\n\n---\n${lastDraft}\n---\n\nPlease revise the draft based on these instructions: ${refinement}\n\nRequirements:\n- Keep the same general format (Subject line on first line, greeting, body, sign-off)\n- Apply the requested changes while maintaining quality\n- Return only the revised email, no explanations`;\n\n  const refined = await generateText(prompt, {\n    temperature: 0.6,\n    maxOutputTokens: 2048,\n  });\n\n  lastDraft = refined;\n  return refined;\n}\n\n/**\n * Insert the generated draft into the current compose window (inline),\n * or open a new compose window if in read mode.\n *\n * In compose mode: sets the subject and body directly in the active editor.\n * In read mode: falls back to displayNewMessageForm (opens new window).\n */\nexport function copyToCompose(draft: string): void {\n  const { subject, body } = parseSubjectAndBody(draft);\n  const mode = getItemMode();\n\n  if (mode === 'compose') {\n    // Insert directly into the active compose window\n    const item = Office.context.mailbox.item as any;\n\n    // Set the body inline\n    if (item && item.body && typeof item.body.setAsync === 'function') {\n      item.body.setAsync(\n        bodyToHtml(body),\n        { coercionType: Office.CoercionType.Html },\n      );\n    }\n\n    // Set the subject inline (if the draft has one)\n    if (subject && item && item.subject && typeof item.subject.setAsync === 'function') {\n      item.subject.setAsync(subject);\n    }\n  } else {\n    // Read mode  open a new compose window\n    Office.context.mailbox.displayNewMessageForm({\n      subject: subject,\n      htmlBody: bodyToHtml(body),\n    });\n  }\n}\n\n/**\n * Returns the last generated draft (for UI state restoration).\n */\nexport function getLastDraft(): string {\n  return lastDraft;\n}\n\n/**\n * Returns whether a previous draft exists (for UI state).\n */\nexport function hasPreviousDraft(): boolean {\n  return !!lastDraft;\n}\n\n// ---------------------------------------------------------------------------\n// Helpers\n// ---------------------------------------------------------------------------\n\nfunction getLengthHint(length: string): string {\n  switch (length) {\n    case 'short':\n      return 'Keep it brief  2-4 sentences maximum.';\n    case 'detailed':\n      return 'Write a thorough, detailed email covering all points.';\n    case 'medium':\n    default:\n      return 'Standard length  a few short paragraphs.';\n  }\n}\n\nfunction getMaxTokensForLength(length: string): number {\n  switch (length) {\n    case 'short':\n      return 512;\n    case 'detailed':\n      return 4096;\n    case 'medium':\n    default:\n      return 2048;\n  }\n}\n\n/**\n * Parse \"Subject: ...\" from the first line of the draft.\n */\nfunction parseSubjectAndBody(draft: string): { subject: string; body: string } {\n  const lines = draft.split('\\n');\n  let subject = '';\n  let bodyStartIndex = 0;\n\n  if (lines.length > 0 && lines[0].toLowerCase().startsWith('subject:')) {\n    subject = lines[0].replace(/^subject:\\s*/i, '').trim();\n    bodyStartIndex = 1;\n    // Skip blank line after subject\n    if (bodyStartIndex < lines.length && lines[bodyStartIndex].trim() === '') {\n      bodyStartIndex++;\n    }\n  }\n\n  const body = lines.slice(bodyStartIndex).join('\\n').trim();\n  return { subject, body };\n}\n\n/**\n * Convert plain text body to basic HTML for the compose window.\n */\nfunction bodyToHtml(text: string): string {\n  return text\n    .split('\\n\\n')\n    .map((paragraph) => `<p>${escapeHtml(paragraph).replace(/\\n/g, '<br>')}</p>`)\n    .join('');\n}\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\n","/**\n * AI Compose  Prompt Templates\n *\n * Reusable prompt templates for all AI Compose features.\n * Each template uses {{PLACEHOLDER}} syntax for variable substitution\n * via the `buildPrompt` function in builder.ts.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n// ---------------------------------------------------------------------------\n// Draft Email\n// ---------------------------------------------------------------------------\n\n/**\n * Compose a new email from bullet points or brief instructions.\n *\n * Placeholders: {{INSTRUCTIONS}}, {{TONE}}, {{LANGUAGE}}\n */\nexport const DRAFT_EMAIL_PROMPT = `You are a professional email assistant.\n\nDraft a complete email based on the following instructions:\n\n{{INSTRUCTIONS}}\n\nRequirements:\n- Tone: {{TONE}}\n- Language: {{LANGUAGE}}\n- Include a subject line on the first line prefixed with \"Subject: \"\n- Use appropriate greeting and sign-off\n- Keep the email concise and to the point\n- Do not add any commentary outside the email itself`;\n\n// ---------------------------------------------------------------------------\n// Reply\n// ---------------------------------------------------------------------------\n\n/**\n * Generate a reply to an existing email.\n *\n * Placeholders: {{ORIGINAL_EMAIL}}, {{REPLY_INSTRUCTIONS}}, {{TONE}}\n */\nexport const REPLY_PROMPT = `You are a professional email assistant.\n\nHere is the original email you are replying to:\n\n---\n{{ORIGINAL_EMAIL}}\n---\n\nReply instructions: {{REPLY_INSTRUCTIONS}}\n\nRequirements:\n- Tone: {{TONE}}\n- Write only the reply body (no subject line needed)\n- Reference relevant points from the original email naturally\n- Keep the reply focused and professional\n- Do not add any commentary outside the reply itself`;\n\n// ---------------------------------------------------------------------------\n// Summarize Thread\n// ---------------------------------------------------------------------------\n\n/**\n * Summarize a multi-message email thread.\n *\n * Placeholders: {{EMAIL_THREAD}}, {{SUMMARY_LENGTH}}\n */\nexport const SUMMARIZE_THREAD_PROMPT = `You are a professional email assistant.\n\nSummarize the following email thread:\n\n---\n{{EMAIL_THREAD}}\n---\n\nRequirements:\n- Length: {{SUMMARY_LENGTH}} (brief = 2-3 sentences, standard = 1 paragraph, detailed = multiple paragraphs)\n- Identify the key discussion points and decisions made\n- Note any action items or deadlines mentioned\n- List the participants and their main positions\n- Use bullet points for clarity where appropriate\n- Do not add opinions or information not present in the thread`;\n\n// ---------------------------------------------------------------------------\n// Improve Writing\n// ---------------------------------------------------------------------------\n\n/**\n * Improve grammar, clarity, and tone of selected text.\n *\n * Placeholders: {{TEXT}}, {{IMPROVEMENT_FOCUS}}\n */\nexport const IMPROVE_WRITING_PROMPT = `You are a professional writing assistant.\n\nImprove the following text:\n\n---\n{{TEXT}}\n---\n\nFocus on: {{IMPROVEMENT_FOCUS}}\n\nRequirements:\n- Fix grammar, spelling, and punctuation errors\n- Improve clarity and readability\n- Maintain the original meaning and intent\n- Keep the same general length unless brevity improves the text\n- Return only the improved text, no explanations or annotations`;\n\n// ---------------------------------------------------------------------------\n// Extract Action Items\n// ---------------------------------------------------------------------------\n\n/**\n * Pull tasks, deadlines, and responsibilities from emails.\n *\n * Placeholders: {{EMAIL_CONTENT}}\n */\nexport const EXTRACT_ACTION_ITEMS_PROMPT = `You are a professional email assistant.\n\nExtract all action items, tasks, and deadlines from the following email:\n\n---\n{{EMAIL_CONTENT}}\n---\n\nRequirements:\n- List each action item as a bullet point\n- For each item, identify:\n  - **Task**: What needs to be done\n  - **Owner**: Who is responsible (if mentioned)\n  - **Deadline**: When it's due (if mentioned)\n- If no action items are found, respond with \"No action items found.\"\n- Only extract items explicitly stated or clearly implied in the email\n- Do not invent tasks that are not present`;\n\n// ---------------------------------------------------------------------------\n// Translate\n// ---------------------------------------------------------------------------\n\n/**\n * Translate email content to a target language.\n *\n * Placeholders: {{TEXT}}, {{TARGET_LANGUAGE}}\n */\nexport const TRANSLATE_PROMPT = `You are a professional translator.\n\nTranslate the following text to {{TARGET_LANGUAGE}}:\n\n---\n{{TEXT}}\n---\n\nRequirements:\n- Maintain the original formatting (paragraphs, bullet points, etc.)\n- Preserve the original tone and register\n- Use natural, fluent phrasing in the target language (not literal word-for-word)\n- Keep proper nouns, brand names, and technical terms as-is unless they have\n  well-known translations\n- Return only the translated text, no explanations`;\n\n// ---------------------------------------------------------------------------\n// Change Tone\n// ---------------------------------------------------------------------------\n\n/**\n * Rewrite text in a different tone.\n *\n * Placeholders: {{TEXT}}, {{TARGET_TONE}}\n *\n * Supported tones: formal, casual, friendly, professional, assertive, empathetic\n */\nexport const CHANGE_TONE_PROMPT = `You are a professional writing assistant.\n\nRewrite the following text in a {{TARGET_TONE}} tone:\n\n---\n{{TEXT}}\n---\n\nRequirements:\n- Maintain the original meaning and all key information\n- Adjust vocabulary, sentence structure, and phrasing to match the target tone\n- Keep approximately the same length\n- Return only the rewritten text, no explanations or annotations`;\n","/**\n * AI Compose  Draft Reply Feature\n *\n * Orchestrates the \"Draft a Reply\" workflow:\n *   1. Auto-read the current email's body, subject, and sender.\n *   2. Collect reply instructions and tone from the user.\n *   3. Build a prompt from the REPLY_PROMPT template.\n *   4. Send to Gemini via generateText().\n *   5. Allow inserting the reply into the active compose window.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* global Office */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { REPLY_PROMPT } from '../prompts/templates';\nimport {\n  getCurrentEmailBody,\n  getCurrentEmailSubject,\n  getOriginalSender,\n  getItemMode,\n  EmailContact,\n} from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport interface DraftReplyOptions {\n  instructions: string;\n  tone: string;\n  includeOriginal: boolean;\n}\n\nexport interface EmailContext {\n  subject: string;\n  body: string;\n  sender: EmailContact;\n}\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet lastReplyOptions: DraftReplyOptions | null = null;\nlet lastReply: string = '';\nlet cachedContext: EmailContext | null = null;\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Read the current email context (subject, body, sender).\n * Caches the result to avoid re-reading for regenerate/refine.\n */\nexport async function loadEmailContext(): Promise<EmailContext> {\n  const [body, subject, sender] = await Promise.all([\n    getCurrentEmailBody(),\n    getCurrentEmailSubject(),\n    getOriginalSender(),\n  ]);\n\n  cachedContext = { subject, body, sender };\n  return cachedContext;\n}\n\n/**\n * Get the cached email context, or load it if needed.\n */\nexport async function getEmailContext(): Promise<EmailContext> {\n  if (cachedContext) return cachedContext;\n  return loadEmailContext();\n}\n\n/**\n * Clear the cached context (e.g. when switching emails).\n */\nexport function clearEmailContext(): void {\n  cachedContext = null;\n}\n\n/**\n * Generate a reply to the current email.\n */\nexport async function generateReply(options: DraftReplyOptions): Promise<string> {\n  if (!options.instructions || !options.instructions.trim()) {\n    throw new Error('Please enter your reply instructions.');\n  }\n\n  const context = await getEmailContext();\n\n  // Build the original email string for the prompt\n  let originalEmail = `From: ${context.sender.name} <${context.sender.email}>\\n`;\n  originalEmail += `Subject: ${context.subject}\\n\\n`;\n  originalEmail += context.body;\n\n  const prompt = buildPrompt(REPLY_PROMPT, {\n    ORIGINAL_EMAIL: originalEmail,\n    REPLY_INSTRUCTIONS: options.instructions,\n    TONE: options.tone || 'professional',\n  });\n\n  const reply = await generateText(prompt, {\n    temperature: 0.7,\n    maxOutputTokens: 2048,\n  });\n\n  lastReplyOptions = { ...options };\n  lastReply = reply;\n\n  return reply;\n}\n\n/**\n * Regenerate the last reply with the same inputs.\n */\nexport async function regenerateReply(): Promise<string> {\n  if (!lastReplyOptions) {\n    throw new Error('No previous reply to regenerate. Please generate a reply first.');\n  }\n  return generateReply(lastReplyOptions);\n}\n\n/**\n * Refine the last generated reply with follow-up instructions.\n */\nexport async function refineReply(refinement: string): Promise<string> {\n  if (!lastReply) {\n    throw new Error('No reply to refine. Please generate a reply first.');\n  }\n\n  if (!refinement || !refinement.trim()) {\n    throw new Error('Please enter your refinement instructions.');\n  }\n\n  const prompt = `You are a professional email assistant.\n\nHere is the current draft reply:\n\n---\n${lastReply}\n---\n\nPlease revise the reply based on these instructions: ${refinement}\n\nRequirements:\n- Keep the same general format (greeting, body, sign-off)\n- Apply the requested changes while maintaining quality\n- Return only the revised reply, no explanations`;\n\n  const refined = await generateText(prompt, {\n    temperature: 0.6,\n    maxOutputTokens: 2048,\n  });\n\n  lastReply = refined;\n  return refined;\n}\n\n/**\n * Insert the reply text into the currently active compose window.\n * Works when the user has already clicked Reply or Reply All in Outlook.\n */\nexport function insertIntoReply(replyText: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const mode = getItemMode();\n\n    if (mode !== 'compose') {\n      // Not in compose mode  open a reply window instead\n      // We'll use displayReplyForm which opens a reply compose\n      const item = Office.context.mailbox.item as any;\n      if (item && typeof item.displayReplyForm === 'function') {\n        item.displayReplyForm(bodyToHtml(replyText));\n        resolve();\n        return;\n      }\n      reject(new Error('Cannot insert reply  no compose window is open. Please click Reply first.'));\n      return;\n    }\n\n    // In compose mode  insert into the body\n    const item = Office.context.mailbox.item as any;\n    if (item && item.body && typeof item.body.setAsync === 'function') {\n      item.body.setAsync(\n        bodyToHtml(replyText),\n        { coercionType: Office.CoercionType.Html },\n        (result: Office.AsyncResult<void>) => {\n          if (result.status === Office.AsyncResultStatus.Succeeded) {\n            resolve();\n          } else {\n            reject(new Error(`Failed to insert reply: ${result.error?.message || 'Unknown error'}`));\n          }\n        },\n      );\n    } else {\n      reject(new Error('Cannot insert reply  compose body is not accessible.'));\n    }\n  });\n}\n\n/**\n * Open a Reply window for the current email with the generated text.\n * In compose mode: inserts the text directly into the active compose body.\n * In read mode: opens a Reply compose window via displayReplyForm.\n */\nexport function openReply(replyText: string): void {\n  const mode = getItemMode();\n  const item = Office.context.mailbox.item as any;\n\n  if (mode === 'compose') {\n    // Insert directly into the active compose body\n    if (item && item.body && typeof item.body.prependAsync === 'function') {\n      item.body.prependAsync(\n        bodyToHtml(replyText),\n        { coercionType: Office.CoercionType.Html },\n      );\n    } else {\n      throw new Error('Cannot insert reply  compose body is not accessible.');\n    }\n  } else {\n    // Read mode  open a reply window\n    if (item && typeof item.displayReplyForm === 'function') {\n      item.displayReplyForm(bodyToHtml(replyText));\n    } else {\n      throw new Error('Cannot open reply window. Please make sure an email is selected.');\n    }\n  }\n}\n\n/**\n * Open a Reply All window for the current email with the generated text.\n * In compose mode: inserts the text directly into the active compose body.\n * In read mode: opens a Reply All compose window via displayReplyAllForm.\n */\nexport function openReplyAll(replyText: string): void {\n  const mode = getItemMode();\n  const item = Office.context.mailbox.item as any;\n\n  if (mode === 'compose') {\n    // In compose mode, Reply All is the same as Reply  prepend inline\n    if (item && item.body && typeof item.body.prependAsync === 'function') {\n      item.body.prependAsync(\n        bodyToHtml(replyText),\n        { coercionType: Office.CoercionType.Html },\n      );\n    } else {\n      throw new Error('Cannot insert reply  compose body is not accessible.');\n    }\n  } else {\n    // Read mode  open a Reply All window\n    if (item && typeof item.displayReplyAllForm === 'function') {\n      item.displayReplyAllForm(bodyToHtml(replyText));\n    } else {\n      throw new Error('Cannot open Reply All window. Please make sure an email is selected.');\n    }\n  }\n}\n\n/**\n * Returns the last generated reply.\n */\nexport function getLastReply(): string {\n  return lastReply;\n}\n\n/**\n * Returns whether a previous reply exists.\n */\nexport function hasPreviousReply(): boolean {\n  return !!lastReply;\n}\n\n// ---------------------------------------------------------------------------\n// Helpers\n// ---------------------------------------------------------------------------\n\nfunction bodyToHtml(text: string): string {\n  return text\n    .split('\\n\\n')\n    .map((paragraph) => `<p>${escapeHtml(paragraph).replace(/\\n/g, '<br>')}</p>`)\n    .join('');\n}\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;');\n}\n","/**\n * AI Compose  Summarize Email Thread Feature\n *\n * Orchestrates the \"Summarize Email Thread\" workflow:\n *   1. Read the current email / conversation via the Outlook service.\n *   2. Let the user pick summary style and length.\n *   3. Build a prompt from the SUMMARIZE_THREAD_PROMPT template.\n *   4. Call Gemini and display the summary.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { SUMMARIZE_THREAD_PROMPT } from '../prompts/templates';\nimport {\n  getCurrentEmailBody,\n  getCurrentEmailSubject,\n  getEmailSender,\n  getConversationMessages,\n  EmailMessage,\n} from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport type SummaryStyle = 'bullets' | 'paragraph' | 'tldr';\nexport type SummaryLength = 'brief' | 'standard' | 'detailed';\n\nexport interface SummarizeOptions {\n  style: SummaryStyle;\n  length: SummaryLength;\n}\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet lastSummary: string = '';\nlet lastOptions: SummarizeOptions | null = null;\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Summarize the current email or conversation thread.\n */\nexport async function summarizeThread(options: SummarizeOptions): Promise<string> {\n  // Try to load the full conversation thread\n  let emailThread: string;\n\n  try {\n    const messages = await getConversationMessages();\n    emailThread = formatThread(messages);\n  } catch {\n    // Fallback: read only the current email\n    const [body, subject, sender] = await Promise.all([\n      getCurrentEmailBody(),\n      getCurrentEmailSubject(),\n      getEmailSender(),\n    ]);\n\n    emailThread = `From: ${sender.name} <${sender.email}>\\nSubject: ${subject}\\n\\n${body}`;\n  }\n\n  if (!emailThread.trim()) {\n    throw new Error('No email content to summarize. Please make sure an email is open.');\n  }\n\n  // Build length + style instructions\n  const lengthAndStyle = buildLengthStyleHint(options.length, options.style);\n\n  const prompt = buildPrompt(SUMMARIZE_THREAD_PROMPT, {\n    EMAIL_THREAD: emailThread,\n    SUMMARY_LENGTH: lengthAndStyle,\n  });\n\n  const summary = await generateText(prompt, {\n    temperature: 0.4, // Lower temperature for factual summaries\n    maxOutputTokens: getMaxTokensForLength(options.length),\n  });\n\n  lastSummary = summary;\n  lastOptions = { ...options };\n\n  return summary;\n}\n\n/**\n * Re-summarize with the same options (different phrasing).\n */\nexport async function regenerateSummary(): Promise<string> {\n  if (!lastOptions) {\n    throw new Error('No previous summary to regenerate. Please summarize first.');\n  }\n  return summarizeThread(lastOptions);\n}\n\n/**\n * Copy text to the clipboard.\n * Uses the Clipboard API with a fallback for older environments.\n */\nexport async function copyToClipboard(text: string): Promise<void> {\n  if (navigator.clipboard && navigator.clipboard.writeText) {\n    await navigator.clipboard.writeText(text);\n    return;\n  }\n\n  // Fallback: use a temporary textarea\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.style.position = 'fixed';\n  textarea.style.opacity = '0';\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand('copy');\n  document.body.removeChild(textarea);\n}\n\n/**\n * Returns the last generated summary.\n */\nexport function getLastSummary(): string {\n  return lastSummary;\n}\n\n// ---------------------------------------------------------------------------\n// Helpers\n// ---------------------------------------------------------------------------\n\nfunction formatThread(messages: EmailMessage[]): string {\n  return messages\n    .map((msg, i) => {\n      let header = `--- Message ${i + 1} ---\\n`;\n      header += `From: ${msg.sender.name} <${msg.sender.email}>\\n`;\n      header += `Subject: ${msg.subject}\\n`;\n      if (msg.dateTime) {\n        header += `Date: ${msg.dateTime}\\n`;\n      }\n      header += `\\n${msg.body}`;\n      return header;\n    })\n    .join('\\n\\n');\n}\n\nfunction buildLengthStyleHint(length: SummaryLength, style: SummaryStyle): string {\n  const lengthHint = {\n    brief: 'brief (2-3 sentences)',\n    standard: 'standard (1 paragraph)',\n    detailed: 'detailed (multiple paragraphs)',\n  }[length];\n\n  const styleHint = {\n    bullets: 'Format the summary as bullet points.',\n    paragraph: 'Format the summary as flowing prose paragraphs.',\n    tldr: 'Provide a single TL;DR sentence first, followed by key points.',\n  }[style];\n\n  return `${lengthHint}. ${styleHint}`;\n}\n\nfunction getMaxTokensForLength(length: SummaryLength): number {\n  switch (length) {\n    case 'brief':\n      return 256;\n    case 'detailed':\n      return 2048;\n    case 'standard':\n    default:\n      return 1024;\n  }\n}\n","/**\n * AI Compose  Improve Writing Feature\n *\n * Reads selected text or the full compose body, sends it to Gemini\n * with an improvement focus, and displays a before/after diff.\n * Supports \"Accept Changes\" to replace the original text.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* global Office */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { IMPROVE_WRITING_PROMPT } from '../prompts/templates';\nimport { getCurrentEmailBody, getItemMode } from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport type ImprovementFocus =\n  | 'fix_grammar'\n  | 'improve_clarity'\n  | 'make_concise'\n  | 'make_professional';\n\nexport interface ImproveOptions {\n  focus: ImprovementFocus;\n}\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet originalText: string = '';\nlet improvedText: string = '';\nlet lastOptions: ImproveOptions | null = null;\n\n// ---------------------------------------------------------------------------\n// Focus label mapping\n// ---------------------------------------------------------------------------\n\nconst FOCUS_LABELS: Record<ImprovementFocus, string> = {\n  fix_grammar: 'Fix grammar, spelling, and punctuation errors',\n  improve_clarity: 'Improve clarity and readability',\n  make_concise: 'Make the text more concise  remove unnecessary words',\n  make_professional: 'Make the tone more professional and polished',\n};\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Read the current text and generate an improved version.\n * Tries to read selected text first; falls back to the full body.\n */\nexport async function improveWriting(options: ImproveOptions): Promise<{\n  original: string;\n  improved: string;\n}> {\n  const text = await readSourceText();\n\n  if (!text.trim()) {\n    throw new Error(\n      'No text to improve. Select some text or open an email in compose mode.',\n    );\n  }\n\n  const focusLabel = FOCUS_LABELS[options.focus] || options.focus;\n\n  const prompt = buildPrompt(IMPROVE_WRITING_PROMPT, {\n    TEXT: text,\n    IMPROVEMENT_FOCUS: focusLabel,\n  });\n\n  const result = await generateText(prompt, {\n    temperature: 0.3,\n    maxOutputTokens: 2048,\n  });\n\n  originalText = text;\n  improvedText = result;\n  lastOptions = { ...options };\n\n  return { original: text, improved: result };\n}\n\n/**\n * Re-run the improvement with the same options.\n */\nexport async function regenerateImprovement(): Promise<{\n  original: string;\n  improved: string;\n}> {\n  if (!lastOptions) {\n    throw new Error('No previous improvement to regenerate.');\n  }\n  return improveWriting(lastOptions);\n}\n\n/**\n * Accept the improved text  replace the body in compose mode.\n * In read mode, copies to clipboard instead.\n */\nexport async function acceptChanges(): Promise<'replaced' | 'copied'> {\n  if (!improvedText) {\n    throw new Error('No improved text to accept.');\n  }\n\n  const mode = getItemMode();\n\n  if (mode === 'compose') {\n    await replaceComposeBody(improvedText);\n    return 'replaced';\n  } else {\n    // Read mode  copy to clipboard\n    await copyToClipboard(improvedText);\n    return 'copied';\n  }\n}\n\n/**\n * Returns the current original and improved text.\n */\nexport function getTexts(): { original: string; improved: string } {\n  return { original: originalText, improved: improvedText };\n}\n\n// ---------------------------------------------------------------------------\n// Text reading\n// ---------------------------------------------------------------------------\n\nasync function readSourceText(): Promise<string> {\n  // Try to get selected text in compose mode first\n  const mode = getItemMode();\n\n  if (mode === 'compose') {\n    try {\n      const selected = await getSelectedText();\n      if (selected.trim()) return selected;\n    } catch {\n      // Fall through to full body\n    }\n  }\n\n  // Fall back to full body\n  return getCurrentEmailBody();\n}\n\nfunction getSelectedText(): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const item = Office.context.mailbox.item;\n    if (!item) {\n      reject(new Error('No mailbox item'));\n      return;\n    }\n\n    // getSelectedDataAsync is available in compose mode\n    if (typeof (item as any).getSelectedDataAsync === 'function') {\n      (item as any).getSelectedDataAsync(\n        Office.CoercionType.Text,\n        (result: Office.AsyncResult<any>) => {\n          if (result.status === Office.AsyncResultStatus.Succeeded) {\n            resolve(result.value.data || '');\n          } else {\n            reject(new Error(result.error?.message || 'Failed to get selected text'));\n          }\n        },\n      );\n    } else {\n      resolve('');\n    }\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Body replacement\n// ---------------------------------------------------------------------------\n\nfunction replaceComposeBody(text: string): Promise<void> {\n  return new Promise((resolve, reject) => {\n    const item = Office.context.mailbox.item;\n    if (!item || !('body' in item)) {\n      reject(new Error('Cannot access compose body'));\n      return;\n    }\n\n    (item as any).body.setAsync(\n      text,\n      { coercionType: Office.CoercionType.Text },\n      (result: Office.AsyncResult<void>) => {\n        if (result.status === Office.AsyncResultStatus.Succeeded) {\n          resolve();\n        } else {\n          reject(new Error(result.error?.message || 'Failed to replace body'));\n        }\n      },\n    );\n  });\n}\n\n// ---------------------------------------------------------------------------\n// Clipboard\n// ---------------------------------------------------------------------------\n\nasync function copyToClipboard(text: string): Promise<void> {\n  if (navigator.clipboard && navigator.clipboard.writeText) {\n    await navigator.clipboard.writeText(text);\n    return;\n  }\n\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.style.position = 'fixed';\n  textarea.style.opacity = '0';\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand('copy');\n  document.body.removeChild(textarea);\n}\n\n// ---------------------------------------------------------------------------\n// Simple diff  highlights changes between original and improved\n// ---------------------------------------------------------------------------\n\n/**\n * Generate a lightweight HTML diff view.\n * Uses word-level comparison to mark additions and removals.\n */\nexport function generateDiffHtml(original: string, improved: string): string {\n  const origWords = tokenize(original);\n  const impWords = tokenize(improved);\n\n  const { added, removed, unchanged } = diffWords(origWords, impWords);\n\n  // Build original side (with removed highlights)\n  const origHtml = buildSideHtml(origWords, removed, 'glide-diff__del');\n  const impHtml = buildSideHtml(impWords, added, 'glide-diff__ins');\n\n  return `\n    <div class=\"glide-diff\">\n      <div class=\"glide-diff__panel\">\n        <div class=\"glide-diff__label\">Original</div>\n        <div class=\"glide-diff__content\">${origHtml}</div>\n      </div>\n      <div class=\"glide-diff__panel glide-diff__panel--improved\">\n        <div class=\"glide-diff__label\">Improved</div>\n        <div class=\"glide-diff__content\">${impHtml}</div>\n      </div>\n    </div>`;\n}\n\n// ---------------------------------------------------------------------------\n// Diff internals\n// ---------------------------------------------------------------------------\n\nfunction tokenize(text: string): string[] {\n  // Split into words, preserving whitespace and punctuation as tokens\n  return text.match(/\\S+|\\s+/g) || [];\n}\n\ninterface DiffResult {\n  added: Set<number>;\n  removed: Set<number>;\n  unchanged: Set<number>;\n}\n\n/**\n * Simple LCS-based word diff (good enough for typical email text).\n */\nfunction diffWords(origTokens: string[], impTokens: string[]): DiffResult {\n  const m = origTokens.length;\n  const n = impTokens.length;\n\n  // Build LCS table (bounded for performance)\n  const MAX = 500;\n  if (m > MAX || n > MAX) {\n    // For very long texts, mark everything as changed\n    return {\n      removed: new Set(Array.from({ length: m }, (_, i) => i)),\n      added: new Set(Array.from({ length: n }, (_, i) => i)),\n      unchanged: new Set(),\n    };\n  }\n\n  const dp: number[][] = Array.from({ length: m + 1 }, () =>\n    new Array(n + 1).fill(0),\n  );\n\n  for (let i = 1; i <= m; i++) {\n    for (let j = 1; j <= n; j++) {\n      if (origTokens[i - 1] === impTokens[j - 1]) {\n        dp[i][j] = dp[i - 1][j - 1] + 1;\n      } else {\n        dp[i][j] = Math.max(dp[i - 1][j], dp[i][j - 1]);\n      }\n    }\n  }\n\n  // Backtrack to find LCS members\n  const origInLCS = new Set<number>();\n  const impInLCS = new Set<number>();\n  let i = m;\n  let j = n;\n\n  while (i > 0 && j > 0) {\n    if (origTokens[i - 1] === impTokens[j - 1]) {\n      origInLCS.add(i - 1);\n      impInLCS.add(j - 1);\n      i--;\n      j--;\n    } else if (dp[i - 1][j] > dp[i][j - 1]) {\n      i--;\n    } else {\n      j--;\n    }\n  }\n\n  const removed = new Set<number>();\n  const added = new Set<number>();\n  const unchanged = new Set<number>();\n\n  for (let idx = 0; idx < m; idx++) {\n    if (origInLCS.has(idx)) {\n      unchanged.add(idx);\n    } else {\n      removed.add(idx);\n    }\n  }\n\n  for (let idx = 0; idx < n; idx++) {\n    if (!impInLCS.has(idx)) {\n      added.add(idx);\n    }\n  }\n\n  return { added, removed, unchanged };\n}\n\nfunction buildSideHtml(\n  tokens: string[],\n  highlighted: Set<number>,\n  cls: string,\n): string {\n  return tokens\n    .map((token, i) => {\n      const escaped = escapeHtml(token);\n      if (highlighted.has(i)) {\n        return `<span class=\"${cls}\">${escaped}</span>`;\n      }\n      return escaped;\n    })\n    .join('');\n}\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n}\n","/**\n * AI Compose  Extract Action Items Feature\n *\n * Reads the current email or thread, sends it to Gemini to extract\n * tasks, owners, and deadlines, then renders a checklist UI.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { EXTRACT_ACTION_ITEMS_PROMPT } from '../prompts/templates';\nimport {\n  getCurrentEmailBody,\n  getCurrentEmailSubject,\n  getEmailSender,\n  getConversationMessages,\n  EmailMessage,\n} from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport interface ActionItem {\n  task: string;\n  owner: string;\n  deadline: string;\n}\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet lastItems: ActionItem[] = [];\nlet lastRawResponse: string = '';\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Extract action items from the current email or thread.\n */\nexport async function extractActionItems(): Promise<ActionItem[]> {\n  const emailContent = await readEmailContent();\n\n  if (!emailContent.trim()) {\n    throw new Error('No email content found. Please open an email first.');\n  }\n\n  const prompt = buildPrompt(EXTRACT_ACTION_ITEMS_PROMPT, {\n    EMAIL_CONTENT: emailContent,\n  });\n\n  const raw = await generateText(prompt, {\n    temperature: 0.2, // Low temperature for factual extraction\n    maxOutputTokens: 2048,\n  });\n\n  lastRawResponse = raw;\n  lastItems = parseActionItems(raw);\n  return lastItems;\n}\n\n/**\n * Re-extract action items from the same email.\n */\nexport async function regenerateActions(): Promise<ActionItem[]> {\n  return extractActionItems();\n}\n\n/**\n * Get the last extracted items.\n */\nexport function getLastItems(): ActionItem[] {\n  return lastItems;\n}\n\n/**\n * Format action items as a plain-text task list for clipboard.\n */\nexport function formatAsTaskList(items: ActionItem[]): string {\n  if (items.length === 0) return 'No action items found.';\n\n  return items\n    .map((item, i) => {\n      let line = `${i + 1}. ${item.task}`;\n      if (item.owner && item.owner !== '') line += ` (Owner: ${item.owner})`;\n      if (item.deadline && item.deadline !== '') line += ` [Due: ${item.deadline}]`;\n      return line;\n    })\n    .join('\\n');\n}\n\n/**\n * Copy text to clipboard.\n */\nexport async function copyToClipboard(text: string): Promise<void> {\n  if (navigator.clipboard && navigator.clipboard.writeText) {\n    await navigator.clipboard.writeText(text);\n    return;\n  }\n\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.style.position = 'fixed';\n  textarea.style.opacity = '0';\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand('copy');\n  document.body.removeChild(textarea);\n}\n\n/**\n * Render action items as HTML checklist.\n */\nexport function renderChecklistHtml(items: ActionItem[]): string {\n  if (items.length === 0) {\n    return '<p class=\"glide-hint\">No action items found in this email.</p>';\n  }\n\n  const rows = items\n    .map(\n      (item, i) => `\n      <div class=\"glide-task-item\">\n        <label class=\"glide-task-item__check\">\n          <input type=\"checkbox\" data-index=\"${i}\" />\n          <span class=\"glide-task-item__checkmark\"></span>\n        </label>\n        <div class=\"glide-task-item__body\">\n          <div class=\"glide-task-item__text\">${escapeHtml(item.task)}</div>\n          <div class=\"glide-task-item__meta\">\n            ${item.owner && item.owner !== '' ? `<span class=\"glide-task-item__owner\"><strong>Owner:</strong> ${escapeHtml(item.owner)}</span>` : ''}\n            ${item.deadline && item.deadline !== '' ? `<span class=\"glide-task-item__deadline\"><strong>Due:</strong> ${escapeHtml(item.deadline)}</span>` : ''}\n          </div>\n        </div>\n      </div>`,\n    )\n    .join('');\n\n  return `<div class=\"glide-task-list\">${rows}</div>`;\n}\n\n// ---------------------------------------------------------------------------\n// Email content reader\n// ---------------------------------------------------------------------------\n\nasync function readEmailContent(): Promise<string> {\n  // Try full thread first\n  try {\n    const messages = await getConversationMessages();\n    return formatThread(messages);\n  } catch {\n    // Fallback to current email\n    const [body, subject, sender] = await Promise.all([\n      getCurrentEmailBody(),\n      getCurrentEmailSubject(),\n      getEmailSender(),\n    ]);\n\n    return `From: ${sender.name} <${sender.email}>\\nSubject: ${subject}\\n\\n${body}`;\n  }\n}\n\nfunction formatThread(messages: EmailMessage[]): string {\n  return messages\n    .map((msg, i) => {\n      let header = `--- Message ${i + 1} ---\\n`;\n      header += `From: ${msg.sender.name} <${msg.sender.email}>\\n`;\n      header += `Subject: ${msg.subject}\\n`;\n      if (msg.dateTime) header += `Date: ${msg.dateTime}\\n`;\n      header += `\\n${msg.body}`;\n      return header;\n    })\n    .join('\\n\\n');\n}\n\n// ---------------------------------------------------------------------------\n// Response parser\n// ---------------------------------------------------------------------------\n\n/**\n * Parse Gemini's response into structured action items.\n * Handles bullet-point format with Task/Owner/Deadline labels.\n */\nfunction parseActionItems(raw: string): ActionItem[] {\n  const noItemsPattern = /no action items found/i;\n  if (noItemsPattern.test(raw)) return [];\n\n  const items: ActionItem[] = [];\n\n  // Split by bullet points or numbered items\n  const blocks = raw.split(/(?:^|\\n)(?:[-*]|\\d+\\.)\\s+/);\n\n  for (const block of blocks) {\n    const trimmed = block.trim();\n    if (!trimmed) continue;\n\n    const item: ActionItem = {\n      task: '',\n      owner: '',\n      deadline: '',\n    };\n\n    // Try to extract structured fields\n    const taskMatch = trimmed.match(/\\*\\*Task\\*\\*:\\s*(.+?)(?:\\n|$)/i);\n    const ownerMatch = trimmed.match(/\\*\\*Owner\\*\\*:\\s*(.+?)(?:\\n|$)/i);\n    const deadlineMatch = trimmed.match(/\\*\\*Deadline\\*\\*:\\s*(.+?)(?:\\n|$)/i);\n\n    if (taskMatch) {\n      item.task = taskMatch[1].trim();\n      if (ownerMatch) item.owner = ownerMatch[1].trim();\n      if (deadlineMatch) item.deadline = deadlineMatch[1].trim();\n    } else {\n      // Fallback: treat the whole block as the task\n      item.task = trimmed\n        .replace(/\\*\\*/g, '')\n        .replace(/\\n/g, ' ')\n        .trim();\n    }\n\n    // Skip items that are just labels or empty\n    if (item.task && item.task.length > 2) {\n      items.push(item);\n    }\n  }\n\n  return items;\n}\n\n// ---------------------------------------------------------------------------\n// Utilities\n// ---------------------------------------------------------------------------\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n}\n","/**\n * AI Compose  Quick Translate Feature\n *\n * Reads the current email body, translates it to the selected language\n * using Gemini, and displays the result side-by-side with the original.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\nimport { generateText } from '../services/gemini';\nimport { buildPrompt } from '../prompts/builder';\nimport { TRANSLATE_PROMPT } from '../prompts/templates';\nimport { getCurrentEmailBody } from '../services/outlook';\n\n// ---------------------------------------------------------------------------\n// Types\n// ---------------------------------------------------------------------------\n\nexport interface TranslateResult {\n  original: string;\n  translated: string;\n  targetLanguage: string;\n}\n\n// ---------------------------------------------------------------------------\n// Constants\n// ---------------------------------------------------------------------------\n\nexport const LANGUAGES = [\n  { code: 'af', name: 'Afrikaans' },\n  { code: 'ar', name: 'Arabic' },\n  { code: 'zh', name: 'Chinese (Simplified)' },\n  { code: 'zh-TW', name: 'Chinese (Traditional)' },\n  { code: 'nl', name: 'Dutch' },\n  { code: 'en', name: 'English' },\n  { code: 'fr', name: 'French' },\n  { code: 'de', name: 'German' },\n  { code: 'hi', name: 'Hindi' },\n  { code: 'it', name: 'Italian' },\n  { code: 'ja', name: 'Japanese' },\n  { code: 'ko', name: 'Korean' },\n  { code: 'pl', name: 'Polish' },\n  { code: 'pt', name: 'Portuguese' },\n  { code: 'ru', name: 'Russian' },\n  { code: 'es', name: 'Spanish' },\n  { code: 'sw', name: 'Swahili' },\n  { code: 'tr', name: 'Turkish' },\n  { code: 'uk', name: 'Ukrainian' },\n  { code: 'zu', name: 'Zulu' },\n];\n\n// ---------------------------------------------------------------------------\n// State\n// ---------------------------------------------------------------------------\n\nlet lastResult: TranslateResult | null = null;\n\n// ---------------------------------------------------------------------------\n// Public API\n// ---------------------------------------------------------------------------\n\n/**\n * Translate the current email body to the target language.\n */\nexport async function translateEmail(targetLanguage: string): Promise<TranslateResult> {\n  const body = await getCurrentEmailBody();\n\n  if (!body.trim()) {\n    throw new Error('No email content found. Please open an email first.');\n  }\n\n  const prompt = buildPrompt(TRANSLATE_PROMPT, {\n    TEXT: body,\n    TARGET_LANGUAGE: targetLanguage,\n  });\n\n  const translated = await generateText(prompt, {\n    temperature: 0.3,\n    maxOutputTokens: 4096,\n  });\n\n  lastResult = {\n    original: body,\n    translated,\n    targetLanguage,\n  };\n\n  return lastResult;\n}\n\n/**\n * Re-translate with the same or different language.\n */\nexport async function regenerateTranslation(targetLanguage: string): Promise<TranslateResult> {\n  return translateEmail(targetLanguage);\n}\n\n/**\n * Get the last translation result.\n */\nexport function getLastResult(): TranslateResult | null {\n  return lastResult;\n}\n\n/**\n * Render side-by-side translation HTML.\n */\nexport function renderTranslationHtml(result: TranslateResult): string {\n  return `\n    <div class=\"glide-translate-view\">\n      <div class=\"glide-translate-panel\">\n        <div class=\"glide-translate-panel__label\">Original</div>\n        <div class=\"glide-translate-panel__text\">${escapeHtml(result.original)}</div>\n      </div>\n      <div class=\"glide-translate-panel glide-translate-panel--target\">\n        <div class=\"glide-translate-panel__label\">${escapeHtml(result.targetLanguage)}</div>\n        <div class=\"glide-translate-panel__text\">${escapeHtml(result.translated)}</div>\n      </div>\n    </div>`;\n}\n\n/**\n * Copy text to clipboard.\n */\nexport async function copyToClipboard(text: string): Promise<void> {\n  if (navigator.clipboard && navigator.clipboard.writeText) {\n    await navigator.clipboard.writeText(text);\n    return;\n  }\n\n  const textarea = document.createElement('textarea');\n  textarea.value = text;\n  textarea.style.position = 'fixed';\n  textarea.style.opacity = '0';\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand('copy');\n  document.body.removeChild(textarea);\n}\n\n// ---------------------------------------------------------------------------\n// Utilities\n// ---------------------------------------------------------------------------\n\nfunction escapeHtml(text: string): string {\n  return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\\n/g, '<br>');\n}\n","/**\n * AI Compose  Task Pane Controller\n *\n * Wires up the task pane HTML with the feature modules.\n * Handles Office.js initialization, DOM event binding, and tab switching.\n *\n *  Rizonetech (Pty) Ltd.  https://rizonesoft.com\n */\n\n/* global document, Office */\n\nimport '../styles/main.css';\nimport './taskpane.css';\nimport { initGeminiClient, generateText } from '../services/gemini';\nimport { getItemMode } from '../services/outlook';\nimport {\n  generateDraft,\n  regenerateDraft,\n  refineDraft,\n  copyToCompose,\n  DraftEmailOptions,\n} from '../features/draft-email';\nimport {\n  generateReply,\n  regenerateReply,\n  refineReply,\n  openReply,\n  openReplyAll,\n  loadEmailContext,\n  clearEmailContext,\n  DraftReplyOptions,\n} from '../features/draft-reply';\nimport {\n  summarizeThread,\n  regenerateSummary,\n  copyToClipboard,\n  SummarizeOptions,\n  SummaryStyle,\n  SummaryLength,\n} from '../features/summarize-thread';\nimport {\n  improveWriting,\n  regenerateImprovement,\n  acceptChanges,\n  generateDiffHtml,\n  ImproveOptions,\n  ImprovementFocus,\n} from '../features/improve-writing';\nimport {\n  extractActionItems,\n  regenerateActions,\n  getLastItems,\n  formatAsTaskList,\n  copyToClipboard as copyTasksToClipboard,\n  renderChecklistHtml,\n} from '../features/extract-actions';\nimport {\n  translateEmail,\n  regenerateTranslation,\n  getLastResult as getLastTranslation,\n  renderTranslationHtml,\n  copyToClipboard as copyTranslationToClipboard,\n} from '../features/translate';\nimport {\n  loadSettings,\n  saveSettings,\n  GlideSettings,\n  AIComposeSettings,\n} from '../features/settings';\n\n// ---------------------------------------------------------------------------\n// DOM helpers\n// ---------------------------------------------------------------------------\n\nconst $ = (id: string) => document.getElementById(id);\n\n/** Validate Google Gemini API key format (starts with AIza, 39 chars). */\nfunction isValidApiKeyFormat(key: string): boolean {\n  return /^AIza[0-9A-Za-z_-]{35}$/.test(key);\n}\n\nfunction showElement(id: string): void {\n  const el = $(id);\n  if (el) el.classList.remove('hidden');\n}\n\nfunction hideElement(id: string): void {\n  const el = $(id);\n  if (el) el.classList.add('hidden');\n}\n\nfunction showLoading(message?: string): void {\n  const text = $('loading-overlay')?.querySelector('.glide-loading__text') as HTMLElement;\n  if (text && message) text.textContent = message;\n  showElement('loading-overlay');\n}\n\nfunction hideLoading(): void {\n  hideElement('loading-overlay');\n}\n\nfunction showError(message: string): void {\n  const el = $('error-message');\n  if (el) el.textContent = message;\n  showElement('error-banner');\n}\n\nfunction hideError(): void {\n  hideElement('error-banner');\n}\n\nfunction setPreview(elementId: string, text: string): void {\n  const preview = $(elementId);\n  if (!preview) return;\n\n  const escaped = text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;');\n\n  const lines = escaped.split('\\n');\n  const html = lines\n    .map((line) => {\n      if (line.toLowerCase().startsWith('subject:')) {\n        return `<div class=\"glide-preview__subject\">${line}</div>`;\n      }\n      if (line.trim() === '') {\n        return '<br>';\n      }\n      return `<div>${line}</div>`;\n    })\n    .join('');\n\n  preview.innerHTML = html;\n}\n\n// ---------------------------------------------------------------------------\n// Compose-mode UI adaptation\n// ---------------------------------------------------------------------------\n\ntype UIMode = 'read' | 'compose' | 'unknown';\n\nfunction adaptUIForMode(mode: UIMode): void {\n  if (mode === 'compose') {\n    // Draft section: \"Copy to Compose\"  \"Insert into Email\"\n    const copyComposeBtn = $('btn-copy-compose');\n    if (copyComposeBtn) {\n      copyComposeBtn.innerHTML =\n        '<i class=\"ms-Icon ms-Icon--Edit\"></i> Insert into Email';\n      copyComposeBtn.title = 'Insert the draft into the current email';\n    }\n\n    // Reply section: \"Reply\"  \"Insert Reply\", hide \"Reply All\"\n    const insertReplyBtn = $('btn-insert-reply');\n    if (insertReplyBtn) {\n      insertReplyBtn.innerHTML =\n        '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z\"/><path d=\"m15 5 4 4\"/></svg>' +\n        ' Insert Reply';\n      insertReplyBtn.title = 'Insert the reply into the current email';\n    }\n\n    const insertReplyAllBtn = $('btn-insert-reply-all');\n    if (insertReplyAllBtn) {\n      insertReplyAllBtn.classList.add('hidden');\n    }\n\n    // Reply context banner: load the original sender and subject\n    const senderEl = $('reply-sender');\n    const subjectEl = $('reply-subject');\n    if (senderEl) senderEl.textContent = 'Loading';\n\n    // Use getOriginalSender to get the person being replied to\n    import('../services/outlook').then(async ({ getOriginalSender, getCurrentEmailSubject }) => {\n      try {\n        const [sender, subject] = await Promise.all([\n          getOriginalSender(),\n          (async () => {\n            const item = Office.context.mailbox.item as any;\n            if (item && item.subject && typeof item.subject.getAsync === 'function') {\n              return new Promise<string>((resolve) => {\n                item.subject.getAsync((result: any) => {\n                  resolve(result.status === Office.AsyncResultStatus.Succeeded\n                    ? result.value || '(new email)'\n                    : '(new email)');\n                });\n              });\n            }\n            return '(new email)';\n          })(),\n        ]);\n\n        if (senderEl) {\n          senderEl.textContent = sender.name\n            ? `${sender.name} <${sender.email}>`\n            : sender.email || 'Unknown sender';\n        }\n        if (subjectEl) {\n          subjectEl.textContent = subject;\n        }\n      } catch {\n        if (senderEl) senderEl.textContent = 'Could not read email';\n        if (subjectEl) subjectEl.textContent = '';\n      }\n    });\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Tab switching\n// ---------------------------------------------------------------------------\n\nconst TAB_CONFIG: Record<string, string[]> = {\n  draft: ['draft-section', 'result-section'],\n  reply: ['reply-section', 'reply-result-section'],\n  summarize: ['summarize-section', 'summarize-result-section'],\n  improve: ['improve-section', 'improve-result-section'],\n  extract: ['extract-section', 'extract-result-section'],\n  translate: ['translate-section', 'translate-result-section'],\n  settings: ['settings-section'],\n};\n\nfunction switchTab(tabName: string): void {\n  // Update tab buttons\n  document.querySelectorAll('.glide-tab').forEach((tab) => {\n    tab.classList.toggle('glide-tab--active', (tab as HTMLElement).dataset.tab === tabName);\n  });\n\n  // Show/hide sections\n  for (const [name, sectionIds] of Object.entries(TAB_CONFIG)) {\n    const isActive = name === tabName;\n    for (const id of sectionIds) {\n      const el = $(id);\n      if (!el) continue;\n\n      if (isActive) {\n        // For form sections, always show. For result sections, only show if they have content.\n        if (id.includes('result')) {\n          // Keep current display state (only shown after generation)\n        } else {\n          el.classList.remove('hidden');\n        }\n      } else {\n        el.classList.add('hidden');\n      }\n    }\n  }\n\n  hideError();\n\n  // Auto-load email context when switching to Reply tab\n  if (tabName === 'reply') {\n    loadReplyContext();\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Reply context loader\n// ---------------------------------------------------------------------------\n\nasync function loadReplyContext(): Promise<void> {\n  const senderEl = $('reply-sender');\n  const subjectEl = $('reply-subject');\n\n  try {\n    clearEmailContext();\n    const ctx = await loadEmailContext();\n    if (senderEl) {\n      senderEl.textContent = ctx.sender.name\n        ? `${ctx.sender.name} <${ctx.sender.email}>`\n        : ctx.sender.email || 'Unknown sender';\n    }\n    if (subjectEl) {\n      subjectEl.textContent = ctx.subject || '(no subject)';\n    }\n  } catch {\n    if (senderEl) senderEl.textContent = 'Could not read email';\n    if (subjectEl) subjectEl.textContent = '';\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Draft Email handlers\n// ---------------------------------------------------------------------------\n\nasync function handleGenerate(): Promise<void> {\n  const instructions = ($('draft-instructions') as HTMLTextAreaElement)?.value || '';\n  const tone = ($('draft-tone') as HTMLSelectElement)?.value || 'professional';\n  const length = ($('draft-length') as HTMLSelectElement)?.value || 'medium';\n\n  const options: DraftEmailOptions = { instructions, tone, length };\n\n  hideError();\n  showLoading('Generating with Gemini...');\n\n  try {\n    const draft = await generateDraft(options);\n    setPreview('draft-preview', draft);\n    showElement('result-section');\n  } catch (err: any) {\n    showError(err.message || 'Failed to generate draft. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerate(): Promise<void> {\n  hideError();\n  showLoading('Regenerating...');\n\n  try {\n    const draft = await regenerateDraft();\n    setPreview('draft-preview', draft);\n  } catch (err: any) {\n    showError(err.message || 'Failed to regenerate. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRefine(): Promise<void> {\n  const input = $('refine-input') as HTMLInputElement;\n  const refinement = input?.value || '';\n\n  if (!refinement.trim()) {\n    showError('Please enter refinement instructions.');\n    return;\n  }\n\n  hideError();\n  showLoading('Refining...');\n\n  try {\n    const draft = await refineDraft(refinement);\n    setPreview('draft-preview', draft);\n    if (input) input.value = '';\n  } catch (err: any) {\n    showError(err.message || 'Failed to refine. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nfunction handleCopyToCompose(): void {\n  const preview = $('draft-preview');\n  if (!preview) return;\n\n  const draft = preview.innerText || preview.textContent || '';\n  if (!draft.trim()) {\n    showError('No draft to copy. Please generate one first.');\n    return;\n  }\n\n  try {\n    copyToCompose(draft);\n  } catch (err: any) {\n    showError(err.message || 'Failed to open compose window.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Reply handlers\n// ---------------------------------------------------------------------------\n\nasync function handleGenerateReply(): Promise<void> {\n  const instructions = ($('reply-instructions') as HTMLTextAreaElement)?.value || '';\n  const tone = ($('reply-tone') as HTMLSelectElement)?.value || 'professional';\n  const includeOriginal = ($('reply-include-original') as HTMLInputElement)?.checked ?? true;\n\n  const options: DraftReplyOptions = { instructions, tone, includeOriginal };\n\n  hideError();\n  showLoading('Generating reply with Gemini...');\n\n  try {\n    const reply = await generateReply(options);\n    setPreview('reply-preview', reply);\n    showElement('reply-result-section');\n\n    // In compose mode, Reply All is redundant  user already chose reply type\n    if (getItemMode() === 'compose') {\n      hideElement('btn-insert-reply-all');\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to generate reply. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerateReply(): Promise<void> {\n  hideError();\n  showLoading('Regenerating reply...');\n\n  try {\n    const reply = await regenerateReply();\n    setPreview('reply-preview', reply);\n  } catch (err: any) {\n    showError(err.message || 'Failed to regenerate reply. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRefineReply(): Promise<void> {\n  const input = $('reply-refine-input') as HTMLInputElement;\n  const refinement = input?.value || '';\n\n  if (!refinement.trim()) {\n    showError('Please enter refinement instructions.');\n    return;\n  }\n\n  hideError();\n  showLoading('Refining reply...');\n\n  try {\n    const reply = await refineReply(refinement);\n    setPreview('reply-preview', reply);\n    if (input) input.value = '';\n  } catch (err: any) {\n    showError(err.message || 'Failed to refine reply. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nfunction handleInsertReply(): void {\n  const preview = $('reply-preview');\n  if (!preview) return;\n\n  const text = preview.innerText || preview.textContent || '';\n  if (!text.trim()) {\n    showError('No reply to insert. Please generate one first.');\n    return;\n  }\n\n  try {\n    openReply(text);\n  } catch (err: any) {\n    showError(err.message || 'Failed to open reply window.');\n  }\n}\n\nfunction handleInsertReplyAll(): void {\n  const preview = $('reply-preview');\n  if (!preview) return;\n\n  const text = preview.innerText || preview.textContent || '';\n  if (!text.trim()) {\n    showError('No reply to insert. Please generate one first.');\n    return;\n  }\n\n  try {\n    openReplyAll(text);\n  } catch (err: any) {\n    showError(err.message || 'Failed to open Reply All window.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Summarize handlers\n// ---------------------------------------------------------------------------\n\nfunction getSelectedStyle(): SummaryStyle {\n  const checked = document.querySelector('input[name=\"summary-style\"]:checked') as HTMLInputElement;\n  return (checked?.value as SummaryStyle) || 'bullets';\n}\n\nasync function handleSummarize(): Promise<void> {\n  const style = getSelectedStyle();\n  const length = ($('summary-length') as HTMLSelectElement)?.value as SummaryLength || 'standard';\n\n  const options: SummarizeOptions = { style, length };\n\n  hideError();\n  showLoading('Summarizing with Gemini...');\n\n  try {\n    const summary = await summarizeThread(options);\n    setPreview('summary-preview', summary);\n    showElement('summarize-result-section');\n  } catch (err: any) {\n    showError(err.message || 'Failed to summarize. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerateSummary(): Promise<void> {\n  hideError();\n  showLoading('Regenerating summary...');\n\n  try {\n    const summary = await regenerateSummary();\n    setPreview('summary-preview', summary);\n  } catch (err: any) {\n    showError(err.message || 'Failed to regenerate summary. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleCopySummary(): Promise<void> {\n  const preview = $('summary-preview');\n  if (!preview) return;\n\n  const text = preview.innerText || preview.textContent || '';\n  if (!text.trim()) {\n    showError('No summary to copy.');\n    return;\n  }\n\n  try {\n    await copyToClipboard(text);\n    // Brief visual feedback\n    const btn = $('btn-copy-summary');\n    if (btn) {\n      const original = btn.innerHTML;\n      btn.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark\"></i> Copied!';\n      btn.classList.add('glide-btn--success');\n      setTimeout(() => {\n        btn.innerHTML = original;\n        btn.classList.remove('glide-btn--success');\n      }, 1500);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to copy to clipboard.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Improve Writing handlers\n// ---------------------------------------------------------------------------\n\nfunction getSelectedFocus(): ImprovementFocus {\n  const checked = document.querySelector('input[name=\"improve-focus\"]:checked') as HTMLInputElement;\n  return (checked?.value as ImprovementFocus) || 'fix_grammar';\n}\n\nasync function handleImprove(): Promise<void> {\n  const focus = getSelectedFocus();\n  const options: ImproveOptions = { focus };\n\n  hideError();\n  showLoading('Improving with Gemini...');\n\n  try {\n    const result = await improveWriting(options);\n    const diffContainer = $('improve-diff');\n    if (diffContainer) {\n      diffContainer.innerHTML = generateDiffHtml(result.original, result.improved);\n    }\n    showElement('improve-result-section');\n  } catch (err: any) {\n    showError(err.message || 'Failed to improve text. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerateImprove(): Promise<void> {\n  hideError();\n  showLoading('Regenerating improvement...');\n\n  try {\n    const result = await regenerateImprovement();\n    const diffContainer = $('improve-diff');\n    if (diffContainer) {\n      diffContainer.innerHTML = generateDiffHtml(result.original, result.improved);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to regenerate. Please try again.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleAcceptChanges(): Promise<void> {\n  hideError();\n\n  try {\n    const action = await acceptChanges();\n    const btn = $('btn-accept-changes');\n    if (btn) {\n      const original = btn.innerHTML;\n      const msg = action === 'replaced'\n        ? '<i class=\"ms-Icon ms-Icon--CheckMark\"></i> Replaced!'\n        : '<i class=\"ms-Icon ms-Icon--CheckMark\"></i> Copied!';\n      btn.innerHTML = msg;\n      btn.classList.add('glide-btn--success');\n      setTimeout(() => {\n        btn.innerHTML = original;\n        btn.classList.remove('glide-btn--success');\n      }, 1500);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to accept changes.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Extract Action Items handlers\n// ---------------------------------------------------------------------------\n\nasync function handleExtract(): Promise<void> {\n  hideError();\n  showLoading('Scanning for action items...');\n\n  try {\n    const items = await extractActionItems();\n    const container = $('extract-checklist');\n    if (container) {\n      container.innerHTML = renderChecklistHtml(items);\n    }\n    showElement('extract-result-section');\n  } catch (err: any) {\n    showError(err.message || 'Failed to extract action items.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerateExtract(): Promise<void> {\n  hideError();\n  showLoading('Re-scanning for action items...');\n\n  try {\n    const items = await regenerateActions();\n    const container = $('extract-checklist');\n    if (container) {\n      container.innerHTML = renderChecklistHtml(items);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to re-extract.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleCopyTasks(): Promise<void> {\n  const items = getLastItems();\n  if (items.length === 0) {\n    showError('No action items to copy.');\n    return;\n  }\n\n  try {\n    const text = formatAsTaskList(items);\n    await copyTasksToClipboard(text);\n    const btn = $('btn-copy-tasks');\n    if (btn) {\n      const original = btn.innerHTML;\n      btn.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark\"></i> Copied!';\n      btn.classList.add('glide-btn--success');\n      setTimeout(() => {\n        btn.innerHTML = original;\n        btn.classList.remove('glide-btn--success');\n      }, 1500);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to copy tasks.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Translate handlers\n// ---------------------------------------------------------------------------\n\nasync function handleTranslate(): Promise<void> {\n  const langSelect = $('translate-language') as HTMLSelectElement;\n  if (!langSelect) return;\n\n  hideError();\n  showLoading('Translating email...');\n\n  try {\n    const result = await translateEmail(langSelect.value);\n    const container = $('translate-output');\n    if (container) {\n      container.innerHTML = renderTranslationHtml(result);\n    }\n    showElement('translate-result-section');\n  } catch (err: any) {\n    showError(err.message || 'Failed to translate.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleRegenerateTranslate(): Promise<void> {\n  const langSelect = $('translate-language') as HTMLSelectElement;\n  if (!langSelect) return;\n\n  hideError();\n  showLoading('Re-translating email...');\n\n  try {\n    const result = await regenerateTranslation(langSelect.value);\n    const container = $('translate-output');\n    if (container) {\n      container.innerHTML = renderTranslationHtml(result);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to re-translate.');\n  } finally {\n    hideLoading();\n  }\n}\n\nasync function handleCopyTranslation(): Promise<void> {\n  const result = getLastTranslation();\n  if (!result) {\n    showError('No translation to copy.');\n    return;\n  }\n\n  try {\n    await copyTranslationToClipboard(result.translated);\n    const btn = $('btn-copy-translation');\n    if (btn) {\n      const original = btn.innerHTML;\n      btn.innerHTML = '<i class=\"ms-Icon ms-Icon--CheckMark\"></i> Copied!';\n      btn.classList.add('glide-btn--success');\n      setTimeout(() => {\n        btn.innerHTML = original;\n        btn.classList.remove('glide-btn--success');\n      }, 1500);\n    }\n  } catch (err: any) {\n    showError(err.message || 'Failed to copy translation.');\n  }\n}\n\n// ---------------------------------------------------------------------------\n// Initialization\n// ---------------------------------------------------------------------------\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    hideElement('sideload-msg');\n    showElement('app-body');\n\n    // Detect compose mode and adapt UI\n    const currentMode = getItemMode();\n    adaptUIForMode(currentMode);\n\n    // Load reply context immediately (Reply is the default tab)\n    if (currentMode === 'read') {\n      loadReplyContext();\n    }\n\n    // Refresh context when user switches to a different email\n    if (Office.context.mailbox) {\n      Office.context.mailbox.addHandlerAsync(\n        Office.EventType.ItemChanged,\n        () => { loadReplyContext(); },\n      );\n    }\n\n    // Load settings and initialize Gemini client from stored API key\n    const settings = loadSettings();\n    try {\n      const apiKey = settings.apiKey || (window as any).__AICompose_API_KEY__ || '';\n      if (apiKey) {\n        initGeminiClient(apiKey);\n      }\n    } catch {\n      // Client will be initialized when settings are saved\n    }\n\n    // Populate feature defaults from settings\n    const applySettingsToForms = (s: AIComposeSettings): void => {\n      // Tone selects\n      const draftTone = $('draft-tone') as HTMLSelectElement | null;\n      const replyTone = $('reply-tone') as HTMLSelectElement | null;\n      if (draftTone) draftTone.value = s.defaultTone;\n      if (replyTone) replyTone.value = s.defaultTone;\n\n      // Summary style radio buttons\n      const summaryRadio = document.querySelector(\n        `input[name=\"summary-style\"][value=\"${s.defaultSummaryStyle}\"]`,\n      ) as HTMLInputElement | null;\n      if (summaryRadio) summaryRadio.checked = true;\n\n      // Translation language\n      const langSelect = $('translate-language') as HTMLSelectElement | null;\n      if (langSelect) langSelect.value = s.defaultLanguage;\n\n      // Settings form itself\n      const sApiKey = $('settings-api-key') as HTMLInputElement | null;\n      const sModel = $('settings-model') as HTMLSelectElement | null;\n      const sTone = $('settings-tone') as HTMLSelectElement | null;\n      const sStyle = $('settings-summary-style') as HTMLSelectElement | null;\n      const sLang = $('settings-language') as HTMLSelectElement | null;\n      if (sApiKey) sApiKey.value = s.apiKey;\n      if (sModel) sModel.value = s.defaultModel;\n      if (sTone) sTone.value = s.defaultTone;\n      if (sStyle) sStyle.value = s.defaultSummaryStyle;\n      if (sLang) sLang.value = s.defaultLanguage;\n    };\n\n    applySettingsToForms(settings);\n\n    // --- Outlook theme detection (light/dark) ---\n    try {\n      const theme = (Office.context as any).officeTheme;\n      if (theme?.bodyBackgroundColor) {\n        const bg = theme.bodyBackgroundColor.replace('#', '');\n        const r = parseInt(bg.substring(0, 2), 16);\n        const g = parseInt(bg.substring(2, 4), 16);\n        const b = parseInt(bg.substring(4, 6), 16);\n        // Relative luminance: dark if below 128\n        const luminance = (0.299 * r + 0.587 * g + 0.114 * b);\n        if (luminance < 128) {\n          document.documentElement.setAttribute('data-theme', 'dark');\n        }\n      }\n    } catch {\n      // Theme detection not available  default to light\n    }\n\n    // --- Tab switching + dropdown ---\n    const DROPDOWN_TABS = new Set(['summarize', 'improve', 'extract']);\n    const moreBtn = $('tab-more');\n    const dropdown = $('more-dropdown');\n    const splitContainer = moreBtn?.closest('.glide-split');\n\n    const toggleDropdown = (show?: boolean): void => {\n      if (!dropdown || !splitContainer) return;\n      const isOpen = show !== undefined ? show : dropdown.classList.contains('hidden');\n      dropdown.classList.toggle('hidden', !isOpen);\n      splitContainer.classList.toggle('glide-split--open', isOpen);\n    }\n\n    // Regular tab buttons (Draft, Reply)\n    document.querySelectorAll('.glide-tabs > .glide-tab').forEach((tab) => {\n      tab.addEventListener('click', () => {\n        const tabName = (tab as HTMLElement).dataset.tab;\n        if (tabName && tabName !== 'more') {\n          switchTab(tabName);\n          // Clear More button highlight\n          moreBtn?.classList.remove('glide-tab--active');\n          document.querySelectorAll('.glide-dropdown__item').forEach((item) =>\n            item.classList.remove('glide-dropdown__item--active'),\n          );\n          toggleDropdown(false);\n        }\n      });\n    });\n\n    // More button  toggle dropdown\n    moreBtn?.addEventListener('click', (e) => {\n      e.stopPropagation();\n      toggleDropdown();\n    });\n\n    // Dropdown items\n    document.querySelectorAll('.glide-dropdown__item').forEach((item) => {\n      item.addEventListener('click', (e) => {\n        e.stopPropagation();\n        const tabName = (item as HTMLElement).dataset.tab;\n        if (tabName) {\n          switchTab(tabName);\n          // Highlight the More button and the selected item\n          document.querySelectorAll('.glide-tab').forEach((t) =>\n            t.classList.remove('glide-tab--active'),\n          );\n          moreBtn?.classList.add('glide-tab--active');\n          document.querySelectorAll('.glide-dropdown__item').forEach((di) =>\n            di.classList.remove('glide-dropdown__item--active'),\n          );\n          item.classList.add('glide-dropdown__item--active');\n          toggleDropdown(false);\n        }\n      });\n    });\n\n    // Close dropdown on outside click\n    document.addEventListener('click', () => toggleDropdown(false));\n\n    // --- Draft Email ---\n    $('btn-generate')?.addEventListener('click', handleGenerate);\n    $('btn-regenerate')?.addEventListener('click', handleRegenerate);\n    $('btn-refine')?.addEventListener('click', handleRefine);\n    $('btn-copy-compose')?.addEventListener('click', handleCopyToCompose);\n\n    $('refine-input')?.addEventListener('keydown', (e: Event) => {\n      if ((e as KeyboardEvent).key === 'Enter') handleRefine();\n    });\n\n    // --- Reply ---\n    $('btn-generate-reply')?.addEventListener('click', handleGenerateReply);\n    $('btn-regenerate-reply')?.addEventListener('click', handleRegenerateReply);\n    $('btn-refine-reply')?.addEventListener('click', handleRefineReply);\n    $('btn-insert-reply')?.addEventListener('click', handleInsertReply);\n    $('btn-insert-reply-all')?.addEventListener('click', handleInsertReplyAll);\n\n    $('reply-refine-input')?.addEventListener('keydown', (e: Event) => {\n      if ((e as KeyboardEvent).key === 'Enter') handleRefineReply();\n    });\n\n    // --- Summarize ---\n    $('btn-summarize')?.addEventListener('click', handleSummarize);\n    $('btn-regenerate-summary')?.addEventListener('click', handleRegenerateSummary);\n    $('btn-copy-summary')?.addEventListener('click', handleCopySummary);\n\n    // --- Improve ---\n    $('btn-improve')?.addEventListener('click', handleImprove);\n    $('btn-regenerate-improve')?.addEventListener('click', handleRegenerateImprove);\n    $('btn-accept-changes')?.addEventListener('click', handleAcceptChanges);\n\n    // --- Extract ---\n    $('btn-extract')?.addEventListener('click', handleExtract);\n    $('btn-regenerate-extract')?.addEventListener('click', handleRegenerateExtract);\n    $('btn-copy-tasks')?.addEventListener('click', handleCopyTasks);\n\n    // --- Translate ---\n    $('btn-translate')?.addEventListener('click', handleTranslate);\n    $('btn-regenerate-translate')?.addEventListener('click', handleRegenerateTranslate);\n    $('btn-copy-translation')?.addEventListener('click', handleCopyTranslation);\n\n    // --- Settings ---\n    $('tab-settings')?.addEventListener('click', () => {\n      switchTab('settings');\n      // Highlight settings button\n      document.querySelectorAll('.glide-tab').forEach((t) =>\n        t.classList.remove('glide-tab--active'),\n      );\n      $('tab-settings')?.classList.add('glide-tab--active');\n      document.querySelectorAll('.glide-dropdown__item').forEach((di) =>\n        di.classList.remove('glide-dropdown__item--active'),\n      );\n      toggleDropdown(false);\n    });\n\n    // API key show/hide toggle\n    $('btn-toggle-api-key')?.addEventListener('click', () => {\n      const input = $('settings-api-key') as HTMLInputElement | null;\n      const showIcon = $('icon-eye-show');\n      const hideIcon = $('icon-eye-hide');\n      if (!input) return;\n\n      if (input.type === 'password') {\n        input.type = 'text';\n        if (showIcon) showIcon.classList.add('hidden');\n        if (hideIcon) hideIcon.classList.remove('hidden');\n      } else {\n        input.type = 'password';\n        if (showIcon) showIcon.classList.remove('hidden');\n        if (hideIcon) hideIcon.classList.add('hidden');\n      }\n    });\n\n    // Save settings\n    $('btn-save-settings')?.addEventListener('click', () => {\n      const apiKey = ($('settings-api-key') as HTMLInputElement)?.value?.trim() || '';\n      const model = ($('settings-model') as HTMLSelectElement)?.value || 'gemini-3-flash-preview';\n      const tone = ($('settings-tone') as HTMLSelectElement)?.value || 'professional';\n      const summaryStyle = ($('settings-summary-style') as HTMLSelectElement)?.value || 'bullets';\n      const language = ($('settings-language') as HTMLSelectElement)?.value || 'English';\n\n      // Validate API key format\n      const keyError = $('api-key-error');\n      if (apiKey && !isValidApiKeyFormat(apiKey)) {\n        if (keyError) {\n          keyError.textContent = 'Invalid API key format. Keys typically start with \"AIza\" and are 39 characters long.';\n          keyError.classList.remove('hidden');\n        }\n        return;\n      }\n      if (keyError) keyError.classList.add('hidden');\n\n      const newSettings: GlideSettings = {\n        apiKey,\n        defaultModel: model,\n        defaultTone: tone as any,\n        defaultSummaryStyle: summaryStyle as any,\n        defaultLanguage: language,\n      };\n\n      saveSettings(newSettings);\n      applySettingsToForms(newSettings);\n\n      // Show confirmation\n      const msg = $('settings-saved-msg');\n      if (msg) {\n        msg.classList.remove('hidden');\n        setTimeout(() => { msg.classList.add('hidden'); }, 2000);\n      }\n\n      // Flash the save button green\n      const btn = $('btn-save-settings');\n      if (btn) {\n        btn.classList.add('glide-btn--success');\n        setTimeout(() => btn.classList.remove('glide-btn--success'), 1500);\n      }\n    });\n\n    // Test Connection button\n    $('btn-test-connection')?.addEventListener('click', async () => {\n      const apiKey = ($('settings-api-key') as HTMLInputElement)?.value?.trim() || '';\n      const resultEl = $('test-connection-result');\n      const keyError = $('api-key-error');\n      const btn = $('btn-test-connection');\n\n      if (!resultEl) return;\n\n      // Validate format first\n      if (!apiKey) {\n        if (keyError) {\n          keyError.textContent = 'Please enter an API key first.';\n          keyError.classList.remove('hidden');\n        }\n        return;\n      }\n      if (!isValidApiKeyFormat(apiKey)) {\n        if (keyError) {\n          keyError.textContent = 'Invalid API key format. Keys typically start with \"AIza\" and are 39 characters long.';\n          keyError.classList.remove('hidden');\n        }\n        return;\n      }\n      if (keyError) keyError.classList.add('hidden');\n\n      // Show testing state\n      resultEl.classList.remove('hidden');\n      resultEl.style.color = 'var(--color-glide-text-secondary)';\n      resultEl.textContent = 'Testing connection';\n      if (btn) btn.setAttribute('disabled', 'true');\n\n      try {\n        initGeminiClient(apiKey);\n        try {\n          await generateText('Say hello in one word.', {\n            maxOutputTokens: 20,\n            temperature: 0.5,\n          });\n        } catch (testErr: any) {\n          // If error is CONTENT_FILTERED, the API key and connection are still valid\n          if (testErr?.code === 'CONTENT_FILTERED') {\n            // Connection works  content filter is a non-issue for a test\n          } else {\n            throw testErr;\n          }\n        }\n        resultEl.style.color = 'var(--color-glide-success)';\n        resultEl.textContent = ' Connection successful! API key is valid.';\n        if (btn) {\n          btn.classList.add('glide-btn--success');\n          setTimeout(() => btn.classList.remove('glide-btn--success'), 2000);\n        }\n      } catch (err: any) {\n        resultEl.style.color = 'var(--color-glide-error-text)';\n        resultEl.textContent = ` ${err.message || 'Connection failed. Please check your API key.'}`;\n      } finally {\n        if (btn) btn.removeAttribute('disabled');\n      }\n    });\n\n    // --- Error banner ---\n    $('btn-dismiss-error')?.addEventListener('click', hideError);\n  }\n});\n"],"names":["getItemMode","item","Office","context","mailbox","body","getAsync","setAsync","subject","getCurrentEmailBody","Promise","resolve","reject","getItemOrThrow","CoercionType","Text","result","status","AsyncResultStatus","Succeeded","value","Error","error","message","getCurrentEmailSubject","subjectObj","getEmailSender","from","name","displayName","email","emailAddress","fromObj","getCurrentUserContact","async","getOriginalSender","toRecipients","toObj","to","map","r","getComposeToRecipients","length","getConversationMessages","sender","all","dateTime","dateTimeCreated","toISOString","undefined","profile","userProfile","___CSS_LOADER_EXPORT___","push","module","id","___CSS_LOADER_URL_IMPORT_0___","URL","___CSS_LOADER_URL_REPLACEMENT_0___","exports","cssWithMappingToString","list","toString","this","content","needLayer","concat","join","i","modules","media","dedupe","supports","layer","alreadyImportedModules","k","_k","url","options","String","__esModule","default","test","slice","hash","needQuotes","replace","cssMapping","btoa","base64","unescape","encodeURIComponent","JSON","stringify","data","sourceMapping","stylesInDOM","getIndexByIdentifier","identifier","modulesToDom","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","m","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","b","baseURI","self","location","href","nc","locals","SchemaType","ExecutableCodeLanguage","Outcome","POSSIBLE_ROLES","HarmCategory","HarmBlockThreshold","HarmProbability","BlockReason","FinishReason","TaskType","FunctionCallingMode","DynamicRetrievalMode","Task","GoogleGenerativeAIError","constructor","super","GoogleGenerativeAIResponseError","response","GoogleGenerativeAIFetchError","statusText","errorDetails","GoogleGenerativeAIRequestInputError","GoogleGenerativeAIAbortError","RequestUrl","model","task","apiKey","stream","requestOptions","_a","_b","apiVersion","baseUrl","getHeaders","headers","Headers","append","clientHeaders","apiClient","getClientHeaders","customHeaders","headerName","headerValue","entries","makeModelRequest","fetchFn","fetch","fetchOptions","assign","buildFetchOptions","method","constructModelRequest","err","stack","handleResponseError","ok","json","details","handleResponseNotOk","makeRequest","signal","timeout","controller","AbortController","setTimeout","abort","addEventListener","addHelpers","text","candidates","console","warn","hadBadFinishReason","formatBlockErrorMessage","_c","_d","textStrings","parts","part","executableCode","language","code","codeExecutionResult","output","getText","promptFeedback","functionCall","getFunctionCalls","functionCalls","badFinishReasons","RECITATION","SAFETY","LANGUAGE","candidate","finishReason","includes","firstCandidate","finishMessage","blockReason","blockReasonMessage","__await","v","SuppressedError","responseLineRE","getResponsePromise","allResponses","reader","getReader","done","read","aggregateResponses","generateResponseSequence","thisArg","_arguments","generator","Symbol","asyncIterator","TypeError","g","q","verb","resume","then","fulfill","settle","f","shift","__asyncGenerator","arguments","responses","lastResponse","aggregatedResponse","candidateIndex","citationMetadata","groundingMetadata","safetyRatings","role","newPart","keys","usageMetadata","generateContentStream","params","responseStream","inputStream","ReadableStream","start","currentText","pump","trim","close","parsedResponse","match","parse","enqueue","substring","catch","getResponseStream","pipeThrough","TextDecoderStream","fatal","stream1","stream2","tee","processStream","STREAM_GENERATE_CONTENT","generateContent","GENERATE_CONTENT","formatSystemInstruction","input","formatNewContent","request","newParts","partOrString","userContent","functionContent","hasUserContent","hasFunctionContent","assignRoleToPartsAndValidateSendMessageRequest","formatGenerateContentInput","formattedRequest","contents","systemInstruction","VALID_PART_FIELDS","VALID_PARTS_PER_ROLE","user","function","system","isValidResponse","SILENT_ERROR","ChatSession","_requestOptions","_history","_sendPromise","_apiKey","history","prevContent","currContent","Array","isArray","countFields","inlineData","functionResponse","fileData","validParts","validateChatHistory","getHistory","sendMessage","_e","_f","newContent","generateContentRequest","safetySettings","generationConfig","tools","toolConfig","cachedContent","chatSessionRequestOptions","finalResult","responseContent","blockErrorMessage","sendMessageStream","streamPromise","_ignored","streamResult","GenerativeModel","modelParams","formattedParams","generativeModelRequestOptions","startChat","startChatParams","countTokens","formattedGenerateContentRequest","containsGenerateContentRequest","formatCountTokensInput","singleRequestOptions","COUNT_TOKENS","embedContent","EMBED_CONTENT","batchEmbedContents","batchEmbedContentRequest","requestsWithModel","requests","BATCH_EMBED_CONTENTS","GoogleGenerativeAI","getGenerativeModel","getGenerativeModelFromCachedContent","disallowedDuplicates","startsWith","modelParamsFromCache","STORAGE_KEY","LEGACY_STORAGE_KEY","DEFAULT_SETTINGS","defaultModel","defaultTone","defaultSummaryStyle","defaultLanguage","cached","loadSettings","raw","localStorage","getItem","legacy","setItem","removeItem","parsed","GeminiErrorCode","GeminiError","retryable","statusCode","setPrototypeOf","clientInstance","initGeminiClient","INVALID_API_KEY","generateText","prompt","client","getClient","modelName","temperature","maxOutputTokens","topP","topK","fn","lastError","delay","attempt","classifyError","jitter","Math","random","sleep","retryWithBackoff","promise","timer","TIMEOUT","clearTimeout","CONTENT_FILTERED","callModel","resp","extractStatusCode","RATE_LIMITED","QUOTA_EXCEEDED","NETWORK_ERROR","UNKNOWN","ms","buildPrompt","template","variables","placeholder","split","lastOptions","lastDraft","generateDraft","instructions","lengthHint","getLengthHint","INSTRUCTIONS","TONE","tone","draft","getMaxTokensForLength","bodyToHtml","paragraph","escapeHtml","lastReplyOptions","lastReply","cachedContext","loadEmailContext","generateReply","getEmailContext","originalEmail","ORIGINAL_EMAIL","REPLY_INSTRUCTIONS","reply","lastSummary","summarizeThread","emailThread","msg","header","EMAIL_THREAD","SUMMARY_LENGTH","brief","standard","detailed","bullets","tldr","summary","originalText","improvedText","FOCUS_LABELS","fix_grammar","improve_clarity","make_concise","make_professional","improveWriting","selected","getSelectedDataAsync","readSourceText","TEXT","IMPROVEMENT_FOCUS","focus","original","improved","generateDiffHtml","origWords","tokenize","impWords","added","removed","unchanged","origTokens","impTokens","Set","_","dp","fill","j","max","origInLCS","impInLCS","add","idx","has","diffWords","buildSideHtml","tokens","highlighted","cls","token","escaped","lastItems","lastRawResponse","extractActionItems","emailContent","readEmailContent","EMAIL_CONTENT","items","blocks","block","trimmed","owner","deadline","taskMatch","ownerMatch","deadlineMatch","parseActionItems","renderChecklistHtml","lastResult","translateEmail","targetLanguage","TARGET_LANGUAGE","translated","renderTranslationHtml","$","getElementById","isValidApiKeyFormat","showElement","el","classList","hideElement","showLoading","textContent","hideLoading","showError","hideError","setPreview","elementId","preview","html","line","toLowerCase","innerHTML","TAB_CONFIG","summarize","improve","extract","translate","settings","switchTab","tabName","querySelectorAll","forEach","tab","toggle","dataset","sectionIds","isActive","loadReplyContext","senderEl","subjectEl","ctx","handleGenerate","handleRegenerate","regenerateDraft","handleRefine","refinement","refined","refineDraft","handleCopyToCompose","innerText","lines","bodyStartIndex","parseSubjectAndBody","coercionType","Html","displayNewMessageForm","htmlBody","copyToCompose","handleGenerateReply","includeOriginal","checked","handleRegenerateReply","regenerateReply","handleRefineReply","refineReply","handleInsertReply","replyText","mode","prependAsync","displayReplyForm","openReply","handleInsertReplyAll","displayReplyAllForm","openReplyAll","handleSummarize","getSelectedStyle","handleRegenerateSummary","regenerateSummary","handleCopySummary","navigator","clipboard","writeText","textarea","position","opacity","select","execCommand","copyToClipboard","btn","handleImprove","getSelectedFocus","diffContainer","handleRegenerateImprove","regenerateImprovement","handleAcceptChanges","action","acceptChanges","handleExtract","container","handleRegenerateExtract","regenerateActions","handleCopyTasks","formatAsTaskList","copyTasksToClipboard","handleTranslate","langSelect","handleRegenerateTranslate","regenerateTranslation","handleCopyTranslation","copyTranslationToClipboard","onReady","info","host","HostType","Outlook","currentMode","copyComposeBtn","title","insertReplyBtn","insertReplyAllBtn","adaptUIForMode","addHandlerAsync","EventType","ItemChanged","__AICompose_API_KEY__","applySettingsToForms","s","draftTone","replyTone","summaryRadio","sApiKey","sModel","sTone","sStyle","sLang","theme","officeTheme","bodyBackgroundColor","bg","parseInt","documentElement","moreBtn","dropdown","splitContainer","closest","toggleDropdown","show","isOpen","contains","stopPropagation","t","di","showIcon","hideIcon","type","summaryStyle","keyError","newSettings","previousKey","saveSettings","resultEl","color","testErr","removeAttribute"],"sourceRoot":""}