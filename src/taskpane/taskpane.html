<!-- Caelum — Outlook AI Add-in Task Pane -->
<!-- © Rizonetech (Pty) Ltd. — https://rizonesoft.com -->

<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Caelum — AI Email Assistant</title>

    <!-- Office JavaScript API -->
    <script
      type="text/javascript"
      src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"
    ></script>

    <!-- Fluent UI icons -->
    <link
      rel="stylesheet"
      href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"
    />

    <!-- Google Fonts — Inter for a modern, clean look -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Caelum styles -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="ms-Fabric">
    <!-- ================================================================ -->
    <!-- Header                                                           -->
    <!-- ================================================================ -->
    <header class="caelum-header">
      <div class="caelum-header__brand">
        <img
          width="28"
          height="28"
          src="../../assets/logo-filled.png"
          alt="Caelum"
          class="caelum-header__icon"
        />
        <span class="caelum-header__title">Caelum</span>
      </div>
      <span class="caelum-header__subtitle">AI Email Assistant</span>
    </header>

    <!-- ================================================================ -->
    <!-- Sideload message (shown when add-in isn't activated)             -->
    <!-- ================================================================ -->
    <section id="sideload-msg" class="caelum-sideload">
      <div class="caelum-sideload__icon">
        <i class="ms-Icon ms-Icon--PlugDisconnected ms-font-xxl"></i>
      </div>
      <h2>Add-in Not Loaded</h2>
      <p>
        Please
        <a
          target="_blank"
          href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing"
          >sideload</a
        >
        the add-in to get started.
      </p>
    </section>

    <!-- ================================================================ -->
    <!-- Main app (hidden until Office.js is ready)                       -->
    <!-- ================================================================ -->
    <main id="app-body" style="display: none">

      <!-- Tab bar ----------------------------------------------------- -->
      <nav class="caelum-tabs">
        <button id="tab-draft" class="caelum-tab caelum-tab--active" data-tab="draft">
          <i class="ms-Icon ms-Icon--EditMail"></i>
          Draft
        </button>
        <button id="tab-reply" class="caelum-tab" data-tab="reply">
          <i class="ms-Icon ms-Icon--Reply"></i>
          Reply
        </button>
      </nav>

      <!-- Draft Email Form ------------------------------------------ -->
      <section id="draft-section" class="caelum-section">
        <h2 class="caelum-section__title">
          <i class="ms-Icon ms-Icon--EditMail"></i>
          Draft a New Email
        </h2>

        <!-- Instructions -->
        <div class="caelum-field">
          <label class="caelum-field__label" for="draft-instructions">
            Instructions / bullet points
          </label>
          <textarea
            id="draft-instructions"
            class="caelum-textarea"
            rows="5"
            placeholder="e.g. Thank the client for the meeting, confirm next steps, mention deadline is Friday..."
          ></textarea>
        </div>

        <!-- Tone & Length row -->
        <div class="caelum-row">
          <div class="caelum-field caelum-field--half">
            <label class="caelum-field__label" for="draft-tone">Tone</label>
            <select id="draft-tone" class="caelum-select">
              <option value="professional" selected>Professional</option>
              <option value="formal">Formal</option>
              <option value="friendly">Friendly</option>
              <option value="casual">Casual</option>
            </select>
          </div>
          <div class="caelum-field caelum-field--half">
            <label class="caelum-field__label" for="draft-length">Length</label>
            <select id="draft-length" class="caelum-select">
              <option value="short">Short</option>
              <option value="medium" selected>Medium</option>
              <option value="detailed">Detailed</option>
            </select>
          </div>
        </div>

        <!-- Generate button -->
        <button id="btn-generate" class="caelum-btn caelum-btn--primary">
          <i class="ms-Icon ms-Icon--LightningBolt"></i>
          Generate Draft
        </button>
      </section>

      <!-- Result area (hidden until a draft is generated) ----------- -->
      <section
        id="result-section"
        class="caelum-section caelum-section--result"
        style="display: none"
      >
        <h2 class="caelum-section__title">
          <i class="ms-Icon ms-Icon--TextDocument"></i>
          Generated Draft
        </h2>

        <div id="draft-preview" class="caelum-preview"></div>

        <!-- Action buttons -->
        <div class="caelum-actions">
          <button
            id="btn-copy-compose"
            class="caelum-btn caelum-btn--primary"
            title="Open a new email with this draft"
          >
            <i class="ms-Icon ms-Icon--NewMail"></i>
            Copy to Compose
          </button>
          <button
            id="btn-regenerate"
            class="caelum-btn caelum-btn--secondary"
            title="Generate a new version"
          >
            <i class="ms-Icon ms-Icon--Refresh"></i>
            Regenerate
          </button>
        </div>

        <!-- Refine input -->
        <div class="caelum-field caelum-field--refine">
          <label class="caelum-field__label" for="refine-input">Refine this draft</label>
          <div class="caelum-refine-row">
            <input
              id="refine-input"
              type="text"
              class="caelum-input"
              placeholder="e.g. make it shorter, add a P.S. note..."
            />
            <button id="btn-refine" class="caelum-btn caelum-btn--accent" title="Refine the draft">
              <i class="ms-Icon ms-Icon--Send"></i>
            </button>
          </div>
        </div>
      </section>

      <!-- ================================================================ -->
      <!-- Reply Section                                                     -->
      <!-- ================================================================ -->

      <!-- Reply Form ------------------------------------------------ -->
      <section id="reply-section" class="caelum-section" style="display: none">
        <h2 class="caelum-section__title">
          <i class="ms-Icon ms-Icon--Reply"></i>
          Draft a Reply
        </h2>

        <!-- Email context banner (auto-populated) -->
        <div id="reply-context" class="caelum-context-banner">
          <div class="caelum-context-banner__row">
            <span class="caelum-context-banner__label">From:</span>
            <span id="reply-sender" class="caelum-context-banner__value">Loading...</span>
          </div>
          <div class="caelum-context-banner__row">
            <span class="caelum-context-banner__label">Subject:</span>
            <span id="reply-subject" class="caelum-context-banner__value">Loading...</span>
          </div>
        </div>

        <!-- Reply instructions -->
        <div class="caelum-field">
          <label class="caelum-field__label" for="reply-instructions">
            Reply instructions
          </label>
          <textarea
            id="reply-instructions"
            class="caelum-textarea"
            rows="4"
            placeholder='e.g. Agree to the meeting, decline politely, ask for more details...'
          ></textarea>
        </div>

        <!-- Tone & options row -->
        <div class="caelum-row">
          <div class="caelum-field caelum-field--half">
            <label class="caelum-field__label" for="reply-tone">Tone</label>
            <select id="reply-tone" class="caelum-select">
              <option value="professional" selected>Professional</option>
              <option value="formal">Formal</option>
              <option value="friendly">Friendly</option>
              <option value="casual">Casual</option>
            </select>
          </div>
          <div class="caelum-field caelum-field--half caelum-field--checkbox">
            <label class="caelum-checkbox">
              <input id="reply-include-original" type="checkbox" checked />
              <span>Include original</span>
            </label>
          </div>
        </div>

        <!-- Generate reply button -->
        <button id="btn-generate-reply" class="caelum-btn caelum-btn--primary caelum-btn--full">
          <i class="ms-Icon ms-Icon--LightningBolt"></i>
          Generate Reply
        </button>
      </section>

      <!-- Reply result area ----------------------------------------- -->
      <section
        id="reply-result-section"
        class="caelum-section caelum-section--result"
        style="display: none"
      >
        <h2 class="caelum-section__title">
          <i class="ms-Icon ms-Icon--TextDocument"></i>
          Generated Reply
        </h2>

        <div id="reply-preview" class="caelum-preview"></div>

        <!-- Reply action buttons -->
        <div class="caelum-actions">
          <button
            id="btn-insert-reply"
            class="caelum-btn caelum-btn--primary"
            title="Insert into Reply"
          >
            <i class="ms-Icon ms-Icon--Reply"></i>
            Reply
          </button>
          <button
            id="btn-insert-reply-all"
            class="caelum-btn caelum-btn--primary"
            title="Insert into Reply All"
          >
            <i class="ms-Icon ms-Icon--ReplyAll"></i>
            Reply All
          </button>
          <button
            id="btn-regenerate-reply"
            class="caelum-btn caelum-btn--secondary"
            title="Generate a new version"
          >
            <i class="ms-Icon ms-Icon--Refresh"></i>
          </button>
        </div>

        <!-- Refine reply input -->
        <div class="caelum-field caelum-field--refine">
          <label class="caelum-field__label" for="reply-refine-input">Refine this reply</label>
          <div class="caelum-refine-row">
            <input
              id="reply-refine-input"
              type="text"
              class="caelum-input"
              placeholder="e.g. make it more concise, soften the tone..."
            />
            <button id="btn-refine-reply" class="caelum-btn caelum-btn--accent" title="Refine">
              <i class="ms-Icon ms-Icon--Send"></i>
            </button>
          </div>
        </div>
      </section>

      <!-- Loading overlay ------------------------------------------- -->
      <div id="loading-overlay" class="caelum-loading" style="display: none">
        <div class="caelum-loading__spinner"></div>
        <p class="caelum-loading__text">Generating with Gemini...</p>
      </div>

      <!-- Error banner ---------------------------------------------- -->
      <div id="error-banner" class="caelum-error" style="display: none">
        <i class="ms-Icon ms-Icon--ErrorBadge"></i>
        <span id="error-message"></span>
        <button id="btn-dismiss-error" class="caelum-error__dismiss" title="Dismiss">
          <i class="ms-Icon ms-Icon--Cancel"></i>
        </button>
      </div>
    </main>
  </body>
</html>
